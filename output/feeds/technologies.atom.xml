<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Wolfblog - Technologies</title><link href="https://wlog.viltstigen.se/" rel="alternate"></link><link href="https://wlog.viltstigen.se/feeds/technologies.atom.xml" rel="self"></link><id>https://wlog.viltstigen.se/</id><updated>2021-07-15T00:00:00+02:00</updated><entry><title>Setting referer policy when using applause button</title><link href="https://wlog.viltstigen.se/articles/2021/07/14/setting-referer-policy-when-using-applause-button/" rel="alternate"></link><published>2021-07-14T00:00:00+02:00</published><updated>2021-07-15T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2021-07-14:/articles/2021/07/14/setting-referer-policy-when-using-applause-button/</id><summary type="html">&lt;p&gt;Description on how, and why, to set referer policy when using applause button&lt;/p&gt;</summary><content type="html">&lt;p&gt;When blogging I use &lt;a href="https://applause-button.com/"&gt;applause button&lt;/a&gt; to allow claps and keep track of the number of
claps I got (not many). How to use this with Pelican and the bootstrap3 theme is described 
&lt;a href="https://wlog.viltstigen.se/articles/2020/06/18/pelican-bootstrap3-theme-and-jupyter/"&gt;here&lt;/a&gt; and
&lt;a href="https://wlog.viltstigen.se/articles/2020/02/12/pelican-applause-button/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In the second link, I describe how to query the number of claps and make a summary list.&lt;/p&gt;
&lt;p&gt;Over time, I noticed a deviation from the number of claps stated in the summary list and what was shown in the
blog entries. Investigating this, I noted that a claps where counted on the URI (in my case 'wlog.vilstigen.se') and not
on individual blog entries (like "https://wlog.viltstigen.se/articles/2020/02/12/pelican-applause-button/"). &lt;/p&gt;
&lt;p&gt;How come?&lt;/p&gt;
&lt;p&gt;Previously, it looked like a clap was registered on the blog entry and not for the URI.&lt;/p&gt;
&lt;p&gt;Checking the documentation for applause button I noted:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The applause button determines the URL that it should log a 'clap' for based on the HTTP referrer.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, to register the clap on the full blog entry path, the "Referer" [sic] in the request header has to be set to the
right value. Checking the referrer value with Chrome browser developer tools, this was not the case. It was set to 
the URI.&lt;/p&gt;
&lt;p&gt;In my configuration, I use nginx as a reverse-proxy. The reverse-proxy receives the browser request for a blog entry, 
then it sends the request further upstream to another nginx server that acts as a web-server for pelican generated 
blog content. The web-server responds and send the response downstream to the nginx reverse-proxy which in turn send 
the response back to the browser. This is a common configuration using nginx.&lt;/p&gt;
&lt;p&gt;After thinking on this, I suspected that my nginx configuration was not setup correctly. After some more checking, I
found this applause-button reported &lt;a href="https://github.com/ColinEberhardt/applause-button/issues/72"&gt;issue&lt;/a&gt;, which
pointed in the right direction. A good link that describe the default behavior by chrome is
&lt;a href="https://developers.google.com/web/updates/2020/07/referrer-policy-new-chrome-default"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;(I have only tried this with chrome browser, so I don't know if it is applicable for other browsers.)&lt;/p&gt;
&lt;p&gt;In the same issue, it is suggested to set the referrer policy to "no-referrer-when-downgrade".
Checking the &lt;a href="https://www.w3.org/TR/referrer-policy/"&gt;specification&lt;/a&gt; for this policy indicated that setting the
referer policy in the reverse-proxy is a good idea.&lt;/p&gt;
&lt;p&gt;For nginx (in the reverse proxy) this is done like so (see the "add_header" directive below)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;server &lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# Reverse proxy to rpi2.local &lt;/span&gt;

    listen &lt;span class="m"&gt;443&lt;/span&gt; ssl&lt;span class="p"&gt;;&lt;/span&gt;
    listen &lt;span class="o"&gt;[&lt;/span&gt;::&lt;span class="o"&gt;]&lt;/span&gt;:443 ssl&lt;span class="p"&gt;;&lt;/span&gt;

    server_name wlog.viltstigen.se&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# SSL configuration&lt;/span&gt;
    include snippets/ssl-wlog.viltstigen.se.conf&lt;span class="p"&gt;;&lt;/span&gt;
    include snippets/ssl-params.conf&lt;span class="p"&gt;;&lt;/span&gt;

    location / &lt;span class="o"&gt;{&lt;/span&gt;
        add_header Referrer-Policy &lt;span class="s2"&gt;&amp;quot;no-referrer-when-downgrade&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;# See https://github.com/ColinEberhardt/applause-button/issues/72&lt;/span&gt;
        proxy_pass http://192.168.1.51&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;# rpi2.local&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;

    location /.well-known/ &lt;span class="o"&gt;{}&lt;/span&gt;  &lt;span class="c1"&gt;# do not redirect for this directory, used by letsencrypt&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Applying this change to the reverse-proxy (in my case installed on node rpi1.local, the pelican web-server is on 
rpi2.local) worked for me. I could now see that the referer header was set to the full path, and thus the clap is 
registered on the right place. The add_header directive, means that the value of this field is set in the response to
the browser. The browser will then include the full path to the blog entry when using the applause button API, rather
than using only the URI value.&lt;/p&gt;
&lt;p&gt;On the semantics of "no-referrer-when-downgrade" value, please check the 
&lt;a href="https://www.w3.org/TR/referrer-policy/"&gt;specification&lt;/a&gt;.&lt;/p&gt;</content><category term="Technologies"></category><category term="Blog"></category><category term="Applause"></category><category term="nginx"></category><category term="chrome"></category></entry><entry><title>mDNS for Linux</title><link href="https://wlog.viltstigen.se/articles/2021/05/02/mdns-for-linux/" rel="alternate"></link><published>2021-05-02T00:00:00+02:00</published><updated>2021-05-02T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2021-05-02:/articles/2021/05/02/mdns-for-linux/</id><summary type="html">&lt;p&gt;Description of mDNS configuration for Linux Mint 20.1&lt;/p&gt;</summary><content type="html">&lt;p&gt;Switching from Linux Mint 19 to Linux Mint 20.1 meant that pinging host on my local network stopped working.
I could still ping them using IP-addresses, but not their host names&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mm@wolfrax:~/dev/pyPDP/asm$ ping rpi2.local
ping: rpi2.local: Name or service not known
mm@wolfrax:~/dev/pyPDP/asm$ ping &lt;span class="m"&gt;192&lt;/span&gt;.168.1.51
PING &lt;span class="m"&gt;192&lt;/span&gt;.168.1.51 &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;84&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; bytes of data.
&lt;span class="m"&gt;64&lt;/span&gt; bytes from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.51: &lt;span class="nv"&gt;icmp_seq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;ttl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="nv"&gt;time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;.3 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;How come? This made me search and read on the configuration for mDNS.
Until I found the right solution, I edited &lt;code&gt;/etc/hosts&lt;/code&gt; with hard-coded
node name and IP-address (which is Ok, as I have configured static IP-addresses for these nodes).
These looks like so,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mm@wolfrax:~/dev/pyPDP/asm$ cat /etc/hosts
&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1   localhost
&lt;span class="m"&gt;127&lt;/span&gt;.0.1.1   wolfrax

&lt;span class="m"&gt;192&lt;/span&gt;.168.1.50    rpi1
&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51    rpi2
&lt;span class="m"&gt;192&lt;/span&gt;.168.1.52    rpi3
&lt;span class="m"&gt;192&lt;/span&gt;.168.1.53    rpi4
&lt;span class="m"&gt;192&lt;/span&gt;.168.1.54    rpi5    

&lt;span class="c1"&gt;# The following lines are desirable for IPv6 capable hosts&lt;/span&gt;
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
mm@wolfrax:~/dev/pyPDP/asm$ ping rpi2
PING rpi2 &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;84&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; bytes of data.
&lt;span class="m"&gt;64&lt;/span&gt; bytes from rpi2 &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="nv"&gt;icmp_seq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;ttl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="nv"&gt;time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;.61 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;mDNS&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Multicast_DNS"&gt;Multicast DNS&lt;/a&gt; (mDNS) resolve hostnames to IP-addresses for local networks.
By default mDNS resolve hostnames with top-domain &lt;code&gt;.local&lt;/code&gt;. So, &lt;code&gt;rpi2.local&lt;/code&gt; would resolve to IP-address &lt;code&gt;192.168.1.51&lt;/code&gt;
in my network.&lt;/p&gt;
&lt;p&gt;There seems to be several ways to do this in a Linux environment, 3 of them are:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/Avahi_(software)"&gt;Avahi&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/NetworkManager"&gt;NetworkManager&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;systemd-resolved, see &lt;a href="https://en.wikipedia.org/wiki/Systemd"&gt;systemd&lt;/a&gt; and &lt;a href="https://wiki.archlinux.org/title/Systemd-resolved"&gt;systemd-resolved&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;If not configured correctly, they might counteract each other. 
See &lt;a href="https://wiki.archlinux.org/index.php/Systemd-resolved#mDNS"&gt;this article&lt;/a&gt; where disabling Avahi is suggested.&lt;/p&gt;
&lt;p&gt;After some searching, I found &lt;a href="https://forums.linuxmint.com/viewtopic.php?p=1949048&amp;amp;sid=5bca7944423fb53de8a9dd8fb0c68ca5#p1949048"&gt;this thread&lt;/a&gt;
where the problem I have where noted and resolved...somehwat.
The core of the thread is to enable multicastDNS by editing &lt;code&gt;/etc/systemd/resolved.conf&lt;/code&gt; and editing the file so&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="na"&gt;MulticastDNS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;yes&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then issue the following command (change interface to appropriate value) to set mdns for the interface&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo systemd-resolve --set-mdns&lt;span class="o"&gt;=&lt;/span&gt;yes --interface&lt;span class="o"&gt;=&lt;/span&gt;wlp3s0
$ ping rpi2.local
PING rpi2.local &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;84&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; bytes of data.
&lt;span class="m"&gt;64&lt;/span&gt; bytes from rpi2 &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="nv"&gt;icmp_seq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;ttl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="nv"&gt;time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.26 ms
&lt;span class="m"&gt;64&lt;/span&gt; bytes from rpi2 &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.51&lt;span class="o"&gt;)&lt;/span&gt;: &lt;span class="nv"&gt;icmp_seq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;ttl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="nv"&gt;time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.34 ms
$ resolvectl
Global
       LLMNR setting: no                  
MulticastDNS setting: yes                 
  DNSOverTLS setting: no                  
      DNSSEC setting: no                  
    DNSSEC supported: no                  
          DNSSEC NTA: &lt;span class="m"&gt;10&lt;/span&gt;.in-addr.arpa     
                      &lt;span class="m"&gt;16&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;168&lt;/span&gt;.192.in-addr.arpa
                      &lt;span class="m"&gt;17&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;18&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;19&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;20&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;21&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;22&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;23&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;24&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;25&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;26&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;27&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;28&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;29&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;30&lt;/span&gt;.172.in-addr.arpa 
                      &lt;span class="m"&gt;31&lt;/span&gt;.172.in-addr.arpa 
                      corp                
                      d.f.ip6.arpa        
                      home                
                      internal            
                      intranet            
                      lan                 
                      &lt;span class="nb"&gt;local&lt;/span&gt;               
                      private             
                      &lt;span class="nb"&gt;test&lt;/span&gt;                

Link &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;wlp3s0&lt;span class="o"&gt;)&lt;/span&gt;
      Current Scopes: DNS mDNS/IPv4 mDNS/IPv6
DefaultRoute setting: yes                    
       LLMNR setting: yes                    
MulticastDNS setting: yes             
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Works! Until you switch the interface off, then on again. The mdns setting for the interface has been lost. :-(&lt;/p&gt;
&lt;p&gt;But, it can be fixed! Here is how.&lt;/p&gt;
&lt;p&gt;Create a file named for example &lt;code&gt;wifi.network&lt;/code&gt; (it can be named anything, but the file extension &lt;em&gt;must&lt;/em&gt; be &lt;code&gt;network&lt;/code&gt;).
Store the file in &lt;code&gt;/etc/systemd/network&lt;/code&gt;. The content of the file is&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;[Match]&lt;/span&gt;
&lt;span class="na"&gt;Name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;w*&lt;/span&gt;

&lt;span class="k"&gt;[Network]&lt;/span&gt;
&lt;span class="na"&gt;DHCP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;yes&lt;/span&gt;
&lt;span class="na"&gt;MulticastDNS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;yes&lt;/span&gt;
&lt;span class="na"&gt;LLMR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;no&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Note the wildcard on the Match-section. It could also be stated as &lt;code&gt;Name=wlp3s0&lt;/code&gt;.
So, the logic is that mDNS needs to be enabled &lt;em&gt;both&lt;/em&gt; in &lt;code&gt;resolved.conf&lt;/code&gt; (globally) and per link in a new file with
extension &lt;code&gt;network&lt;/code&gt; to become persistent.&lt;/p&gt;
&lt;p&gt;Make systemd read the changes and check status using &lt;a href="https://www.freedesktop.org/software/systemd/man/networkctl.html#"&gt;networkctl&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ networkctl reload
$ networkctl list
IDX LINK      TYPE     OPERATIONAL SETUP     
  &lt;span class="m"&gt;1&lt;/span&gt; lo        loopback carrier     unmanaged 
  &lt;span class="m"&gt;2&lt;/span&gt; enp0s31f6 ether    no-carrier  unmanaged 
  &lt;span class="m"&gt;3&lt;/span&gt; wlp3s0    wlan     routable    configured
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now, the system should find &lt;code&gt;rpi2.local&lt;/code&gt; always.&lt;/p&gt;
&lt;p&gt;Note that if &lt;code&gt;systemd.networkd&lt;/code&gt; is not enabled/running, do this through&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; systemd-networkd
$ sudo systemctl start systemd-networkd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1&gt;Using DNS stub file&lt;/h1&gt;
&lt;p&gt;Note below information from &lt;a href="https://wiki.archlinux.org/title/Systemd-resolved#DNS"&gt;archlinux&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Using the systemd DNS stub file - the systemd DNS stub file &lt;code&gt;/run/systemd/resolve/stub-resolv.conf&lt;/code&gt; contains the local 
stub 127.0.0.53 as the only DNS server and a list of search domains. This is the recommended mode of operation. 
The service users are advised to redirect the /etc/resolv.conf file to the local stub DNS resolver file 
&lt;code&gt;/run/systemd/resolve/stub-resolv.conf&lt;/code&gt; managed by systemd-resolved. This propagates the systemd managed configuration 
to all the clients. This can be done by replacing /etc/resolv.conf with a symbolic link to the systemd stub:
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo ln -sf /run/systemd/resolve/stub-resolv.conf /etc/resolv.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Technologies"></category><category term="Linux"></category><category term="mDNS"></category></entry><entry><title>rsyslog daemon filling syslog</title><link href="https://wlog.viltstigen.se/articles/2020/10/07/rsyslog-daemon-filling-syslog/" rel="alternate"></link><published>2020-10-07T00:00:00+02:00</published><updated>2020-10-07T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-10-07:/articles/2020/10/07/rsyslog-daemon-filling-syslog/</id><summary type="html">&lt;p&gt;rsyslog daemon is recurrently adding entries to /var/log/syslog ("rsyslogd-2007: action 'action 18'")&lt;/p&gt;</summary><content type="html">&lt;h1&gt;rsyslog&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://www.rsyslog.com/"&gt;ryslog&lt;/a&gt; is a logging system used in several Linux distributions, including raspbian.&lt;/p&gt;
&lt;p&gt;I noticed that on one of my Raspberrys (not all) I had recurrent log entries of type&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Oct  7 18:59:38 rpi1 rsyslogd-2007: action &amp;#39;action 18&amp;#39; suspended, next retry is Wed Oct  7 19:01:08 2020 [try http://www.rsyslog.com/e/2007 ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After some investigations, (it is discussed in this &lt;a href="https://www.raspberrypi.org/forums/viewtopic.php?f=63&amp;amp;t=134971#p898539"&gt;thread&lt;/a&gt;)
I found out that the root cause is that rsyslogd tries to pipe messages to &lt;code&gt;/dev/xconsole&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The problem basically is, that no program is reading from &lt;code&gt;/dev/xconsole&lt;/code&gt;, so the pipe runs full and rsyslog (correctly) 
logs this issue. So this is expected behaviour, but I want to get rid of the messages in &lt;code&gt;/var/log/syslog&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The fix is to comment out the following lines in &lt;code&gt;/etc/rsyslog.conf&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;#daemon.*;mail.*;\
#   news.err;\
#   *.=debug;*.=info;\
#   *.=notice;*.=warn   |/dev/xconsole
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then restart the rsyslog daemon&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo systemctl restart rsyslog
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Should then be Ok.&lt;/p&gt;</content><category term="Technologies"></category><category term="Linux"></category><category term="Raspberry"></category></entry><entry><title>Trafikverket weather station</title><link href="https://wlog.viltstigen.se/articles/2020/10/07/trafikverket-weather-station/" rel="alternate"></link><published>2020-10-07T00:00:00+02:00</published><updated>2020-10-12T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-10-07:/articles/2020/10/07/trafikverket-weather-station/</id><summary type="html">&lt;p&gt;How to read and plot weather information by Trafikverket&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;In Sweden, Trafikverket (Swedish Transport Administration) have a 
&lt;a href="https://www.trafikverket.se/tjanster/trafiktjanster/VViS/"&gt;country wide network of weather stations&lt;/a&gt; monitor
road conditions. The primary purpose is to use data for managing of roads, but data is available through
an &lt;a href="https://api.trafikinfo.trafikverket.se/"&gt;Open API&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I have &lt;a href="https://github.com/Wolfrax/tv"&gt;implemented&lt;/a&gt; reading data from selected station recurrently (when new data is 
produced), store into a file and generates some plots as png-files and an HTML-file. The implementation store and plot 
24 hours of data at most.&lt;/p&gt;
&lt;p&gt;As an example, weather data for station "Lund N" is &lt;a href="https://www.viltstigen.se/tv_ws/"&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;Implementation&lt;/h1&gt;
&lt;p&gt;Using the Open API require an authorization key, a &lt;a href="https://api.trafikinfo.trafikverket.se/Account/Register"&gt;registration&lt;/a&gt;
is needed (free of charge). The key is available there.
The key is added to file &lt;code&gt;auth.yml&lt;/code&gt; using syntax:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;auth&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;71&lt;/span&gt;&lt;span class="n"&gt;fa8aa80d&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The python program will read the key from this file.&lt;/p&gt;
&lt;p&gt;To get the data, a query-string is needed, following the syntax as stated by Trafikverket.
Something like this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;REQUEST&amp;gt;
  &amp;lt;LOGIN authenticationkey=&amp;#39;71fa8aa80d...&amp;#39;/&amp;gt;
  &amp;lt;QUERY sseurl=&amp;quot;true&amp;quot; objecttype=&amp;#39;WeatherStation&amp;#39; schemaversion=&amp;#39;1&amp;#39;&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Air.RelativeHumidity&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Air.Temp&amp;lt;/INCLUDE&amp;gt;  
    &amp;lt;INCLUDE&amp;gt;Measurement.MeasureTime&amp;lt;/INCLUDE&amp;gt;    
    &amp;lt;INCLUDE&amp;gt;Measurement.Precipitation.Amount&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Precipitation.AmountName&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Precipitation.Type&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Wind.Direction&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Wind.Force&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Measurement.Wind.ForceMax&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;INCLUDE&amp;gt;Name&amp;lt;/INCLUDE&amp;gt;
    &amp;lt;FILTER&amp;gt;
        &amp;lt;EQ name=&amp;quot;Name&amp;quot; value=&amp;#39;Lund N&amp;#39; /&amp;gt;
    &amp;lt;/FILTER&amp;gt;
  &amp;lt;/QUERY&amp;gt;
&amp;lt;/REQUEST&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Any station available can be read by using its name, refer to this &lt;a href="https://www.trafikverket.se/trafikinformation/vag/?TrafficType=personalTraffic&amp;amp;map=1%2F606442.17%2F6886316.22%2F&amp;amp;Layers=RoadWeather%2b"&gt;map&lt;/a&gt;
and zoom in to find the right name and use this in the &lt;code&gt;&amp;lt;FILTER&amp;gt;&lt;/code&gt; paragraph.&lt;/p&gt;
&lt;p&gt;The implementation starts with making a HTTP-GET request for json-formatted information:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;https://api.trafikinfo.trafikverket.se/v2/data.json&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text/xml&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The response will include a &lt;code&gt;sse_url&lt;/code&gt;, this can be used as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;sse_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RESPONSE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RESULT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;INFO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SSEURL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;messages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SSEClient&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sse_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="c1"&gt;# more code here&lt;/span&gt;
    &lt;span class="c1"&gt;# ...&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ConnectionResetError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sse_url&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;amp;lasteventid=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;
    &lt;span class="n"&gt;messages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SSEClient&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Exception handling is needed as the connection to the server will go up and down. To continue reading from the same stream
the parameter &lt;code&gt;lasteventid&lt;/code&gt; need to have the value in &lt;code&gt;msg.id&lt;/code&gt; from the last received message.&lt;/p&gt;
&lt;p&gt;The for-loop to get messages is contained in a &lt;code&gt;while True&lt;/code&gt;-loop that includes the exception handling. Thus we have fixed
a robust connection toward Trafikverket. This has implication for the plotting, described below.&lt;/p&gt;
&lt;p&gt;What Trafikverket implemented is so called &lt;a href="https://en.wikipedia.org/wiki/Server-sent_events"&gt;Server Side Events (SSE)&lt;/a&gt;.
This means that the server push notification on the connection when data is available, the client doesn't have to
recurrently poll the server. Thus, most of the time the implementation is stuck in the &lt;code&gt;for msg in message&lt;/code&gt; statement.&lt;/p&gt;
&lt;p&gt;When data  is available, we pick it up by&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Following that, the data can be processed, for exampled plotted, thi is described below.&lt;/p&gt;
&lt;p&gt;As the plotting is made within a loop (the outmost loop is the &lt;code&gt;while True&lt;/code&gt; loop, and the inner loop is the
&lt;code&gt;for msg in messages&lt;/code&gt;) we need to consider how memory is handled when plotting. In my case, I use maplotlib and figures,
subplots, axis etc needs to be explicitly closed before we plot next time in the loops.&lt;/p&gt;
&lt;p&gt;There are several ways to do this of course, as an exercise I chose to start a new process each time a plot is generated.
This will free up any memory used by matplotlib when the process terminates. It might look as overkill (and probably is...)
but does the work, and, besides, plotting is normally made every 10:nth minute.&lt;/p&gt;
&lt;p&gt;This snippet shows the process thing for plotting:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;do_graph&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msr&lt;/span&gt;&lt;span class="p"&gt;,))&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;120&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# kill after 2 minutes&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exitcode&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exitcode&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Graphical process - exit on timeout, is_alive is &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_alive&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_alive&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kill&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A new process is created, executing the routine &lt;code&gt;do_graph&lt;/code&gt; with argument &lt;code&gt;msr&lt;/code&gt; (that includes data to be plotted).
The process needs to be explicitly started (&lt;code&gt;p.start()&lt;/code&gt;), the we wait at most 120 seconds for it to terminate
(&lt;code&gt;p.join()&lt;/code&gt;). If the join-statement timeout, ie something has gone wrong, we issue a warning and check if the process is
still alive. If it is, brutally kill it (&lt;code&gt;p.kill()&lt;/code&gt;) .&lt;/p&gt;
&lt;p&gt;Ok, now for plotting&lt;/p&gt;
&lt;h1&gt;Plotting&lt;/h1&gt;
&lt;p&gt;I use &lt;a href="https://matplotlib.org/index.html"&gt;matplotlib&lt;/a&gt;, partly for training purposes for the 'normal' plots.
For windrose plotting, I use &lt;a href="https://github.com/python-windrose/windrose"&gt;python-windrose&lt;/a&gt; for convenience.&lt;/p&gt;
&lt;p&gt;As several plots have a time axis, I need to adjust matplotlibs timezone setting (in my case UTC+2:00 hours) or else
the plots will be wrongly adjusted.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;matplotlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rcParams&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;timezone&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;+2:00&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Using matplotlib, I create 2 figures. Figure 1 for plotting air temperature, humidity (in the same sub-plot), rain
(in a second sub-plot) and wind force/direction (sub-plot 3). 
Figure 2 is the windrose plot.&lt;/p&gt;
&lt;p&gt;For figure 1, we do:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;temp_rain_fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;ax1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;temp_rain_fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;twinx&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c1"&gt;# Create a right-hand y-axis&lt;/span&gt;
&lt;span class="n"&gt;temp_rain_fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ax3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sharex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Share x-axis with subplot 1&lt;/span&gt;
&lt;span class="n"&gt;temp_rain_fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ax4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ax3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;twinx&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;temp_rain_fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ax5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sharex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# Share x-axis with subplot 1&lt;/span&gt;
&lt;span class="n"&gt;temp_rain_fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This figure (&lt;code&gt;temp_rain_fig&lt;/code&gt;) have 3 subplots:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ax1, ax2: To plot temperature (y-axis to left) and humidity (y-axis on right)&lt;/li&gt;
&lt;li&gt;ax3, ax4: To plot rain, both non-accumlated (y-axis to left) and accumulated (y-axis on right) &lt;/li&gt;
&lt;li&gt;ax5: To plot wind strength, both average and maximum as two graphs. To this graph, wind direction will be added&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The last plot is generated into a separate figure. This is the windrose plot.
This comes with a separate library, &lt;a href="https://github.com/python-windrose/windrose"&gt;python-windrose&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;windrose_fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;THETA_LABELS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;E&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;N-E&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;N&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;N-W&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;W&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;S-W&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;S-E&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;wr_ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;WindroseAxes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_ax&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;windrose_fig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;theta_labels&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;THETA_LABELS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;windrose_fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wr_ax&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To get the labeling right for the windrose plot, &lt;code&gt;THETA_LABLES&lt;/code&gt; needs to be explicitly added as above.
This seems to have changed over versions (I'm using version 1.6.8).&lt;/p&gt;
&lt;p&gt;Before plotting, data is collected into lists, for example&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;dateutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;MeasureTime&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;msr&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;msr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Air&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Temp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;msr&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;annotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;xy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;annotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;xy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The last 2 rows, annotates the graph at start and endpoints.&lt;/p&gt;
&lt;p&gt;The windrose is made like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wr_ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;wind_force&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;normed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;opening&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;For the plotting of wind direction and strength (in the oridnary plot, not windrose), this snippet is applicable:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;WIND_LABELS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;N&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;N-E&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;E&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;S-E&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;S-W&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;W&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;N-W&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;WIND_DEGREES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;315&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;270&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;225&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;180&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;135&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;bins&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;360&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WIND_LABELS&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_dir_hour&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;bin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digitize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_dir_hour&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# bin can be out of index if &amp;quot;Direction&amp;quot; == &amp;quot;NaN&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;bin&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WIND_DEGREES&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MarkerStyle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;$\leftarrow$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_transform&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rotate_deg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WIND_DEGREES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;bin&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ax5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_time_hour&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;wind_val_hour&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                      &lt;span class="n"&gt;marker&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;markersize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                      &lt;span class="n"&gt;linestyle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;None&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;crimson&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;dir&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_dir_hour&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;bin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;digitize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_dir_hour&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;bin&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WIND_LABELS&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ax5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;annotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;WIND_LABELS&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;bin&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wind_time_hour&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;wind_val_hour&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
                          &lt;span class="n"&gt;xytext&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;textcoords&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;offset points&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;First, I divide the space 0 - 360 into 8 bins (length of WIND_LABELS), then I loop over a list of hourly wind directions
(a subset of all wind direction measurements) and catch into which bin each value goes into (bin).
Now, wind direction values might have the value 'NaN' in case I have prevously caught a strange or missing value (this happens).&lt;/p&gt;
&lt;p&gt;On the graph for wind force, I want to indicate the wind direction, so I capture a lefthand arraw symbol as marker
(&lt;code&gt;r$\leftarrow$&lt;/code&gt;) and rotate (&lt;code&gt;_transform.rotate&lt;/code&gt;) this by looking up a value in WIND_DEGREES using the previous bin
value. Finally, I plot the rotated marker on ax5.&lt;/p&gt;
&lt;p&gt;I also want to annotate the wind direction below the marker, which is the last part of above snippet.&lt;/p&gt;
&lt;p&gt;To format the x-axis of the plots, I use this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;hours&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mdates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HourLocator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;interval&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;h_fmt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mdates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateFormatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;%H:%M&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tick_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;x&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labelrotation&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xaxis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_major_locator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hours&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xaxis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_major_formatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;h_fmt&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Using this, I set the format "10:00", rotated 45 degrees, on each tick at the x-axis.&lt;/p&gt;
&lt;h2&gt;Daemon&lt;/h2&gt;
&lt;p&gt;The script runs as a daemon on a Raspberry Pi, to have this &lt;code&gt;systemd&lt;/code&gt; is used and a service description file with
content below is stored in &lt;code&gt;/etc/systemd/system/tv_ws.service&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[Unit]
Description=Trafikverket weatherstation
After=network.target

[Service]
# To enable this, systemctl needs to be done in the following order
#   $ sudo systemctl enable /home/pi/rpi5/etc/systemd/user/tv_ws.service
#   $ sudo systemctl start tv_ws.service
# The first (enable) command will create symlink and enable the service so it get started at reboot
#
Type=simple
WorkingDirectory=/home/pi/app/tv
User=pi
Group=www-data
ExecStart=/home/pi/app/tv/.venv/bin/python ws.py
Restart=always

[Install]
WantedBy=multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;An HTML file is generated by the script using Flask, the file make reference to the plots that is saved as PNG-files.&lt;/p&gt;
&lt;p&gt;Refer to the full implementation &lt;a href="https://github.com/Wolfrax/tv"&gt;here&lt;/a&gt;&lt;/p&gt;</content><category term="Technologies"></category><category term="Python"></category><category term="weather"></category></entry><entry><title>Installing geopandas and geoplot on Raspberry Pi</title><link href="https://wlog.viltstigen.se/articles/2020/07/07/installing-geopandas-and-geoplot-on-raspberry-pi/" rel="alternate"></link><published>2020-07-07T00:00:00+02:00</published><updated>2020-07-14T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-07-07:/articles/2020/07/07/installing-geopandas-and-geoplot-on-raspberry-pi/</id><summary type="html">&lt;p&gt;Installing geopandas and geoplot on Raspberry Pi running buster&lt;/p&gt;</summary><content type="html">&lt;p&gt;Installing &lt;a href="https://geopandas.readthedocs.io/en/latest/"&gt;geopandas&lt;/a&gt; and 
&lt;a href="https://residentmario.github.io/geoplot/index.html"&gt;geoplot&lt;/a&gt; on a Raspberry Pi turned out not to be 
straight forward. Hence, I tried to resolve and install this manually. The details of the environment is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Raspberry Pi 3 Model B Rev 1.2, Linux version 4.19.118-v7+, Raspbian GNU/Linux 10 (buster)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Just installing geopandas and geoplot using pip fails due to the dependencies these packages have.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;geopandas requires &lt;strong&gt;fiona, shapely, pandas, pyproj&lt;/strong&gt; (use &lt;code&gt;pip show geopandas&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;geoplot requires: &lt;strong&gt;geopandas, descartes, contextily, seaborn, pandas, mapclassify, matplotlib, cartopy&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Specifically, there is some underlying dependencies of libraries 
&lt;strong&gt;&lt;a href="https://gdal.org/"&gt;gdal&lt;/a&gt;, &lt;a href="https://proj.org/about.html"&gt;proj&lt;/a&gt;&lt;/strong&gt; that needs to be resolved before installing.&lt;/p&gt;
&lt;p&gt;The following recipe worked for me:&lt;/p&gt;
&lt;p&gt;First install gdal and check version&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    $ sudo apt-get install gdal-bin, libgdal-dev
    $ gdal-config --version
    &lt;span class="m"&gt;2&lt;/span&gt;.4.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Install &lt;code&gt;proj&lt;/code&gt; version 6.3.2 using a tmp-directory, first install sqlite3 that &lt;code&gt;proj&lt;/code&gt; is using&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo apt-get install sqlite3
$ mkdir tmp
$ &lt;span class="nb"&gt;cd&lt;/span&gt; tmp
$ wget https://download.osgeo.org/proj/proj-6.3.2.tar.gz
$ tar xvf proj-6.3.2.tar.gz 
$ &lt;span class="nb"&gt;cd&lt;/span&gt; proj-6.3.2
$ ./configure
$ make
$ sudo make install
$ sudo ldconfig
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now install &lt;code&gt;&lt;a href="https://github.com/Toblerity/Fiona"&gt;fiona&lt;/a&gt;&lt;/code&gt; and 
  &lt;code&gt;&lt;a href="http://pyproj4.github.io/pyproj/stable/"&gt;pyproj&lt;/a&gt;&lt;/code&gt; version 1.9.6&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ pip install fiona
$ pip install &lt;span class="nv"&gt;pyproj&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.9.6
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Before we can install geoplot, the library &lt;code&gt;&lt;a href="https://packages.debian.org/sid/libatlas-base-dev"&gt;libatlas&lt;/a&gt;&lt;/code&gt;
  needs to be installed. Then try to install &lt;code&gt;&lt;a href="https://geopandas.readthedocs.io/en/latest/"&gt;geopandas&lt;/a&gt;&lt;/code&gt; and
  &lt;code&gt;&lt;a href="https://residentmario.github.io/geoplot/index.html"&gt;geoplot&lt;/a&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;geopandas also depends on &lt;code&gt;&lt;a href="https://shapely.readthedocs.io/en/latest/"&gt;shapely&lt;/a&gt;&lt;/code&gt; and
  &lt;code&gt;&lt;a href="https://github.com/Toblerity/rtree"&gt;rtree&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To install &lt;code&gt;rtree&lt;/code&gt; I had to build the underlying library &lt;a href="https://libspatialindex.org/"&gt;libspatialindex&lt;/a&gt; from source.
Here is how (if cmake is not installed, use &lt;code&gt;apt-get install cmake&lt;/code&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ mkdir libspatialindex
$ &lt;span class="nb"&gt;cd&lt;/span&gt; libspatialindex/
$ wget https://github.com/libspatialindex/libspatialindex/releases/download/1.9.3/spatialindex-src-1.9.3.tar.gz
$ tar -xvf spatialindex-src-1.9.3.tar.gz
$ &lt;span class="nb"&gt;cd&lt;/span&gt; spatialindex-src-1.9.3/
$ cmake -DCMAKE_INSTALL_PREFIX&lt;span class="o"&gt;=&lt;/span&gt;/usr/local .
$ make
$ sudo make install
$ sudo ldconfig
$ pip install rtree
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To ensure that the correct version of &lt;code&gt;shapely&lt;/code&gt; is used, don't install the binary. 
I encountered errors like below due to wrong version of &lt;code&gt;shapely&lt;/code&gt;, see &lt;a href="https://stackoverflow.com/questions/60111684/geometry-must-be-a-point-or-linestring-error-using-cartopy"&gt;stackoverflow&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;python: geos_ts_c.cpp:3991: int GEOSCoordSeq_getSize_r(GEOSContextHandle_t, const geos::geom::CoordinateSequence*, unsigned int*): Assertion `0 != cs&amp;#39; failed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Below &lt;code&gt;shapely&lt;/code&gt; is first uninstalled (as I used thw wrong version), then re-installed not using binary default option&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ pip uninstall shapely
$ pip install shapely --no-binary shapely
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now finally install &lt;code&gt;libatlas&lt;/code&gt;, &lt;code&gt;geopandas&lt;/code&gt; and &lt;code&gt;geoplot&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo apt-get install libatlas-base-dev
$ pip install geopandas
$ pip install geoplot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;During my installation, I got error messages but the installation and setup still worked&lt;/p&gt;</content><category term="Technologies"></category><category term="Linux"></category><category term="Raspberry"></category><category term="GIS"></category></entry><entry><title>SMHI Meteorological observations</title><link href="https://wlog.viltstigen.se/articles/2020/07/05/smhi-meteorological-observations/" rel="alternate"></link><published>2020-07-05T00:00:00+02:00</published><updated>2020-07-11T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-07-05:/articles/2020/07/05/smhi-meteorological-observations/</id><summary type="html">&lt;p&gt;Collecting meteorological observations by SMHI and making it accessible&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://www.smhi.se/omsmhi"&gt;SMHI&lt;/a&gt; is publishing meteorological observations recurrently as open data, this is
accessible through a REST API, documented &lt;a href="https://opendata.smhi.se/apidocs/metobs/index.html"&gt;here&lt;/a&gt;.
The API is documented but not very accessible as you need to traverse several levels to reach the actual observations.&lt;/p&gt;
&lt;p&gt;In order to simplify, and to make observations available in &lt;a href="https://geojson.org/"&gt;GeoJSON&lt;/a&gt; format, I have created an
infrastructure that once per day reads all available observations, transform it into GeoJSON and store into files 
(one file per observation). Access to these files are made by generating web-pages and also through a simple web API.
This means that files can be downloaded, or read by accessing web URL's.&lt;/p&gt;
&lt;p&gt;The main entry point to the web pages is &lt;a href="https://www.viltstigen.se/smhi_metobs/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Collecting observations&lt;/h2&gt;
&lt;p&gt;Once per day, at midnight, a Python script is executed (through crontab, using a Rapsberry Pi). This script traverse
the SMHI open data REST API for meteorological observations and store each observation series into a file with 
extension "geojson". As of now, there is normally 40 different types of observations available, the file created
have a descriptive name in Swedish. For example,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;01_Lufttemperatur__momentanvärde_1_gång_per_tim.geojson
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The prefix in the file name is a unique 2 digit key, ranging from 01 and normally up to 40.&lt;/p&gt;
&lt;p&gt;For each type of observation, SMHI has a number of stations distributed through out Sweden. The number of stations might
differ of each type of observation and might include stations that are not active. Further, some observations will have
stations with the same longitude/latitude values, thus making duplicates. The script handles duplicates and validate the
resulting GeoJSON file.&lt;/p&gt;
&lt;h3&gt;Collector script&lt;/h3&gt;
&lt;p&gt;The full script is available &lt;a href="https://github.com/Wolfrax/smhi/blob/master/py/collector_metobs.py"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Multi threading, one thread per observation, is used to speed up sampling. The SMHI REST API is traversed and each 
observation is stored as one file. Each observation is stored as a GeoJSON feature, see below.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;point&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geojson&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Point&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;longitude&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;latitude&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="n"&gt;feature&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geojson&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Feature&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;point&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                          &lt;span class="n"&gt;properties&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;key&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;key&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                      &lt;span class="s2"&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                      &lt;span class="s2"&gt;&amp;quot;summary&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;summary&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                      &lt;span class="s2"&gt;&amp;quot;updated&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;updated&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                      &lt;span class="s2"&gt;&amp;quot;timestamp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                      &lt;span class="s2"&gt;&amp;quot;height&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;height&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                      &lt;span class="s2"&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
                          &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The files, can be read using &lt;a href="https://geopandas.readthedocs.io/en/latest/index.html"&gt;Geopandas&lt;/a&gt;, as an example see
&lt;a href="https://wlog.viltstigen.se/articles/2020/06/19/maps-with-geopandas-and-geoplot/"&gt;this post&lt;/a&gt;.
A couple of other files is created:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;meta.json&lt;/strong&gt;, a file with some meta data about the collected observations, refer to the script for details&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;index.html&lt;/strong&gt;, a listing of all observation files generated, for example see &lt;a href="https://www.viltstigen.se/smhi_metobs2020/07/05/"&gt;this&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;a root index.html&lt;/strong&gt; file, &lt;a href="https://www.viltstigen.se/smhi_metobs/"&gt;link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;latest&lt;/strong&gt; symbolic link in the root pointing to the latest generated files, see explanation below&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The script is executed once per day by a crontab entry. &lt;strong&gt;Note&lt;/strong&gt;, some observations are updated multiple times per day
by SMHI. As the collector script is executed only once per day, multiple updates will be missed.&lt;/p&gt;
&lt;h3&gt;Directory structure&lt;/h3&gt;
&lt;p&gt;The files are stored into a hierarchy, below the root directory are (in order) year, month, day.
As an example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;metobs/
       latest
       index.html
       2020/      
            07/  
               05/
                  01_xxx.geojson
                  meta.json
                  index.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The root index.html file have sorted tables per year to navigate to the wanted observations for easy access.
In the root there is also a symbolic link "latest" that points to the last generated observations.&lt;/p&gt;
&lt;h3&gt;Information&lt;/h3&gt;
&lt;p&gt;In the geojson file with observations, the general structure is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Latitude and Longitude as a Point object in &lt;code&gt;geometry&lt;/code&gt; (using coordinate reference system WGS84)&lt;/li&gt;
&lt;li&gt;Station name in &lt;code&gt;id&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;key&lt;/code&gt;, unique 2 digit key for each type of observation&lt;/li&gt;
&lt;li&gt;A &lt;code&gt;title&lt;/code&gt; for each observation&lt;/li&gt;
&lt;li&gt;A &lt;code&gt;summary&lt;/code&gt; for each observation&lt;/li&gt;
&lt;li&gt;&lt;code&gt;updated&lt;/code&gt; is a timestamp when the observation were made (in Unix EPOCH)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;timestamp&lt;/code&gt; is the same information as &lt;code&gt;updated&lt;/code&gt; but as a readable string&lt;/li&gt;
&lt;li&gt;&lt;code&gt;height&lt;/code&gt;, the height in meters above sea level for the station&lt;/li&gt;
&lt;li&gt;&lt;code&gt;value&lt;/code&gt;, the actual observation value. Normally a figure, but sometime it is a coded value 
  (refer to &lt;a href="https://opendata.smhi.se/apidocs/metobs/codes.html"&gt;SMHI&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the file &lt;code&gt;meta.json&lt;/code&gt;, located in each observation directory, some meta data is accessible:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;generated&lt;/strong&gt;, timestamp when the observation were collected and stored&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;resources&lt;/strong&gt;, number of observations collected&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;translations&lt;/strong&gt;, a record for each type of observation with these fields:&lt;ul&gt;
&lt;li&gt;2 digit string starting with "01", unique for each observation&lt;/li&gt;
&lt;li&gt;resource: record with these fields&lt;ul&gt;
&lt;li&gt;key: 2 digit string, starting with "01", unique for each observation&lt;/li&gt;
&lt;li&gt;title: string, type of observation, for example "Lufttemperatur" (Air temperature)&lt;/li&gt;
&lt;li&gt;summary: string, description of observation, typically how often&lt;/li&gt;
&lt;li&gt;link: string, URL to SMHI open data where the latest observation can be collected&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Access&lt;/h3&gt;
&lt;p&gt;Access to observations can be made by interactively browse the &lt;a href="https://www.viltstigen.se/smhi_metobs/"&gt;web pages&lt;/a&gt; and
downloading relevant files.&lt;/p&gt;
&lt;p&gt;Programatically, the observations can be accessed using the URL &lt;code&gt;https://www.viltstigen.se/metobs&lt;/code&gt; as a base.
Appending, in this order, &amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&amp;lt;day&amp;gt;/&amp;lt;filename&amp;gt;, with &lt;code&gt;year, month, day&lt;/code&gt; expressed 
in digits.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;https://www.viltstigen.se/metobs/2020/07/06/02_Lufttemperatur__medelvärde_1_dygn_1_gång_per_dygn_kl_00.geojson
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To simplify, as file names is long, wildcards are permitted.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;https://www.viltstigen.se/metobs/2020/07/06/02*
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This will get the observation file starting with the key &lt;code&gt;02&lt;/code&gt; which is unique.
Using a wildcard like &lt;code&gt;1*&lt;/code&gt;, will access the first file starting with &lt;code&gt;1&lt;/code&gt; in &lt;strong&gt;sorted&lt;/strong&gt; order, ie the file with key &lt;code&gt;10&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;An additional simplification is to use &lt;code&gt;latest&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;https://www.viltstigen.se/metobs/latest/02*
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This will retrieve the latest observation starting with key &lt;code&gt;02&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;After the daily generation of new files (and new directory), a tarball - &lt;code&gt;metobs_data.tar.gz&lt;/code&gt;is generated for backup
purposes (I copy this file to Google drive using rclone). If so wanted, this file can be downloaded so a private copy of
all information can be generated. Use this url 
&lt;a href="https://www.viltstigen.se/metobs/metobs_data.tar.gz"&gt;https://www.viltstigen.se/metobs/metobs_data.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;A daily graphical weather map is maintained at 
&lt;a href="https://www.viltstigen.se/smhi_metobs/weather.html"&gt;https://www.viltstigen.se/smhi_metobs/weather.html&lt;/a&gt;.&lt;/p&gt;</content><category term="Technologies"></category><category term="GeoJSON"></category><category term="GIS"></category><category term="Open data"></category></entry><entry><title>Maps with Geopandas and Geoplot</title><link href="https://wlog.viltstigen.se/articles/2020/06/19/maps-with-geopandas-and-geoplot/" rel="alternate"></link><published>2020-06-19T00:00:00+02:00</published><updated>2020-07-05T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-06-19:/articles/2020/06/19/maps-with-geopandas-and-geoplot/</id><summary type="html">&lt;p&gt;Generating maps with Geopandas and Geoplot&lt;/p&gt;</summary><content type="html">&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Geopandas-and-Geoplot"&gt;Geopandas and Geoplot&lt;a class="anchor-link" href="#Geopandas-and-Geoplot"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Below is a simple example of using &lt;a href="https://geopandas.readthedocs.io/en/latest/index.html"&gt;geopandas&lt;/a&gt; and &lt;a href="https://residentmario.github.io/geoplot/index.html"&gt;geoplot&lt;/a&gt; to visualize some spatial data.
The data is derived from &lt;a href="https://opendata.smhi.se/apidocs/metobs/index.html"&gt;SMHI Open data&lt;/a&gt; and is downloaded and stored in &lt;a href="https://geojson.org/"&gt;GeoJSON&lt;/a&gt; by a Python script using &lt;a href="https://github.com/jazzband/geojson"&gt;Python bindings and utilities for GeoJSON&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Import libraries and ignore annoying warning message&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;geopandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;gpd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;geoplot&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;gplt&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;warnings&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filterwarnings&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;GeoSeries.isna&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ne"&gt;UserWarning&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Read the shape file downloaded from &lt;a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/"&gt;Natural Earth&lt;/a&gt;.
The file used is &lt;a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-1-states-provinces/"&gt;Admin 1 - States, Provinces&lt;/a&gt;.
Then filter out Sweden.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;world&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gpd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data/ne_10m_admin_1_states_provinces.shp&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;swe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;world&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;world&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;admin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Sweden&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;  &lt;span class="c1"&gt;# Filter out Sweden from the world&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now read the data file on average daily temperatures from SMHI, use the coordinate reference system &lt;a href="https://epsg.io/4326"&gt;WGS84&lt;/a&gt; ("epsg=4326") and display some data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;avg_temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gpd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://www.viltstigen.se/metobs/latest/02*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# Probl in EPSG 3006 or 3021&lt;/span&gt;
&lt;span class="n"&gt;avg_temp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;avg_temp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_crs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epsg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4326&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;avg_temp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;title&lt;/th&gt;
      &lt;th&gt;summary&lt;/th&gt;
      &lt;th&gt;updated&lt;/th&gt;
      &lt;th&gt;timestamp&lt;/th&gt;
      &lt;th&gt;height&lt;/th&gt;
      &lt;th&gt;value&lt;/th&gt;
      &lt;th&gt;geometry&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Abisko Aut&lt;/td&gt;
      &lt;td&gt;02&lt;/td&gt;
      &lt;td&gt;Lufttemperatur&lt;/td&gt;
      &lt;td&gt;medelvärde 1 dygn, 1 gång/dygn, kl 00&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;392.303&lt;/td&gt;
      &lt;td&gt;8.5&lt;/td&gt;
      &lt;td&gt;POINT (18.81640 68.35380)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Adelsö A&lt;/td&gt;
      &lt;td&gt;02&lt;/td&gt;
      &lt;td&gt;Lufttemperatur&lt;/td&gt;
      &lt;td&gt;medelvärde 1 dygn, 1 gång/dygn, kl 00&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;5.612&lt;/td&gt;
      &lt;td&gt;16.7&lt;/td&gt;
      &lt;td&gt;POINT (17.52130 59.35790)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Arjeplog A&lt;/td&gt;
      &lt;td&gt;02&lt;/td&gt;
      &lt;td&gt;Lufttemperatur&lt;/td&gt;
      &lt;td&gt;medelvärde 1 dygn, 1 gång/dygn, kl 00&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;430.839&lt;/td&gt;
      &lt;td&gt;7.6&lt;/td&gt;
      &lt;td&gt;POINT (17.83960 66.05130)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Arvidsjaur A&lt;/td&gt;
      &lt;td&gt;02&lt;/td&gt;
      &lt;td&gt;Lufttemperatur&lt;/td&gt;
      &lt;td&gt;medelvärde 1 dygn, 1 gång/dygn, kl 00&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;382.450&lt;/td&gt;
      &lt;td&gt;6.2&lt;/td&gt;
      &lt;td&gt;POINT (19.26420 65.59410)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Arvika A&lt;/td&gt;
      &lt;td&gt;02&lt;/td&gt;
      &lt;td&gt;Lufttemperatur&lt;/td&gt;
      &lt;td&gt;medelvärde 1 dygn, 1 gång/dygn, kl 00&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;65.758&lt;/td&gt;
      &lt;td&gt;12.5&lt;/td&gt;
      &lt;td&gt;POINT (12.63540 59.67430)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Equally, read some pressure data from the same date and display.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pressure&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gpd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https://www.viltstigen.se/metobs/latest/09*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pressure&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pressure&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_crs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epsg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4326&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pressure&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;key&lt;/th&gt;
      &lt;th&gt;title&lt;/th&gt;
      &lt;th&gt;summary&lt;/th&gt;
      &lt;th&gt;updated&lt;/th&gt;
      &lt;th&gt;timestamp&lt;/th&gt;
      &lt;th&gt;height&lt;/th&gt;
      &lt;th&gt;value&lt;/th&gt;
      &lt;th&gt;geometry&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Abisko Aut&lt;/td&gt;
      &lt;td&gt;09&lt;/td&gt;
      &lt;td&gt;Lufttryck reducerat havsytans nivå&lt;/td&gt;
      &lt;td&gt;vid havsytans nivå, momentanvärde, 1 gång/tim&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;392.303&lt;/td&gt;
      &lt;td&gt;1000.4&lt;/td&gt;
      &lt;td&gt;POINT (18.81640 68.35380)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Arjeplog A&lt;/td&gt;
      &lt;td&gt;09&lt;/td&gt;
      &lt;td&gt;Lufttryck reducerat havsytans nivå&lt;/td&gt;
      &lt;td&gt;vid havsytans nivå, momentanvärde, 1 gång/tim&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;430.839&lt;/td&gt;
      &lt;td&gt;998.7&lt;/td&gt;
      &lt;td&gt;POINT (17.83960 66.05130)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Arvidsjaur A&lt;/td&gt;
      &lt;td&gt;09&lt;/td&gt;
      &lt;td&gt;Lufttryck reducerat havsytans nivå&lt;/td&gt;
      &lt;td&gt;vid havsytans nivå, momentanvärde, 1 gång/tim&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;382.450&lt;/td&gt;
      &lt;td&gt;997.0&lt;/td&gt;
      &lt;td&gt;POINT (19.26420 65.59410)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Arvika A&lt;/td&gt;
      &lt;td&gt;09&lt;/td&gt;
      &lt;td&gt;Lufttryck reducerat havsytans nivå&lt;/td&gt;
      &lt;td&gt;vid havsytans nivå, momentanvärde, 1 gång/tim&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;65.758&lt;/td&gt;
      &lt;td&gt;1001.9&lt;/td&gt;
      &lt;td&gt;POINT (12.63540 59.67430)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Axstål Mo&lt;/td&gt;
      &lt;td&gt;09&lt;/td&gt;
      &lt;td&gt;Lufttryck reducerat havsytans nivå&lt;/td&gt;
      &lt;td&gt;vid havsytans nivå, momentanvärde, 1 gång/tim&lt;/td&gt;
      &lt;td&gt;1593896400000&lt;/td&gt;
      &lt;td&gt;2020-07-04T21:00:00&lt;/td&gt;
      &lt;td&gt;91.000&lt;/td&gt;
      &lt;td&gt;1002.5&lt;/td&gt;
      &lt;td&gt;POINT (14.57220 58.57190)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now do the plotting. Setup the projection, conic projection &lt;a href="https://en.wikipedia.org/wiki/Albers_projection"&gt;Albers&lt;/a&gt;.
2 plots will be made, for temperature and pressure, hence 2 axis is created.&lt;/p&gt;
&lt;p&gt;Do a &lt;a href="https://en.wikipedia.org/wiki/Voronoi_diagram"&gt;voronoi diagram&lt;/a&gt; for temperatures and pressure, then plot Sweden (including counties) on top.
For the voronoi plts, use the colormap ("cmap") &lt;a href="https://matplotlib.org/tutorials/colors/colormaps.html"&gt;coolwarm&lt;/a&gt;, select the value as 'hue="value"`.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gplt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;crs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AlbersEqualArea&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;ax1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;121&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ax2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gplt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;voronoi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;avg_temp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;coolwarm&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;clip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;swe&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;hue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;None&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gplt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;polyplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;swe&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gplt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;voronoi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pressure&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;coolwarm&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;clip&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;swe&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;hue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;None&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
             &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;gplt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;polyplot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;swe&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linewidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;proj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ax2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;cartopy.mpl.geoaxes.GeoAxesSubplot at 0x7fd4f4a5cda0&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's it&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><category term="Technologies"></category><category term="Linux"></category><category term="Jupyter"></category><category term="GeoJSON"></category><category term="GIS"></category></entry><entry><title>Pelican bootstrap3 theme and Jupyter</title><link href="https://wlog.viltstigen.se/articles/2020/06/18/pelican-bootstrap3-theme-and-jupyter/" rel="alternate"></link><published>2020-06-18T00:00:00+02:00</published><updated>2021-04-29T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-06-18:/articles/2020/06/18/pelican-bootstrap3-theme-and-jupyter/</id><summary type="html">&lt;p&gt;A note on using Pelican bootstrap3 theme&lt;/p&gt;</summary><content type="html">&lt;p&gt;I decided to switch from Pelican &lt;a href="https://github.com/Pelican-Elegant/elegant&amp;gt;"&gt;elegant theme&lt;/a&gt; to 
the &lt;a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3"&gt;bootstrap3 theme&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The main reason was to be able to include &lt;a href="https://jupyter.org/"&gt;Jupyter notebooks&lt;/a&gt; in the blog articles.
How to do this was documented for bootstrap3 but not for elegant themes, meaning that it might be possible for the latter 
theme also.&lt;/p&gt;
&lt;p&gt;A few adaptions were needed to make this work.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note, as of 2021-04-30, nbconvert version 5.x needs to be installed. If version 6.x
is used, there will be an error that the template basic cannot be found when generating pelican content
See &lt;a href="https://github.com/danielfrg/pelican-jupyter/issues/126"&gt;this note&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;First install themes, for example (using virtualenvironment venv) and plugins.
Below will install &lt;strong&gt;all&lt;/strong&gt; themes and plugins.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git clone --recursive https://github.com/getpelican/pelican-themes /home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/themes
git clone --recursive https://github.com/getpelican/pelican-plugins /home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/pelican-plugins
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I use the &lt;a href="https://github.com/getpelican/pelican-plugins/tree/master/liquid_tags#ipython-notebooks"&gt;liquid_tags&lt;/a&gt; 
plugin to include Jupyter notebooks in blog articles without losing the styling of these notebooks. See below and 
liquid_tags documentation.&lt;/p&gt;
&lt;p&gt;Add this to &lt;code&gt;pelicanconf.py&lt;/code&gt;, which enables 2 plugins&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Plugins are installed (git clone) into the conda virtual environment for wlog&lt;/span&gt;
&lt;span class="n"&gt;PLUGIN_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/pelican-plugins&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# liquid_tags.notebook: For including Jupyter notebooks {% notebook example.ipynb % }&lt;/span&gt;
&lt;span class="c1"&gt;#         See https://github.com/getpelican/pelican-plugins/tree/master/liquid_tags#ipython-notebooks&lt;/span&gt;
&lt;span class="c1"&gt;# i18n_subsites: For translations, needed for bootstrap3 theme&lt;/span&gt;
&lt;span class="c1"&gt;#         See https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3#installation&lt;/span&gt;
&lt;span class="n"&gt;PLUGINS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;liquid_tags.notebook&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;i18n_subsites&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;IGNORE_FILES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.ipynb_checkpoints&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;NOTEBOOK_DIR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;notebooks&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# Next to articles in the content directory, store Jupyter notebooks here&lt;/span&gt;

&lt;span class="c1"&gt;# Include the _nb_header.html styling file, generated automatically by liquid_tags.notebook at first run&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;
&lt;span class="n"&gt;EXTRA_HEADER&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_nb_header.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Using this syntax in a markdown file will include the file &lt;code&gt;example.ipynb&lt;/code&gt; from the notebooks directory (sub directory 
to content).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;{% notebook example.ipynb %}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now add below at the top in the file &lt;code&gt;base.html&lt;/code&gt; for the bootstrap theme, this will include &lt;code&gt;_nb_header.html&lt;/code&gt;
that is generated first time pelican generates content. &lt;code&gt;nb_header.html&lt;/code&gt; includes all Jupyter notebook
styling elements (Twitter bootstrap).
(File located at &lt;code&gt;/home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/themes&lt;/code&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;EXTRA_HEADER&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;EXTRA_HEADER&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Using the latest version of &lt;code&gt;liquid_tags.notebook&lt;/code&gt; I encountered a problem probably due to a configuration issue in my setup.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Could&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;process&lt;/span&gt; &lt;span class="n"&gt;articles&lt;/span&gt;&lt;span class="sr"&gt;/Technologies/&lt;/span&gt;&lt;span class="n"&gt;exmaple&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;md&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;NameError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;settings&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;defined&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In the file &lt;code&gt;notebook.py&lt;/code&gt; I made the following update which fixed the problem for me (commented row is original code).
(/home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/pelican-plugins/liquid_tags/notebook.py)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="c1"&gt;# nb_path = os.path.join(settings.get(&amp;#39;PATH&amp;#39;, &amp;#39;content&amp;#39;), nb_dir, src)&lt;/span&gt;
    &lt;span class="n"&gt;nb_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;content&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nb_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To configure the bootstrap3 theme these settings were added in &lt;code&gt;pelicanconf.py&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# bootstrap3 theme settings, see https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3&lt;/span&gt;
&lt;span class="n"&gt;THEME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pelican-bootstrap3&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;JINJA_ENVIRONMENT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;extensions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;jinja2.ext.i18n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;
&lt;span class="n"&gt;PYGMENTS_STYLE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;  &lt;span class="c1"&gt;# See https://help.farbox.com/pygments.html for examples&lt;/span&gt;
&lt;span class="n"&gt;SITELOGO&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;img/Wolf_logo.png&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;SITELOGO_SIZE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="n"&gt;DISPLAY_ARTICLE_INFO_ON_INDEX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;DISPLAY_RECENT_POSTS_ON_SIDEBAR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;GITHUB_USER&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;wolfrax&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;DISPLAY_PAGES_ON_MENU&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;MENUITEMS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Archive&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/archives.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;YEAR_ARCHIVE_SAVE_AS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;archive/{date:%Y}/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;MONTH_ARCHIVE_SAVE_AS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;archive/{date:%Y}/{date:%b}/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;DISPLAY_ARCHIVE_ON_SIDEBAR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To enable &lt;a href="https://applause-button.com/"&gt;applause button&lt;/a&gt; into bootstrap3 theme for articles, some simple tweaks are needed.
In the bootstrap3 file &lt;code&gt;article.html&lt;/code&gt;, add the last 2 lines below.
(Located at /home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/themes/pelican-bootstrap3/templates)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;block&lt;/span&gt; &lt;span class="nv"&gt;meta&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;article.author&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;author&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;article.author&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;author&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;AUTHOR&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;article.tags&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;keywords&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;article.tags&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;join&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;)|&lt;/span&gt;&lt;span class="nf"&gt;striptags&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nv"&gt;article.summary&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;meta&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;description&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;article.summary&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;striptags&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nf"&gt;escape&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
     &lt;span class="c"&gt;&amp;lt;!-- MM: add the button style &amp;amp; script --&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;link&lt;/span&gt; &lt;span class="na"&gt;rel=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://unpkg.com/applause-button/dist/applause-button.css&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;script&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://unpkg.com/applause-button/dist/applause-button.js&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endblock&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then, to show it at the end of the article, add the &lt;code&gt;&amp;lt;applause-button&amp;gt;&lt;/code&gt;-tag in &lt;code&gt;article.html&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;            {% include &amp;#39;includes/show_source.html&amp;#39; %}
            &lt;span class="c"&gt;&amp;lt;!-- MM: add the button! --&amp;gt;&lt;/span&gt;
            &lt;span class="nt"&gt;&amp;lt;applause-button&lt;/span&gt; &lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;width: 58px; height: 58px;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;&amp;lt;/article&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Technologies"></category><category term="Pelican"></category></entry><entry><title>Using udev</title><link href="https://wlog.viltstigen.se/articles/2020/02/22/using-udev/" rel="alternate"></link><published>2020-02-22T00:00:00+01:00</published><updated>2020-06-18T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-02-22:/articles/2020/02/22/using-udev/</id><summary type="html">&lt;p&gt;A note on Linux device manager&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;udev&lt;/strong&gt;, for &lt;strong&gt;user&lt;/strong&gt; space &lt;strong&gt;/dev&lt;/strong&gt;, is a device manager for Linux. It manages all nodes in the &lt;strong&gt;/dev&lt;/strong&gt; directory as
well as managing events when devices are added or removed.&lt;/p&gt;
&lt;p&gt;For my purposes, I want to control consistent and permanent naming for specific USB devices I add to a raspberry.&lt;/p&gt;
&lt;h2&gt;udev&lt;/h2&gt;
&lt;p&gt;To have a permanent name in the &lt;strong&gt;/dev&lt;/strong&gt; directory, such as &lt;strong&gt;/dev/ttyEMC&lt;/strong&gt;, rather than &lt;strong&gt;/dev/ttyUSB0&lt;/strong&gt; which may vary 
over time to &lt;strong&gt;/dev/ttyUSB1&lt;/strong&gt;, a &lt;strong&gt;udev rules&lt;/strong&gt; file is available and soft linked to the &lt;code&gt;/etc/udev/rules.d&lt;/code&gt; directory&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ sudo ln -s /home/pi/app/EMC/py/10-EMC.rules /etc/udev/rules.d/10-EMC.rules
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The syntax in the file follows the description at &lt;a href="https://wiki.archlinux.org/index.php/Udev"&gt;https://wiki.archlinux.org/index.php/Udev&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Some handy commands are below to find out the values to the rules parameters.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$ udevadm info -a -n /dev/ttyUSB0
$ udevadm info -a -p &lt;span class="k"&gt;$(&lt;/span&gt;udevadm info -q path -n /dev/ttyUSB0&lt;span class="k"&gt;)&lt;/span&gt;
$ sudo udevadm &lt;span class="nb"&gt;test&lt;/span&gt; &lt;span class="k"&gt;$(&lt;/span&gt;udevadm info -q path -n /dev/ttyUSB0&lt;span class="k"&gt;)&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The last command will test and trigger the new rule, thus creating &lt;code&gt;/dev/ttyEMC&lt;/code&gt;.
See &lt;a href="http://www.reactivated.net/writing_udev_rules.html"&gt;http://www.reactivated.net/writing_udev_rules.html&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;Additional udev&lt;/h1&gt;
&lt;p&gt;By &lt;a href="http://ubuntuforums.org/showthread.php?t=901891"&gt;http://ubuntuforums.org/showthread.php?t=901891&lt;/a&gt;, see end of thread&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Here&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;an&lt;/span&gt; &lt;span class="n"&gt;explanation&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;how&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;hotplug&lt;/span&gt; &lt;span class="n"&gt;works&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="o"&gt;========================================&lt;/span&gt;
&lt;span class="n"&gt;Linux&lt;/span&gt; &lt;span class="n"&gt;specific&lt;/span&gt; &lt;span class="n"&gt;installation&lt;/span&gt; &lt;span class="n"&gt;information&lt;/span&gt;
&lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;Linus&lt;/span&gt; &lt;span class="n"&gt;Walleij&lt;/span&gt;
&lt;span class="n"&gt;covering&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt; &lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="o"&gt;========================================&lt;/span&gt;

&lt;span class="n"&gt;Since&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;accessing&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;raw&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="n"&gt;exported&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;identify&lt;/span&gt; &lt;span class="n"&gt;connected&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;busses&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;functions&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;such&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;needs&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;find&lt;/span&gt; &lt;span class="n"&gt;these&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;During&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;history&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;Linux&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;placement&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;way&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;accessing&lt;/span&gt; &lt;span class="n"&gt;these&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt; &lt;span class="n"&gt;changed&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;placement&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;closely&lt;/span&gt; &lt;span class="n"&gt;related&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;hotplugging&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;addition&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;removal&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;functions&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;runtime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;


&lt;span class="c1"&gt;## Most current solution: use udev&lt;/span&gt;


&lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;latest&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;greatest&lt;/span&gt; &lt;span class="n"&gt;way&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;managing&lt;/span&gt; &lt;span class="n"&gt;hotplugged&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;cold&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;plugged&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;under&lt;/span&gt; &lt;span class="n"&gt;Linux&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;called&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;udev&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;development&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;older&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hotplug&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;see&lt;/span&gt; &lt;span class="n"&gt;below&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;When&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;connected&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;program&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;hirerarchy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;It&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;also&lt;/span&gt; &lt;span class="n"&gt;remove&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;hierarchy&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;they&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;unplugged&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Traditionally&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;plugged&lt;/span&gt; &lt;span class="n"&gt;into&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;Linux&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;expected&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;have&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;one&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fly&lt;/span&gt; &lt;span class="n"&gt;when&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;connected&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Libusb&lt;/span&gt; &lt;span class="n"&gt;cannot&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;these&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;drivers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;instead&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;attempts&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;raw&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt; &lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;find&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;needs&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;locate&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt; &lt;span class="n"&gt;filesystem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;recommended&lt;/span&gt; &lt;span class="n"&gt;way&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;let&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt; &lt;span class="n"&gt;filesystem&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;add&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="n"&gt;like&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;into&lt;/span&gt; &lt;span class="n"&gt;some&lt;/span&gt; &lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;inside&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rules&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="c1"&gt;# usbfs-like devices&lt;/span&gt;
&lt;span class="n"&gt;SUBSYSTEM&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;usb_device&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PROGRAM&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/bin/sh -c &amp;#39;K=%k; K=$${K#usbdev}; \ printf bus/usb/&lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;03i/&lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;03i $${K&lt;/span&gt;&lt;span class="si"&gt;%%%%&lt;/span&gt;&lt;span class="s2"&gt;.*} $${K#*.}&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \ &lt;span class="n"&gt;NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%c&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;layout&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;used&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;Debian&lt;/span&gt; &lt;span class="n"&gt;distribution&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;Fedora&lt;/span&gt; &lt;span class="n"&gt;Core&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="n"&gt;creates&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;tree&lt;/span&gt; &lt;span class="n"&gt;identical&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;earlier&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;tree&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;but&lt;/span&gt; &lt;span class="n"&gt;under&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;instead&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;If&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;tree&lt;/span&gt; &lt;span class="n"&gt;exists&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;It&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;look&lt;/span&gt; &lt;span class="n"&gt;like&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;
&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;
   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;
     &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;001&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;001&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;002&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;003&lt;/span&gt;
    &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;002&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;001&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;002&lt;/span&gt;
       &lt;span class="o"&gt;...&lt;/span&gt;

&lt;span class="n"&gt;However&lt;/span&gt; &lt;span class="n"&gt;notice&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;
&lt;span class="n"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;often&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;means&lt;/span&gt; &lt;span class="n"&gt;they&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;only&lt;/span&gt; &lt;span class="n"&gt;accessible&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;writing&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;whereas&lt;/span&gt; &lt;span class="n"&gt;non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="n"&gt;often&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;only&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;way&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;controlling&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;differs&lt;/span&gt; &lt;span class="n"&gt;between&lt;/span&gt; &lt;span class="n"&gt;systems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;but&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;typical&lt;/span&gt; &lt;span class="n"&gt;way&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;complementing&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;apropriate&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pluggable&lt;/span&gt; &lt;span class="n"&gt;Authentication&lt;/span&gt; &lt;span class="n"&gt;Modules&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;some&lt;/span&gt; &lt;span class="n"&gt;sort&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;configuration&lt;/span&gt; &lt;span class="n"&gt;under&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;security&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;For&lt;/span&gt; &lt;span class="n"&gt;details&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;see&lt;/span&gt; &lt;span class="n"&gt;below&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;also&lt;/span&gt; &lt;span class="n"&gt;different&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;old&lt;/span&gt; &lt;span class="n"&gt;usbfs&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;enables&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;ACL&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Access&lt;/span&gt; &lt;span class="n"&gt;Control&lt;/span&gt;
&lt;span class="n"&gt;Lists&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;control&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;ACL&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="n"&gt;could&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;used&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt; &lt;span class="n"&gt;filesystem&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="n"&gt;less&lt;/span&gt; &lt;span class="n"&gt;good&lt;/span&gt; &lt;span class="n"&gt;alternative&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;may&lt;/span&gt; &lt;span class="n"&gt;however&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;useful&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;debugging&lt;/span&gt; &lt;span class="n"&gt;would&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;supply&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;argument&lt;/span&gt; &lt;span class="n"&gt;MODE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;666&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;above&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;slightly&lt;/span&gt; &lt;span class="n"&gt;better&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;tag&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;MODE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;660&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GROUP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;where&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;desktop&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;If&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt; &lt;span class="n"&gt;cannot&lt;/span&gt; &lt;span class="n"&gt;find&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;hierarchy&lt;/span&gt; &lt;span class="n"&gt;below&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;case&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;above&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;fall&lt;/span&gt; &lt;span class="n"&gt;back&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;instead&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Additionally&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;may&lt;/span&gt; &lt;span class="n"&gt;want&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;trigger&lt;/span&gt; &lt;span class="n"&gt;unique&lt;/span&gt; &lt;span class="n"&gt;actions&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;same&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;To&lt;/span&gt; &lt;span class="n"&gt;do&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rules&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;these&lt;/span&gt; &lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;SUBSYSTEM&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;usb_device&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ACTION&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;add&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SYSFS&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;idVendor&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1234&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \ &lt;span class="n"&gt;SYSFS&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;idProduct&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;4321&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;At&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt; &lt;span class="n"&gt;tag&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;any&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;specific&lt;/span&gt; &lt;span class="n"&gt;actions&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="mi"&gt;1234&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;4321&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;MODE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;660&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;GROUP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;baz&amp;quot;&lt;/span&gt;   &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt;
&lt;span class="n"&gt;RUN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/local/bin/baz&amp;quot;&lt;/span&gt;  &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;plug&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;
&lt;span class="n"&gt;SYMLINK&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;foo&amp;quot;&lt;/span&gt;            &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;symlink&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt;
                         &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;

&lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="n"&gt;more&lt;/span&gt; &lt;span class="n"&gt;about&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;its&lt;/span&gt; &lt;span class="n"&gt;own&lt;/span&gt; &lt;span class="n"&gt;documentation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;


&lt;span class="n"&gt;Permissions&lt;/span&gt; &lt;span class="n"&gt;setting&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt;
&lt;span class="o"&gt;============================&lt;/span&gt;

&lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="n"&gt;addition&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;rule&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;creating&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;want&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unless&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;defaults&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;something&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;globally&lt;/span&gt; &lt;span class="n"&gt;writeable&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;readable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Making&lt;/span&gt; &lt;span class="n"&gt;anything&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;plugged&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;bus&lt;/span&gt; &lt;span class="n"&gt;writeable&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;readable&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;ALL&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;typically&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;bad&lt;/span&gt; &lt;span class="n"&gt;idea&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;because&lt;/span&gt; &lt;span class="n"&gt;what&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;typically&lt;/span&gt; &lt;span class="n"&gt;want&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;do&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;make&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;writeable&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;readable&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;person&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;happens&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;sit&lt;/span&gt; &lt;span class="n"&gt;behind&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;screen&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;keyboard&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;very&lt;/span&gt; &lt;span class="n"&gt;computer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Managing&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;groups&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;bit&lt;/span&gt; &lt;span class="n"&gt;kludgy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;means&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;add&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;may&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;also&lt;/span&gt; &lt;span class="n"&gt;mean&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;one&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;member&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="n"&gt;could&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;plugging&lt;/span&gt; &lt;span class="n"&gt;his&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;keydrive&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;another&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;same&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;logged&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;remotely&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;making&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt; &lt;span class="n"&gt;copy&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;same&lt;/span&gt; &lt;span class="n"&gt;keydrive&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;same&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Since&lt;/span&gt; &lt;span class="n"&gt;Linux&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;used&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt; &lt;span class="n"&gt;multi&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;has&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;solved&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;give&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;hotplugged&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;only&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Fedora&lt;/span&gt; &lt;span class="n"&gt;Core&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;later&lt;/span&gt; &lt;span class="n"&gt;does&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Whenever&lt;/span&gt; &lt;span class="n"&gt;something&lt;/span&gt; &lt;span class="n"&gt;happens&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;called&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;modify&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;anything&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;appeared&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;accordance&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;security&lt;/span&gt; &lt;span class="n"&gt;rules&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;trick&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;symbolic&lt;/span&gt; &lt;span class="n"&gt;link&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt; &lt;span class="n"&gt;let&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt; &lt;span class="k"&gt;match&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;link&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;For&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rules&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="n"&gt;SUBSYSTEM&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;usb_device&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ACTION&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;add&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SYSFS&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;idVendor&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1234&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \ &lt;span class="n"&gt;SYSFS&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;idProduct&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;4321&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SYMLINK&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;foo-%k&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;symlink&lt;/span&gt; &lt;span class="n"&gt;named&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/dev/foo-nn&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt; &lt;span class="n"&gt;nn&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;some&lt;/span&gt; &lt;span class="n"&gt;unique&lt;/span&gt; &lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;each&lt;/span&gt; &lt;span class="n"&gt;added&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;matching&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;VID&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;PID&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt; &lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;rules&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;accordance&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;adding&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;security&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;perms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;perms&lt;/span&gt; &lt;span class="n"&gt;containing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=/&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;console&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0600&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0600&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;

&lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;instructs&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;give&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;console&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;write&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;symlink&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;whenever&lt;/span&gt; &lt;span class="n"&gt;it&lt;/span&gt; &lt;span class="n"&gt;appears&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;permission&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;symlink&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt; &lt;span class="n"&gt;fall&lt;/span&gt; &lt;span class="n"&gt;through&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;


&lt;span class="n"&gt;Previous&lt;/span&gt; &lt;span class="n"&gt;solution&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;hotplug&lt;/span&gt;
&lt;span class="o"&gt;==============================&lt;/span&gt;

&lt;span class="n"&gt;Before&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;another&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;generally&lt;/span&gt; &lt;span class="n"&gt;considered&lt;/span&gt; &lt;span class="n"&gt;less&lt;/span&gt; &lt;span class="n"&gt;elegant&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;known&lt;/span&gt; &lt;span class="n"&gt;simply&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hotplug&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;was&lt;/span&gt; &lt;span class="n"&gt;used&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;In&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;case&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;program&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hotplug&lt;/span&gt; &lt;span class="n"&gt;would&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;called&lt;/span&gt; &lt;span class="n"&gt;whenever&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;were&lt;/span&gt; &lt;span class="n"&gt;connected&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;removed&lt;/span&gt; &lt;span class="n"&gt;from&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;corresponding&lt;/span&gt; &lt;span class="n"&gt;configuration&lt;/span&gt; &lt;span class="n"&gt;lives&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hotplug&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;

&lt;span class="n"&gt;With&lt;/span&gt; &lt;span class="n"&gt;hotplug&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;same&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;accessed&lt;/span&gt; &lt;span class="n"&gt;using&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;usbfs&lt;/span&gt; &lt;span class="n"&gt;hierarchy&lt;/span&gt; &lt;span class="n"&gt;below&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt; &lt;span class="n"&gt;Again&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;thishttp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;mihd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;y7w20q&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;used&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;since&lt;/span&gt; &lt;span class="n"&gt;libusb&lt;/span&gt; &lt;span class="n"&gt;does&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;use&lt;/span&gt; &lt;span class="n"&gt;any&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;drivers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;hierarchy&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;look&lt;/span&gt; &lt;span class="n"&gt;like&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;
&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;
   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;
     &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;001&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;001&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;002&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;003&lt;/span&gt;
    &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;002&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;001&lt;/span&gt;
       &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;002&lt;/span&gt;
       &lt;span class="o"&gt;...&lt;/span&gt;

&lt;span class="n"&gt;When&lt;/span&gt; &lt;span class="n"&gt;USB&lt;/span&gt; &lt;span class="n"&gt;devices&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;plugged&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;their&lt;/span&gt; &lt;span class="n"&gt;corresponding&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;proc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bus&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;without&lt;/span&gt; &lt;span class="n"&gt;any&lt;/span&gt; &lt;span class="n"&gt;external&lt;/span&gt; &lt;span class="n"&gt;program&lt;/span&gt; &lt;span class="n"&gt;intervention&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;case&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;udev&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;However&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;correct&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt; &lt;span class="n"&gt;these&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;nodes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="n"&gt;requires&lt;/span&gt; &lt;span class="n"&gt;anything&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;than&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;you&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;supply&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hotplug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;that&lt;/span&gt; &lt;span class="n"&gt;detects&lt;/span&gt; &lt;span class="n"&gt;your&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="n"&gt;its&lt;/span&gt; &lt;span class="n"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hotplug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;foo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;usermap&lt;/span&gt;

&lt;span class="c1"&gt;# Foo device with VID=1234 and PID=4321&lt;/span&gt;
&lt;span class="n"&gt;bar&lt;/span&gt; &lt;span class="mh"&gt;0x0003&lt;/span&gt; &lt;span class="mh"&gt;0x1234&lt;/span&gt; &lt;span class="mh"&gt;0x4321&lt;/span&gt; &lt;span class="mh"&gt;0x0000&lt;/span&gt; &lt;span class="mh"&gt;0x0000&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt; &lt;span class="mh"&gt;0x00000000&lt;/span&gt;

&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;All&lt;/span&gt; &lt;span class="n"&gt;this&lt;/span&gt; &lt;span class="n"&gt;need&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;one&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;The&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;bar&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;points&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="n"&gt;placed&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;hotplug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bar&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;following&lt;/span&gt; &lt;span class="n"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

&lt;span class="c1"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;${ACTION}&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;add&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;${DEVICE}&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;then&lt;/span&gt; &lt;span class="n"&gt;chgrp&lt;/span&gt; &lt;span class="n"&gt;baz&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;${DEVICE}&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;chmod&lt;/span&gt; &lt;span class="mi"&gt;660&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;${DEVICE}&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;fi&lt;/span&gt;

&lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;let&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;baz&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;access&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;device&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;reading&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;writing&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="n"&gt;There&lt;/span&gt; &lt;span class="n"&gt;exist&lt;/span&gt; &lt;span class="n"&gt;solutions&lt;/span&gt; &lt;span class="n"&gt;similar&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;PAM&lt;/span&gt; &lt;span class="n"&gt;permission&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;hotplug&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;but&lt;/span&gt; &lt;span class="n"&gt;they&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;kind&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;hackish&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;You&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt; &lt;span class="n"&gt;read&lt;/span&gt; &lt;span class="n"&gt;more&lt;/span&gt; &lt;span class="n"&gt;about&lt;/span&gt; &lt;span class="n"&gt;hotplug&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;its&lt;/span&gt; &lt;span class="n"&gt;usermaps&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;hotplug&lt;/span&gt; &lt;span class="n"&gt;documentation&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Technologies"></category><category term="Linux"></category></entry><entry><title>Pelican applause button</title><link href="https://wlog.viltstigen.se/articles/2020/02/12/pelican-applause-button/" rel="alternate"></link><published>2020-02-12T00:00:00+01:00</published><updated>2020-02-12T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-02-12:/articles/2020/02/12/pelican-applause-button/</id><summary type="html">&lt;p class="first last"&gt;A note on using applause button&lt;/p&gt;
</summary><content type="html">&lt;p&gt;For blog entries, the &lt;a class="reference external" href="https://applause-button.com/"&gt;applause button&lt;/a&gt; have been enabled in &lt;strong&gt;pelicanconf.py&lt;/strong&gt; with
this row&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;APPLAUSE_BUTTON&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; True
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The number of claps is made persistent  by a cloud-based sever with a REST API, see the link above.
I don't expect a lot (read any) claps on the blog posts, but I still wanted to create a simple page with a table that
list blog post name and the number of claps. To do this the &lt;strong&gt;get-multiple&lt;/strong&gt; method is used in a simple Python script.&lt;/p&gt;
&lt;p&gt;The script walks a directory structure using &lt;strong&gt;os.walk&lt;/strong&gt;-function returning 3 parameters. If the second (&lt;strong&gt;dirs&lt;/strong&gt;)
parameter is empty we are in a &amp;quot;leaf&amp;quot;-directory and I take the value of the first parameter (&lt;strong&gt;root&lt;/strong&gt;) to construct
a JSON array used as an argument to &lt;strong&gt;get-multiple&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;get-multiple&lt;/strong&gt; has a restriction that maximum 100 URLs can be added to the JSON array. Hence, I need to cater for this.
Once I have this array, I use the &lt;strong&gt;requests&lt;/strong&gt; Python library to POST the array to
&lt;strong&gt;https://api.applause-button.com/get-multiple&lt;/strong&gt;, then I parse the result (if I get a status code that indicate success).&lt;/p&gt;
&lt;p&gt;At the end, I use &lt;a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/"&gt;Flask&lt;/a&gt; and a template to generate an HTML page
with the desired result. The &lt;strong&gt;Flask&lt;/strong&gt; application is using &lt;a class="reference external" href="https://gunicorn.org/"&gt;gunicorn&lt;/a&gt; listening on port 8098
at my local raspberry (&lt;strong&gt;rpi2&lt;/strong&gt;), hence UFW needs to be configured to have the port open.&lt;/p&gt;
&lt;p&gt;More details and source code &lt;a class="reference external" href="https://github.com/Wolfrax/claps"&gt;here&lt;/a&gt;&lt;/p&gt;
</content><category term="Technologies"></category><category term="Blog"></category><category term="Pelican"></category></entry><entry><title>Piwheels</title><link href="https://wlog.viltstigen.se/articles/2020/02/02/piwheels/" rel="alternate"></link><published>2020-02-02T00:00:00+01:00</published><updated>2020-07-07T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-02-02:/articles/2020/02/02/piwheels/</id><summary type="html">&lt;p class="first last"&gt;A note on piwheels&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The PyPi (Python Package Index) is the package repository for Python modules. &lt;strong&gt;pip install&lt;/strong&gt; scouts this repository
when installing modules. Some of the modules have been implemented in C, and thus require compilation for the specific
target installation. This takes time (and might fail).&lt;/p&gt;
&lt;p&gt;The general solution to this is Python wheels, which includes pre-build binaries for Windows, macOS and Linux
(32/64 bits). However, Arm is not included and Raspberry is build on Arm. Enter piwheels.&lt;/p&gt;
&lt;p&gt;This repository provides Arm platform wheels, ie pre-compiled binary Python packages. Suitable for Raspberry Pi.&lt;/p&gt;
&lt;p&gt;For Raspberry Pi running Raspbian Stretch, this is by default enabled for Pip. For older versions (e.g. Jessie) this
should be included in &lt;strong&gt;/etc/pip.conf&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;global&lt;span class="o"&gt;]&lt;/span&gt;
extra-index-url&lt;span class="o"&gt;=&lt;/span&gt;https://www.piwheels.org/simple
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For Raspbian &amp;gt;=Jessie: Upgrade pip to &amp;gt;=9.0.1 using &lt;strong&gt;sudo pip3 install pip --upgrade&lt;/strong&gt;.&lt;/p&gt;
</content><category term="Technologies"></category><category term="Python"></category></entry><entry><title>Python virtual environment</title><link href="https://wlog.viltstigen.se/articles/2020/02/02/python-virtual-environment/" rel="alternate"></link><published>2020-02-02T00:00:00+01:00</published><updated>2020-02-02T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-02-02:/articles/2020/02/02/python-virtual-environment/</id><summary type="html">&lt;p class="first last"&gt;A note on using Python virtual environments&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I use Python &lt;strong&gt;virtualenv&lt;/strong&gt;, &lt;strong&gt;virtualenvwrapper&lt;/strong&gt; and &lt;strong&gt;autoenv&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Installation&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get update
$ sudo apt-get install python-setuptools
$ sudo easy_install pip
$ sudo pip install virtualenv
$ sudo pip install virtualenvwrapper
$ sudo pip install autoenv
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;My virtualenv root is at &lt;strong&gt;~/.virtualenvs&lt;/strong&gt;, so update &lt;strong&gt;~/.bashrc&lt;/strong&gt; accordingly&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;WORKON_HOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$HOME&lt;/span&gt;/.virtualenvs
&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PROJECT_HOME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$HOME&lt;/span&gt;/app
&lt;span class="nb"&gt;source&lt;/span&gt; /usr/local/bin/virtualenvwrapper.sh
&lt;span class="nb"&gt;source&lt;/span&gt; /usr/local/bin/activate.sh
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then create an &lt;strong&gt;.env&lt;/strong&gt; file in the folder were the project root is located (for example &amp;quot;Traffic&amp;quot; is used below) with
this content &lt;strong&gt;&amp;quot;workon Traffic&amp;quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Do &lt;strong&gt;&amp;quot;$ mkvirtualenv Traffic&amp;quot;&lt;/strong&gt;. When changing directory (cd) into the folder were the &lt;strong&gt;.env&lt;/strong&gt;-file is located
&lt;strong&gt;autoenv&lt;/strong&gt; will automatically trigger the virtualenv.&lt;/p&gt;
&lt;p&gt;To use Python3, use this command &lt;strong&gt;&amp;quot;$ mkvirtualenv --python=/usr/bin/python3 Traffic&amp;quot;&lt;/strong&gt;. To find the path to Python3,
use &lt;strong&gt;&amp;quot;$ which python3&amp;quot;&amp;quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;If autoenv is not used, activate the virtualenv by &lt;strong&gt;&amp;quot;$ workon Traffic&amp;quot;&lt;/strong&gt;, deactivate by &lt;strong&gt;&amp;quot;$ deactivate&amp;quot;&lt;/strong&gt;.
After activating the virtualenv, install packages by (Traffic) &lt;strong&gt;&amp;quot;$ pip install requests&amp;quot;&lt;/strong&gt;
(for Python3 do &lt;strong&gt;&amp;quot;(Traffic) $ pip3 install requests&amp;quot;&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;Refer to documentation &lt;a class="reference external" href="https://virtualenvwrapper.readthedocs.io/en/latest/command_ref.html"&gt;here&lt;/a&gt;.&lt;/p&gt;
</content><category term="Technologies"></category><category term="Python"></category></entry><entry><title>Lenovo Touchpad problem</title><link href="https://wlog.viltstigen.se/articles/2020/02/01/lenovo-touchpad-problem/" rel="alternate"></link><published>2020-02-01T00:00:00+01:00</published><updated>2020-02-01T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-02-01:/articles/2020/02/01/lenovo-touchpad-problem/</id><summary type="html">&lt;p class="first last"&gt;A note on fixing Lenovo Thinkpad Touchpad problems in Linux&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Using a Lenovo Thinkpad T440 with Linux Mint (4.15.0-70-generic) I have a problem with 2-finger scrolling using the
touchpad. It stopped working after suspend/resume. This is a known problem affecting other models also.&lt;/p&gt;
&lt;p&gt;Manually this can be fixes as so&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo modprobe -r psmouse &lt;span class="c1"&gt;# Unload the psmouse driver&lt;/span&gt;
$ sudo modprobe psmouse &lt;span class="c1"&gt;# then reload it again&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To make this permanent update the with a kernel parameter. Edit &lt;strong&gt;/etc/default/grub&lt;/strong&gt;, change the following line, from&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;GRUB_CMDLINE_LINUX_DEFAULT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;quiet splash&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;GRUB_CMDLINE_LINUX_DEFAULT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;quiet splash psmouse.synaptics_intertouch=0&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then regenerate the &lt;strong&gt;grub.cfg&lt;/strong&gt; file by&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo grub-mkconfig -o /boot/grub/grub.cfg
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Problem should be fixed.&lt;/p&gt;
&lt;p&gt;You can try the kernel parameter before editing the &lt;strong&gt;grub&lt;/strong&gt; file by entering the &lt;strong&gt;grub&lt;/strong&gt; bootloader before booting the
kernel. Restart the computer and press repeatedly &lt;strong&gt;esc&lt;/strong&gt;-key during boot-up. Edit the line starting with &lt;strong&gt;linux&lt;/strong&gt; and
add &lt;strong&gt;psmouse.synaptics_intertouch=0&lt;/strong&gt; at the end. Press &lt;strong&gt;ctrl-x&lt;/strong&gt; to load the kernel with this parameter setting.
Of course, next time there is a restart the parameter setting is not there. Hence, to make it permanent edit the &lt;strong&gt;grub&lt;/strong&gt;
-file as above.&lt;/p&gt;
</content><category term="Technologies"></category><category term="Linux"></category><category term="Mint"></category><category term="Lenovo"></category></entry><entry><title>Map of Sweden #4</title><link href="https://wlog.viltstigen.se/articles/2020/02/01/map-of-sweden-4/" rel="alternate"></link><published>2020-02-01T00:00:00+01:00</published><updated>2020-02-01T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-02-01:/articles/2020/02/01/map-of-sweden-4/</id><summary type="html">&lt;p class="first last"&gt;A note on making maps #4&lt;/p&gt;
</summary><content type="html">&lt;p&gt;By previous posts, I have shown how to create a map of Sweden, get meteorological observations from SMHI and visualize
this on a map. What is lacking, is some decorations and interactions with the map.&lt;/p&gt;
&lt;p&gt;In this post I'll explain how to add a legend, show tool tip when hoovering the mouse above the map and some other
miscellaneous tasks.&lt;/p&gt;
&lt;div class="section" id="adding-a-legend"&gt;
&lt;h2&gt;Adding a legend&lt;/h2&gt;
&lt;p&gt;This is straightforward using a D3 library: &lt;strong&gt;d3-legend.js&lt;/strong&gt;. Use this by downloading in the html file such as:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://cdnjs.cloudflare.com/ajax/libs/d3-legend/1.1.0/d3-legend.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then I use the library like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;legendLinear&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;legend&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;shapeWidth&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cells&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;orient&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;vertical&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;call&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;legendLinear&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Above, I'm using an array variable colors (see &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/28/map-of-sweden-2/"&gt;part 3&lt;/a&gt; or below) to determine
how many legend cells that should be used. The orientation is vertical.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="map-with-legend"&gt;
&lt;h2&gt;Map with legend&lt;/h2&gt;
&lt;p&gt;The next thing I want to add is &lt;strong&gt;tooltip&lt;/strong&gt; that pops up when I move the mouse over the map. It should show the name of
the station and the value of the observation. To do this I will be using &lt;a class="reference external" href="https://getbootstrap.com/"&gt;bootstrap&lt;/a&gt;.
Bootstrap is used to build responsive web-pages, meaning that the web-page renders well on a variety of devices,
ie screen sizes. Included is support for tooltips. The javascript code looks like so&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;showTooltip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;element&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.dot&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;nr&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;element&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;popover&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="nx"&gt;placement&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;auto top&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#chart&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;trigger&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;manual&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;content&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;span style=&amp;#39;font-size: 12px; text-align: center;&amp;#39;&amp;gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
                &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;station&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
                &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;/span&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;element&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;popover&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;show&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;removeTooltip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.popover&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;each&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;voronoi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;voronoi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;enter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clip-path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;url(#swe-clip)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fill&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;M&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;L&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Z&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;style&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;stroke: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mouseover&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;showTooltip&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mouseout&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;removeTooltip&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;dots&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;enter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;circle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;class&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;dot&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;nr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fill&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cy&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;
        &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the &lt;strong&gt;&amp;lt;head&amp;gt;&lt;/strong&gt; section, include this to have access to bootstrap.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Some comments on the javascript for tooltip&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;The voronoi diagram (or mapping of Sweden) is extended with two events &lt;strong&gt;mouseover&lt;/strong&gt; and &lt;strong&gt;mouseout&lt;/strong&gt; where
&lt;strong&gt;showTooltip&lt;/strong&gt; and &lt;strong&gt;RemoveTooltip&lt;/strong&gt; are called respectively.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;strong&gt;showTooltip&lt;/strong&gt; first selects the element with the unique id &lt;strong&gt;&amp;quot;dotN&amp;quot;&lt;/strong&gt; (N = 1, 2, 3, ...)
then calls the &lt;strong&gt;popover&lt;/strong&gt; function with relevant parameter values.  The &lt;strong&gt;content&lt;/strong&gt; parameter generates HTML code
with the actual values for the station name and observation, through the &amp;quot;d&amp;quot; parameter.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;&lt;strong&gt;removeTooltip&lt;/strong&gt; removes the tooltip (obviously...) when the mouse is moved outside focus.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;The trick here is the unique &lt;strong&gt;&amp;quot;dotN&amp;quot;&lt;/strong&gt;. This is generated in the last part of the javascript code. To the &amp;quot;class&amp;quot;
attribute I generate the string &amp;quot;dot&amp;quot; and the add a number. Remember the javascript code for &amp;quot;get_values&amp;quot; as shown in
&lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/31/map-of-sweden-3/"&gt;part 3&lt;/a&gt; of these blog postings? It is shown below. In that code I generate a &amp;quot;nr&amp;quot; field in the resulting element.
Now I am using this to create the unique &lt;strong&gt;&amp;quot;dotN&amp;quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Ok, why?&lt;/p&gt;
&lt;p&gt;Well, we need it in the &lt;strong&gt;showToolTip&lt;/strong&gt; and it will position the tooltip popup at the right place in the map.
In the code, I actually draw a small circle at the [x, y] coordinates, which is the projected longitude/latitude
values of the station making the observation. However, I draw the circle with the same background color as the
voronoi cell so they are invisible. To show them as a back dot on the map, simply change return value of the fill
style-attribute to &amp;quot;black&amp;quot;. (The actual reason for drawing a circle for the metereological station invisble, is that
I later on want to dynamically - at user interaction - turn them on/off).
Here is the &lt;strong&gt;get_values&lt;/strong&gt; code as stated in &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/31/map-of-sweden-3/"&gt;part 3&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;get_values&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;lst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[];&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;max_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;min_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;active&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;// Transform coordinates according to the selected projection\&lt;/span&gt;
            &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;xy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;projection&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;lon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;lat&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="nx"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
                &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;xy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;xy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="nx"&gt;station&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;station&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;nr&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="nx"&gt;max_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;max_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;min_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;min_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;max&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;max_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;min&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;min_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The complete listing is &lt;a class="reference external" href="https://github.com/Wolfrax/clover/blob/master/index.html"&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="D3"></category><category term="Maps"></category></entry><entry><title>Map of Sweden #3</title><link href="https://wlog.viltstigen.se/articles/2020/01/31/map-of-sweden-3/" rel="alternate"></link><published>2020-01-31T00:00:00+01:00</published><updated>2020-02-01T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-31:/articles/2020/01/31/map-of-sweden-3/</id><summary type="html">&lt;p class="first last"&gt;A note on making maps #3&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Now its time to make use of the data collected from SMHI and visualize them on top of the map of Sweden.
As been shown in &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/28/map-of-sweden-2/"&gt;Map of Sweden #2&lt;/a&gt;, an HTTP client can retrieve data from a
server, this is done through &lt;a class="reference external" href="https://jquery.com/"&gt;jQuery&lt;/a&gt;. A simple snippet like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;get_clover_data&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/clover_data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;dataType&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;json&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;
    &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;series&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;weather&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;series&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If the ajax-call is successful, the JSON formatted data is copied into the variable weather. All observations are
included. To access, for example, the average temperature for the first station do &lt;strong&gt;weather['avg_temp'][0].val&lt;/strong&gt;.
As I only use one observation at a time for visualization, I extract the observation I want for visualization.
This is done like so&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;get_values&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;lst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[];&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;max_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;min_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;active&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;// Transform coordinates according to the selected projection&lt;/span&gt;
            &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;xy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;projection&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;lon&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;lat&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="nx"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
                &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;xy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;xy&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="nx"&gt;station&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;station&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;nr&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="nx"&gt;max_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;max_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;min_val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;min_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;stn&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;lst&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;max&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;max_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;min&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;min_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;weather&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Some comments&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Observations are accessed with the &amp;quot;key&amp;quot; (e.g. 'avg_temp') first, then a station (as a number) and finally the value as
in &lt;strong&gt;weather[key][stn].lon&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;There is a call to projection that transform the longitude and latitude values for the station. The projection were
discussed in &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/26/map-of-sweden-1/"&gt;Map of Sweden #1&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now we got a JSON-list with fields for the selected key after calling &lt;strong&gt;get_values&lt;/strong&gt;. It is time to visualize these on
top of the map of Sweden. We do this by calling the javascript function &lt;strong&gt;render_map&lt;/strong&gt;, below. But, first we got to fix
the file &amp;quot;swe.json&amp;quot;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ curl http://naciscdn.org/naturalearth/10m/cultural/ne_10m_admin_0_countries.zip -O
$ unzip ne_10m_admin_0_countries.zip
$ ogr2ogr -f GeoJSON -where &lt;span class="s2"&gt;&amp;quot;ADM0_A3 = &amp;#39;SWE&amp;#39;&amp;quot;&lt;/span&gt; subunits.json ne_10m_admin_0_countries.shp
$ topojson -o swe.json --properties -- subunits.json
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;600&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;svg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;select&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;svg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;width&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;height&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;projection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;geo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;mercator&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;center&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;14.6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;62.1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nx"&gt;width&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;geo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;projection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;projection&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;render_map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;quantize&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;domain&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;min&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;max&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;range&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#9e0142&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#d53e4f&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#f46d43&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#fdae61&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#fee08b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;#e6f598&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#abdda4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#66c2a5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#3288bd&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#5e4fa2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

    &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;swe.json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;se&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;voronoi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;geom&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;voronoi&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;})&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;

        &lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clip&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;topojson&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;feature&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;se&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;se&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subunits&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;features&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;enter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;defs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clipPath&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;swe-clip&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;voronoi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;voronoi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;enter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clip-path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;url(#swe-clip)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fill&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;})&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;M&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;L&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Z&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="p"&gt;})&lt;/span&gt;
                &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;style&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;stroke: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;point&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Above assumes that the variable weather is available. I do this by include a file through
&lt;strong&gt;&amp;lt;script src=&amp;quot;weather.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;/strong&gt; in the &lt;strong&gt;&amp;lt;head&amp;gt;&lt;/strong&gt;-section to keep it simple (in my real implementation the data
is accessed through a jQuery ajax-request, see &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/28/map-of-sweden-2/"&gt;Map of Sweden #2&lt;/a&gt;), see the
implementation of this blog posting at &lt;a class="reference external" href="https://github.com/Wolfrax/clover/tree/master/blog/Part%203"&gt;Github&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Running the javasript should produce this.&lt;/p&gt;
&lt;div class="align-center figure"&gt;
&lt;img alt="alternate text" src="https://wlog.viltstigen.se/img/Map_of_Sweden_part_3.png" style="width: 249px; height: 538px;" /&gt;
&lt;p class="caption"&gt;Average temp&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;How does this work?&lt;/p&gt;
&lt;p&gt;The contants and variables before &lt;strong&gt;render_map&lt;/strong&gt; was explained in &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/26/map-of-sweden-1/"&gt;Map of Sweden #1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In &lt;strong&gt;render_map&lt;/strong&gt; a &lt;strong&gt;color&lt;/strong&gt; D3-variable is defined; the domain of the variable is the &lt;strong&gt;min&lt;/strong&gt; and &lt;strong&gt;max&lt;/strong&gt; values of
the observation to render, the range is a color scale generated through
&lt;a class="reference external" href="http://colorbrewer2.org/#type=sequential&amp;amp;scheme=BuGn&amp;amp;n=3"&gt;colorbrewer&lt;/a&gt;.
In practice this means that a value of the observation is mapped to a specific color, in this case there are 10 colors
going from blue to red. (Colorbrewer generates a scale going from red to blue, but I want the lowest value to mapped
to blue and the highest to red, thus I reverse the array).&lt;/p&gt;
&lt;p&gt;Using the color for a specific value, I want to use an area centered around the station where the measurement have
been made. For this purpose I use a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Voronoi_diagram"&gt;voronoi diagram&lt;/a&gt;. In simple
terms, this type of diagram partition the map into areas where all pixels are closest to the station point
(closest Euclidian distance). D3 makes this possible by the &lt;strong&gt;voronoi-function&lt;/strong&gt;. I do this by declaring the
voronoi-variable. However, to have this working, I need to clip all voronoi areas to stay within the map of Sweden.
This is made by defining a &lt;strong&gt;&amp;quot;clipPath&amp;quot;&lt;/strong&gt; with id &lt;strong&gt;swe-clip&lt;/strong&gt;, which is referenced later on using &lt;strong&gt;url(#swe-clip)&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;In summary, the logic of the render_map function is&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Define the color mapping in the variable color&lt;/li&gt;
&lt;li&gt;Read the file swe.json (which contain, in topoJSON format, the geometry for Sweden in the highest adminstrative level from Natural Earth)&lt;/li&gt;
&lt;li&gt;Define the voronoi variable&lt;/li&gt;
&lt;li&gt;Generate a SVG clipPath with id swe-clip&lt;/li&gt;
&lt;li&gt;Draw the map of Sweden using a voronoi diagram, filling each area with a color that is mapped through the variable color.
Each area is clipped according to the swe-clip definition. The last style-attribute, removes the visible borders of
the voronoi areas by drawning them in the same color as the area was filled with.&lt;/li&gt;
&lt;/ol&gt;
</content><category term="Technologies"></category><category term="D3"></category><category term="Maps"></category></entry><entry><title>Map of Sweden #2</title><link href="https://wlog.viltstigen.se/articles/2020/01/28/map-of-sweden-2/" rel="alternate"></link><published>2020-01-28T00:00:00+01:00</published><updated>2020-01-28T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-28:/articles/2020/01/28/map-of-sweden-2/</id><summary type="html">&lt;p class="first last"&gt;A note on making maps #2&lt;/p&gt;
</summary><content type="html">&lt;p&gt;In a previous post, I showed how to make a map of Sweden as a SVG object, derived from geometrical information,
using D3. Here, I will focus of collecting meteorological observations from &lt;a class="reference external" href="https://opendata.smhi.se/apidocs/metobs/index.html"&gt;SMHI&lt;/a&gt;
and create a simple HTTP-server that will respond with the data when requested. This will be made through 2 simple
python scripts.&lt;/p&gt;
&lt;div class="section" id="the-scripts"&gt;
&lt;h2&gt;The scripts&lt;/h2&gt;
&lt;p&gt;There are two python 3.x scripts doing the work&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;collector.py:&lt;/strong&gt; This script will traverse the SMHI REST API and store the data in JSON format in a file.
I have automated this script running once per day through crontab.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;emitter.py:&lt;/strong&gt; This script is implemented as a HTTP-server, running as a background daemon. When it receives a
GET-request, it will read the JSON file, created by collector.py and respond to the client.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I am using tools to have the workings of &lt;strong&gt;emitter.py&lt;/strong&gt;; &lt;a class="reference external" href="http://flask.pocoo.org/"&gt;Flask&lt;/a&gt;,
&lt;a class="reference external" href="https://gunicorn.org/"&gt;Gunicorn&lt;/a&gt; and &lt;a class="reference external" href="http://supervisord.org/introduction.html"&gt;Supervisor&lt;/a&gt;.
They will be described below, but first I will start with installing them into a Python virtual environment.
In &lt;strong&gt;collector.py&lt;/strong&gt; I will use requests library to access the SMHI observations, this library needs to be installed as well.&lt;/p&gt;
&lt;div class="section" id="installation"&gt;
&lt;h3&gt;Installation&lt;/h3&gt;
&lt;p&gt;Assuming a &amp;quot;clean&amp;quot; raspberry pi in target (in my case named &lt;strong&gt;rpi2&lt;/strong&gt;) do as below.
This will install &lt;strong&gt;pip&lt;/strong&gt;, &lt;strong&gt;virtualenv&lt;/strong&gt;, &lt;strong&gt;virtualenwrapper&lt;/strong&gt;, &lt;strong&gt;autoenv&lt;/strong&gt; and &lt;strong&gt;supervisor&lt;/strong&gt; systemwide.
Following that I create the virtual environment clover using python3. &lt;strong&gt;requests&lt;/strong&gt;, &lt;strong&gt;flask&lt;/strong&gt; and &lt;strong&gt;gunicorn&lt;/strong&gt; are
installed into the virtual environment, thus not system wide.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get update
$ sudo apt-get install python-setuptools
$ sudo easy_install pip
$ sudo pip install virtualenv
$ sudo pip install virtualenvwrapper
$ sudo pip install autoenv
$ sudo apt-get install supervisor
$ mkvirtualenv --python&lt;span class="o"&gt;=&lt;/span&gt;/usr/bin/python3 clover
$ workon clover
&lt;span class="o"&gt;(&lt;/span&gt;clover&lt;span class="o"&gt;)&lt;/span&gt; $ pip3 install requests
&lt;span class="o"&gt;(&lt;/span&gt;clover&lt;span class="o"&gt;)&lt;/span&gt; $ pip3 install flask
&lt;span class="o"&gt;(&lt;/span&gt;clover&lt;span class="o"&gt;)&lt;/span&gt; $ pip3 install gunicorn
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now everything should be installed.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="smhi-meteorological-observations"&gt;
&lt;h2&gt;SMHI meteorological observations&lt;/h2&gt;
&lt;p&gt;Time to find out how we access the meteorological observations.
This is how it is described by SMHI&lt;/p&gt;
&lt;blockquote&gt;
The service is constructed as a REST API for easy access. The Entry point is located at
&lt;a class="reference external" href="https://opendata-download-metobs.smhi.se/api"&gt;https://opendata-download-metobs.smhi.se/api&lt;/a&gt;. From here a client can traverse down by following links through
the levels until a specific data resource is available.&lt;/blockquote&gt;
&lt;p&gt;The &lt;strong&gt;collector.py&lt;/strong&gt; script use &lt;a class="reference external" href="http://opendata-download-metobs.smhi.se/api.json"&gt;http://opendata-download-metobs.smhi.se/api.json&lt;/a&gt; as the starting point to access
observations. SMHI expose data in 3 different formats: 1) JSON 2) XML 3) CSV, I will only care about JSON.&lt;/p&gt;
&lt;p&gt;There is a multitude of observations that can be accessed, for my purpose a subset of these will do:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;Temp:&lt;/strong&gt; Momentary value of air temperature, updated once per hour&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Average temp:&lt;/strong&gt; Average air temperature for 1 day (24 h), at 00:00&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Rain:&lt;/strong&gt; Sum once per day, at 06:00&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Relative humidity:&lt;/strong&gt; Momentary value, once per hour&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Snow depth:&lt;/strong&gt; Momentary value, once per hour&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Air pressure:&lt;/strong&gt; At sea level, momentary value, once per hour&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Lowest cloud layer:&lt;/strong&gt; Momentary value, once per hour&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I also collect &lt;strong&gt;Wind Direction&lt;/strong&gt; and &lt;strong&gt;Wind Speed&lt;/strong&gt; (average values over 10 min, once per hour) but these values are not used.&lt;/p&gt;
&lt;p&gt;A Jupyter notebook is available &lt;a class="reference external" href="https://github.com/Wolfrax/clover/tree/master/blog/Part%202"&gt;here&lt;/a&gt; to show a
simple interaction.&lt;/p&gt;
&lt;p&gt;For each data set, there are some meta-data available, such as:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;Latitude and Longitude&lt;/strong&gt; for each station&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Name&lt;/strong&gt; of station&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Active&lt;/strong&gt;, some stations might be inactive&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Update&lt;/strong&gt;, when the data was updated&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All of above is collected together with the value of the observation into a structure by the collector script.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note this&lt;/strong&gt; The stations will be different for each observation, e.g. the number of stations where rain observations
are available is larger than the number of stations for the air pressure observations. Therefore, we need to traverse
the API once per requested observation. To make the collector script somewhat more efficient it creates thread for
each observation so that the procedure is parallelized.&lt;/p&gt;
&lt;p&gt;The final result is stored in the file &lt;strong&gt;weather.js&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;strong&gt;collector.py&lt;/strong&gt; script is executed once per day using crontab. The entry in crontab is&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;    * * *   pi      /usr/bin/python3 /home/pi/app/clover/py/collector.py &amp;gt;&amp;gt; /var/log/clover.log &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that the script is executed as user &amp;quot;pi&amp;quot; and that any printout from the script is collected into
&lt;tt class="docutils literal"&gt;/var/log/clover.log&lt;/tt&gt;. Ensure that the &lt;strong&gt;collector.py&lt;/strong&gt; script have execution attribute set, that the
&lt;strong&gt;clover.log&lt;/strong&gt; file exist in &lt;strong&gt;/var/log&lt;/strong&gt; and is possible to write into. Use &lt;strong&gt;chmod&lt;/strong&gt; and &lt;strong&gt;chown&lt;/strong&gt; commands to do this.&lt;/p&gt;
&lt;p&gt;The collector.py is short, not very complicated and available &lt;a class="reference external" href="https://github.com/Wolfrax/clover/blob/master/py/collector.py"&gt;here&lt;/a&gt; on GitHub.
The net result is a file, &lt;strong&gt;weather.js&lt;/strong&gt;, in JSON format. The file name is hardcoded in the script as
&lt;strong&gt;../data/weather.js&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The beginning of the file looks like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;date&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;2019-03-07&amp;quot;&lt;/span&gt;,
    &lt;span class="s2"&gt;&amp;quot;temp&amp;quot;&lt;/span&gt;: &lt;span class="o"&gt;[{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;station&amp;quot;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;Abisko&amp;quot;&lt;/span&gt;,
        &lt;span class="s2"&gt;&amp;quot;updated&amp;quot;&lt;/span&gt;: &lt;span class="m"&gt;1551985200000&lt;/span&gt;,
        &lt;span class="s2"&gt;&amp;quot;lon&amp;quot;&lt;/span&gt;: &lt;span class="m"&gt;18&lt;/span&gt;.816546,
        &lt;span class="s2"&gt;&amp;quot;lat&amp;quot;&lt;/span&gt;: &lt;span class="m"&gt;68&lt;/span&gt;.354122,
        &lt;span class="s2"&gt;&amp;quot;active&amp;quot;&lt;/span&gt;: true,
        &lt;span class="s2"&gt;&amp;quot;val&amp;quot;&lt;/span&gt;: -15.5
    &lt;span class="o"&gt;}&lt;/span&gt;, &lt;span class="o"&gt;{&lt;/span&gt;
...
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The full file includes all stations for key temp. Other keys in the file are&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;avg_temp&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;wind_dir&lt;/strong&gt; (not used)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;wind_speed&lt;/strong&gt; (not used)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;rain&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;rel_moisture&lt;/strong&gt; (humidity)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;snow_depth&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;pressure&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;lowest_cloud&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The javascript that is accessing the data must use the exact key names shown above.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="emitter"&gt;
&lt;h2&gt;Emitter&lt;/h2&gt;
&lt;p&gt;The last script to explain is &lt;strong&gt;emitter.py&lt;/strong&gt;. This script is really short, the purpose of the script is to listen on
for HTTP GET-requests on the URI &lt;strong&gt;/clover_data&lt;/strong&gt;, read the &lt;strong&gt;weather.js&lt;/strong&gt; file and return the content to the HTTP client.
It is doing this through &lt;strong&gt;Gunicorn&lt;/strong&gt; and &lt;strong&gt;Flask&lt;/strong&gt;. The rationale for doing it this way is my local infrastructure
of raspberries.&lt;/p&gt;
&lt;p&gt;My domain is &lt;a class="reference external" href="https://www.viltstigen.se"&gt;https://www.viltstigen.se&lt;/a&gt;, and I have one raspberry (&lt;strong&gt;rpi1&lt;/strong&gt;) as HTTP server listening on port 80 and 443.
The collector script is executing on another raspberry (&lt;strong&gt;rpi2&lt;/strong&gt;) upstream of &lt;strong&gt;rpi1&lt;/strong&gt;.
The way to implement this is to use &lt;a class="reference external" href="https://nginx.org/en/"&gt;nginx&lt;/a&gt; as HTTP and proxy server on both &lt;strong&gt;rpi1&lt;/strong&gt; and &lt;strong&gt;rpi2&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;I need to configure nginx on &lt;strong&gt;rpi1&lt;/strong&gt; to distribute requests to clover to &lt;strong&gt;rpi2&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/clover&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;try_files&lt;/span&gt; &lt;span class="nv"&gt;$uri&lt;/span&gt; &lt;span class="nv"&gt;$uri/&lt;/span&gt; &lt;span class="nv"&gt;$uri/index.html&lt;/span&gt; &lt;span class="nv"&gt;$uri.html&lt;/span&gt; &lt;span class="s"&gt;@clover&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;@clover&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# proxy_pass http://rpi2.local; Note, a static IP address makes nginx more robust in case rpi1 is not running&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://192.168.1.51&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_redirect&lt;/span&gt;     &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;Host&lt;/span&gt; &lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Real-IP&lt;/span&gt; &lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Forwarded-For&lt;/span&gt; &lt;span class="nv"&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Forwarded-Host&lt;/span&gt; &lt;span class="nv"&gt;$server_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_read_timeout&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/clover_data&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;try_files&lt;/span&gt; &lt;span class="nv"&gt;$uri&lt;/span&gt; &lt;span class="nv"&gt;$uri/&lt;/span&gt; &lt;span class="nv"&gt;$uri/index.html&lt;/span&gt; &lt;span class="nv"&gt;$uri.html&lt;/span&gt; &lt;span class="s"&gt;@clover_data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;@clover_data&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# proxy_pass http://rpi2.local; Note, a static IP address makes nginx more robust in case rpi1 is not running&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://192.168.1.51:8096&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_redirect&lt;/span&gt;     &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;Host&lt;/span&gt; &lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Real-IP&lt;/span&gt; &lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Forwarded-For&lt;/span&gt; &lt;span class="nv"&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Forwarded-Host&lt;/span&gt; &lt;span class="nv"&gt;$server_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_read_timeout&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When a HTTP client access the URI &lt;a class="reference external" href="https://www.viltstigen.se/clover"&gt;https://www.viltstigen.se/clover&lt;/a&gt;, &lt;strong&gt;rpi1&lt;/strong&gt; will pass this to &lt;strong&gt;rpi2&lt;/strong&gt;.
Similar, if a client access &lt;a class="reference external" href="https://www.viltstigen.se/clover_data"&gt;https://www.viltstigen.se/clover_data&lt;/a&gt;, &lt;strong&gt;rpi1&lt;/strong&gt; will pass the request upstream to &lt;strong&gt;rpi2&lt;/strong&gt; on
port 8096. As my raspberries is protected by the uncomplicated firewall (ufw), the ports on &lt;strong&gt;rpi2&lt;/strong&gt; needs to be configured
to allow the traffic through these commands&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;8096&lt;/span&gt;
$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;80&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now an external HTTP-client can access &lt;strong&gt;rpi2&lt;/strong&gt; through &lt;strong&gt;rpi1&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;On &lt;strong&gt;rpi2&lt;/strong&gt; a WSGI server is listening on port 8096 and executing a Flask application in the emitter script.
As the WSGI server is running as a daemon I use supervisor to control this. Supervisor is configured in the file
&lt;strong&gt;clover_gunicorn.conf&lt;/strong&gt; (softlinked from &lt;strong&gt;/etc/supervisor/conf.d&lt;/strong&gt; directory), the content looks like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;program:clover_gunicorn&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;command&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /home/pi/.virtualenvs/clover/bin/gunicorn -b :8096 --reload emitter:app
&lt;span class="nv"&gt;directory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /home/pi/app/clover/py
&lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; root
&lt;span class="nv"&gt;autostart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;autorestart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;startretries&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="nv"&gt;stdout_logfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /var/log/supervisor/clover_gunicorn.log
&lt;span class="nv"&gt;stderr_logfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /var/log/supervisor/clover_gunicorn.err
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This tells supervisor to execute gunicorn, bind it to port 8096 executing the Flask application &amp;quot;app&amp;quot; in module
&amp;quot;emitter&amp;quot;. It will automatically reload the Flask application if any changes are made.&lt;/p&gt;
&lt;p&gt;Finally, the core of the Flask application is (the actual script includes more error handling than shown below)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/clover_data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_data&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/var/local/clover_weather.js&amp;quot;&lt;/span&gt;  &lt;span class="c1"&gt;# Hardcoded filename&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;json_file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dumps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json_file&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Above tells us that the Flask application will respond to the URI &lt;strong&gt;/clover_data&lt;/strong&gt; by reading the file
&lt;strong&gt;/var/local/clover_weather.js&lt;/strong&gt; (which I have symlinked to the actual file weather.js) and returning the content as a
JSON formatted string. Flask is running in debug mode, in case I would like to use this debug mode,
I issue these commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;FLASK_APP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;emitter.py
$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;FLASK_DEBUG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
$ flask run --host&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0.0.0 --port&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;8096&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and access the URI &lt;a class="reference external" href="https://rpi2.local:8096/clover_data"&gt;https://rpi2.local:8096/clover_data&lt;/a&gt; from a web browser.&lt;/p&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="D3"></category><category term="Maps"></category></entry><entry><title>Map of Sweden #1</title><link href="https://wlog.viltstigen.se/articles/2020/01/26/map-of-sweden-1/" rel="alternate"></link><published>2020-01-26T00:00:00+01:00</published><updated>2020-03-01T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-26:/articles/2020/01/26/map-of-sweden-1/</id><summary type="html">&lt;p class="first last"&gt;A note on making maps #1&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This is a description on how to use &lt;a class="reference external" href="https://d3js.org/"&gt;D3&lt;/a&gt;, Data Driven Documents, to visualize and manipulate maps
objects.&lt;/p&gt;
&lt;p&gt;The end result is visible &lt;a class="reference external" href="https://www.viltstigen.se/clover/index.html"&gt;here&lt;/a&gt;.
The project is available on Github (&lt;a class="reference external" href="https://github.com/Wolfrax/clover"&gt;link&lt;/a&gt;).&lt;/p&gt;
&lt;div class="section" id="making-a-map-of-sweden"&gt;
&lt;h2&gt;Making a map of Sweden&lt;/h2&gt;
&lt;p&gt;First, we need to find some data describing the geometry we want. While there are several sources to choose from,
in this case I will be using &lt;a class="reference external" href="https://www.naturalearthdata.com/"&gt;Natural Earth&lt;/a&gt; that are providing a wealth of
datasets in different scales for free. As I'm interested in Sweden and some of its administrative subunits (countys)
for my project, only a selection of shapefiles is needed. Below I provide links to zip-archives for shapefiles in the
scale of 1:10 million.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-details"&gt;NE 1:10m admin 0 details&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_1_states_provinces.zip"&gt;NE 1:10m admin 1 state provinces&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_populated_places.zip"&gt;NE 1:10m populated places&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the first zip-archive link, according to Natural Earth it includes:&lt;/p&gt;
&lt;blockquote&gt;
Countries subdivided by non-contiguous units. Mainland metropolitan France separate from the island of Corsica.
These rarely correspond to actual administrative divisions but rather highlight geographical regions that are not
continuous but are part of the same country. (&lt;a class="reference external" href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-details/"&gt;Link&lt;/a&gt;)&lt;/blockquote&gt;
&lt;p&gt;For the second zip-archive link, Natural Earth says that we get:&lt;/p&gt;
&lt;blockquote&gt;
Internal, first-order administrative boundaries and polygons for all but a few tiny countries. (&lt;a class="reference external" href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-1-states-provinces/"&gt;Link&lt;/a&gt;)&lt;/blockquote&gt;
&lt;p&gt;The third link includes shape files city and town points:&lt;/p&gt;
&lt;blockquote&gt;
Point symbols with name attributes. Includes all admin-0 and many admin-1 capitals, major cities and towns,
plus a sampling of smaller towns in sparsely inhabited regions. (&lt;a class="reference external" href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-populated-places/"&gt;Link&lt;/a&gt;)&lt;/blockquote&gt;
&lt;p&gt;We now have shapefiles which includes the geometry we want to use as a subset. How do we go from here?
For the purpose of rendering using D3, we need to filter out the geometries I'm looking for, then transform the
geometries from the original format in a 2-step approach; first transform into &lt;a class="reference external" href="https://en.wikipedia.org/wiki/GeoJSON"&gt;GeoJSON&lt;/a&gt;
and then into &lt;a class="reference external" href="https://en.wikipedia.org/wiki/GeoJSON#TopoJSON"&gt;TopoJSON&lt;/a&gt;.
For this we need to use tools, the &lt;a class="reference external" href="https://gdal.org/programs/ogr2ogr.html"&gt;ogr2ogr&lt;/a&gt; tool and
&lt;a class="reference external" href="https://github.com/topojson/topojson/wiki"&gt;topjson&lt;/a&gt; respectively.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ogr2ogr&lt;/strong&gt; is part of &lt;a class="reference external" href="https://gdal.org/"&gt;GDAL&lt;/a&gt; and official binaries for download can be found
&lt;a class="reference external" href="http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For Mac, go this way&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ brew install gdal
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;On a raspberry pi, running raspbian, the following commands should work (I have not tried):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get update
$ sudo apt-get install gdal-bin
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;topojson&lt;/strong&gt; tool is installed (on Mac at least) by&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ npm install -g topojson@1
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(Install npm using this command: &lt;tt class="docutils literal"&gt;$ brew install node&lt;/tt&gt;)&lt;/p&gt;
&lt;p&gt;Unzip the shapefiles above, then try&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ogr2ogr -f GeoJSON -where &lt;span class="s2"&gt;&amp;quot;ADM0_A3 = &amp;#39;SWE&amp;#39;&amp;quot;&lt;/span&gt; subunits.json ne_10m_admin_1_states_provinces.shp
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should produce a new file subunits.json. The input parameters to ogr2ogr is straightforward:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;strong&gt;-f&lt;/strong&gt; GeoJSON says that the output file format should be GeoJSON, subunits.json is the name of the output file and
ne_10m_admin_1_states_provinces.shp is the input file.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;-where&lt;/strong&gt; is the filter parameter with a SQL-like syntax, the trick is here to know that we want to filter on the
condition that ADM0_A3 should be equal to SWE. ADM0 refers to Admin-0, the highest level administrative boundaries,
and A3 refers to &lt;a class="reference external" href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3"&gt;ISO 3166-1 alpha-3&lt;/a&gt; country codes.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now we can convert from GeoJSON to TopeJSON using topojson tool like so&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ topojson -o swe.json --properties -- subunits.json
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here we ask topojson to create output file swe.json and use subunits.json as input.
If everything is working correctly, we now have swe.json in topoJSON format that D3 can read and display, shown below.&lt;/p&gt;
&lt;div class="section" id="use-d3-to-draw-a-map"&gt;
&lt;h3&gt;Use D3 to draw a map&lt;/h3&gt;
&lt;p&gt;Let's start using D3, a javascript library to manipulate HTML documents using data.
We need to combine D3 with a simple HTML document, the skeleton for the HTML5 document is&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt; &lt;span class="na"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;en&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Map&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;//d3js.org/d3.v3.js&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;//d3js.org/topojson.v1.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we need to include some D3 javascript code between the &amp;lt;script&amp;gt; and &amp;lt;/script&amp;gt; tags. Like so,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;600&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;svg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;select&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;body&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;svg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;width&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;height&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;projection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;geo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;mercator&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;center&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mf"&gt;14.6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;62.1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;scale&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="nx"&gt;width&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;geo&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;projection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;projection&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nx"&gt;d3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;swe.json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;selectAll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;map&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;topojson&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;feature&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subunits&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;features&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;enter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;style&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fill: grey&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And that's it really, if we combine this together into a html file, e.g. swe.hmtl, and bring this up in a browser we
should see a map of Sweden.&lt;/p&gt;
&lt;p&gt;What is the javascript code doing?&lt;/p&gt;
&lt;p&gt;In the let &lt;tt class="docutils literal"&gt;svg = ...&lt;/tt&gt;, I use the D3 selection - selecting the &amp;lt;body&amp;gt;-tag in the HTML code and appending an
&amp;lt;svg&amp;gt;-tag with 2 attributes width and height. The projection variable is pointing to the d3 mercator function
(this is a &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Mercator_projection"&gt;standard cylindrical map projection&lt;/a&gt;).
To this I center the map on the geographical mid point of Sweden (lat 62.1, lon 14.6), scale the image with factor
1000 and translate all coordinates to the mid-values of width and height. Finally, I define the svg-path variable
using the projection.&lt;/p&gt;
&lt;p&gt;d3.json() function reads the json-formated file swe.json that we created before. Then we use the selectAll
function to add the tag &amp;lt;map&amp;gt; to svg for all data. The data is generated through the function call to topojson which
will return an array of datapoints to draw.&lt;/p&gt;
&lt;p&gt;There is plenty of sites explaining and describing D3, so I am sketchy here.&lt;/p&gt;
&lt;p&gt;Result visible here.&lt;/p&gt;
&lt;p&gt;We get something like this.&lt;/p&gt;
&lt;div class="align-center figure"&gt;
&lt;img alt="alternate text" src="https://wlog.viltstigen.se/img/sweden_with_places.png" style="width: 270px; height: 541px;" /&gt;
&lt;p class="caption"&gt;Map of Sweden&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="variations-of-the-map"&gt;
&lt;h3&gt;Variations of the map&lt;/h3&gt;
&lt;p&gt;We can do more, for example include places by doing this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ogr2ogr -f GeoJSON -where &lt;span class="s2"&gt;&amp;quot;ISO_A2 = &amp;#39;SE&amp;#39; AND SCALERANK &amp;lt;8&amp;quot;&lt;/span&gt; places.json ne_10m_populated_places.shp
$ topojson -o swe.json -- subunits.json places.json
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From the populated_places shape file (ne_10m_populated_places.shp) we have now filtered on Sweden using
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2"&gt;ISO 3166-1 alpha-2&lt;/a&gt; 2 letter code instead of the previous 3
letter code (the choice of letter codes seems to be somewhat arbitrary...) and the major cities by using SCALERANK
(see &lt;a class="reference external" href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-populated-places/"&gt;here&lt;/a&gt; on SCALERANKS).
Then we append this javascript code to draw the places:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;svg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;datum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;topojson&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;feature&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;places&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;class&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;place&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="D3"></category><category term="Maps"></category></entry><entry><title>Raspberry backup using dropbox</title><link href="https://wlog.viltstigen.se/articles/2020/01/25/raspberry-backup-using-dropbox/" rel="alternate"></link><published>2020-01-25T00:00:00+01:00</published><updated>2020-01-25T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-25:/articles/2020/01/25/raspberry-backup-using-dropbox/</id><summary type="html">&lt;p class="first last"&gt;A note on using using dropbox&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Follow the recipe &amp;lt;&lt;a class="reference external" href="https://www.raspberrypi.org/magpi/dropbox-raspberry-pi/"&gt;https://www.raspberrypi.org/magpi/dropbox-raspberry-pi/&lt;/a&gt;&amp;gt;
In Dropbox, create a new app (find the &amp;quot;...&amp;quot; in the right hand corner, selected Developer and Create App), choose
Dropbox API (not business), select specific folder or full usage (I choose specific folder) and an app name, in my
case WolfraxRPiBck (it has to be unique wihtin DropBox community). Click on &amp;quot;Generate access token&amp;quot; and copy the
resulting key.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone https://github.com/andreafabrizi/Dropbox-Uploader.git
$ &lt;span class="nb"&gt;cd&lt;/span&gt; Dropbox-Uploader/
$ chmod a+x ./dropbox_uploader.sh
$ ./dropbox_uploader.sh
 This is the first &lt;span class="nb"&gt;time&lt;/span&gt; you run this script, please follow the instructions:

 &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; Open the following URL &lt;span class="k"&gt;in&lt;/span&gt; your Browser, and log &lt;span class="k"&gt;in&lt;/span&gt; using your account: https://www.dropbox.com/developers/apps
 &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; Click on &lt;span class="s2"&gt;&amp;quot;Create App&amp;quot;&lt;/span&gt;, &lt;span class="k"&gt;then&lt;/span&gt; &lt;span class="k"&gt;select&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Dropbox API app&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; Now go on with the configuration, choosing the app permissions and access restrictions to your DropBox folder
 &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; Enter the &lt;span class="s2"&gt;&amp;quot;App Name&amp;quot;&lt;/span&gt; that you prefer &lt;span class="o"&gt;(&lt;/span&gt;e.g. MyUploader4177213067640&lt;span class="o"&gt;)&lt;/span&gt;

 Now, click on the &lt;span class="s2"&gt;&amp;quot;Create App&amp;quot;&lt;/span&gt; button.

 When your new App is successfully created, please click on the Generate button
 under the &lt;span class="s1"&gt;&amp;#39;Generated access token&amp;#39;&lt;/span&gt; section, &lt;span class="k"&gt;then&lt;/span&gt; copy and paste the new access token here:

 &lt;span class="c1"&gt;# Access token: QzVDx[...]&lt;/span&gt;

 &amp;gt; The access token is QzVDx&lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt; Looks ok? &lt;span class="o"&gt;[&lt;/span&gt;y/N&lt;span class="o"&gt;]&lt;/span&gt;: y
   The configuration has been saved.
 $ ./dropbox_uploader.sh info
Dropbox Uploader v1.0

 &amp;gt; Getting info...

Name:               Mats Melander
UID:                dbid:AAC...
Email:              mats.m...
Country:    SE

$ ./dropbox_uploader.sh upload README.md /
 &amp;gt; Uploading &lt;span class="s2"&gt;&amp;quot;/home/pi/app/Dropbox-Uploader/README.md&amp;quot;&lt;/span&gt; to &lt;span class="s2"&gt;&amp;quot;/README.md&amp;quot;&lt;/span&gt;...
&lt;span class="c1"&gt;######################################################################## 100.0%&lt;/span&gt;
DONE
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Edit the &lt;cite&gt;dropbox_uploader.sh&lt;/cite&gt; file and change &lt;cite&gt;SHOW_PROGRESSBAR = 0&lt;/cite&gt; to &lt;cite&gt;SHOW_PROGRESSBAR = 1&lt;/cite&gt;
The script is ready to be used.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;    * * &lt;span class="m"&gt;0&lt;/span&gt;   sh /home/pi/rpi1/app/RPiscripts/backup_dropbox.sh -f /home/pi/.dropbox_uploader &amp;gt;&amp;gt; /home/pi/backup_dropbox.log &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Once per week at 3:00pm upload to dropbox, the &lt;tt class="docutils literal"&gt;backup_dropbox.sh&lt;/tt&gt; is&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Daily upload to Dropbox of backup files&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Copy everything in the /home/pi/bck/ directory to Dropbox and make a listing&lt;/span&gt;
&lt;span class="c1"&gt;# This script is dependent on the backup.sh script&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-----&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Uploading to Dropbox of backup files&amp;quot;&lt;/span&gt;
date
&lt;span class="nb"&gt;echo&lt;/span&gt;

/home/pi/app/Dropbox-Uploader/dropbox_uploader.sh upload /home/pi/bck/* /RPi1_backup/
/home/pi/app/Dropbox-Uploader/dropbox_uploader.sh list /RPi1_backup/

&lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Upload finished finished&amp;quot;&lt;/span&gt;
date
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-----&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The file &lt;tt class="docutils literal"&gt;.dropbox_uploader&lt;/tt&gt; is one row with the access token for Dropbox.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;OAUTH_ACCESS_TOKEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;QzV&lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</content><category term="Technologies"></category><category term="Raspberry"></category><category term="Dropbox"></category></entry><entry><title>Raspberry backup using rclone</title><link href="https://wlog.viltstigen.se/articles/2020/01/18/raspberry-backup-using-rclone/" rel="alternate"></link><published>2020-01-18T00:00:00+01:00</published><updated>2020-01-29T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-18:/articles/2020/01/18/raspberry-backup-using-rclone/</id><summary type="html">&lt;p class="first last"&gt;A note on using rclone and Google drive&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Backing up raspberries using &lt;a class="reference external" href="https://rclone.org/drive/"&gt;rclone&lt;/a&gt; to Google drive.&lt;/p&gt;
&lt;div class="section" id="installation-of-rclone"&gt;
&lt;h2&gt;Installation of rclone&lt;/h2&gt;
&lt;p&gt;Installation on &lt;strong&gt;rpi1&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Please note the &lt;strong&gt;&amp;quot;INSTRUCTIONS Google Drive Example&amp;quot;&lt;/strong&gt; at the end of rclone installation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pi@rpi1:~ $ curl -L https://raw.github.com/pageauc/rclone4pi/master/rclone-install.sh &lt;span class="p"&gt;|&lt;/span&gt; bash
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;0&lt;/span&gt;    &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;0&lt;/span&gt;    &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; --:--:-- --:--:-- --:--:--     &lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="m"&gt;100&lt;/span&gt;  &lt;span class="m"&gt;2508&lt;/span&gt;  &lt;span class="m"&gt;100&lt;/span&gt;  &lt;span class="m"&gt;2508&lt;/span&gt;    &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;0&lt;/span&gt;   &lt;span class="m"&gt;2328&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;  &lt;span class="m"&gt;0&lt;/span&gt;:00:01  &lt;span class="m"&gt;0&lt;/span&gt;:00:01 --:--:--  136k
bash ver &lt;span class="m"&gt;1&lt;/span&gt;.6 written by Claude Pageau
-------------------------------------------------------------------------------
--2020-01-18 &lt;span class="m"&gt;13&lt;/span&gt;:20:27--  https://downloads.rclone.org/rclone-current-linux-arm.zip
Resolving downloads.rclone.org &lt;span class="o"&gt;(&lt;/span&gt;downloads.rclone.org&lt;span class="o"&gt;)&lt;/span&gt;... &lt;span class="m"&gt;5&lt;/span&gt;.153.250.7, 2a02:24e0:8:61f9::1
Connecting to downloads.rclone.org &lt;span class="o"&gt;(&lt;/span&gt;downloads.rclone.org&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.153.250.7&lt;span class="p"&gt;|&lt;/span&gt;:443... connected.
HTTP request sent, awaiting response... &lt;span class="m"&gt;200&lt;/span&gt; OK

...snip...

rclone installed at /usr/bin/rclone
-------------------------------------------------------------------------------
                 INSTRUCTIONS Google Drive Example

&lt;span class="m"&gt;1&lt;/span&gt; You will be required to have a login account on the remote storage service
  Open putty SSH login session to RPI and execute &lt;span class="nb"&gt;command&lt;/span&gt; below

  rclone config

  Follow rclone prompts. For more Details See
  https://github.com/pageauc/rclone4pi/wiki/Home
&lt;span class="m"&gt;2&lt;/span&gt; At name&amp;gt; prompt specify a reference name  eg gdmedia
&lt;span class="m"&gt;3&lt;/span&gt; At storage&amp;gt; prompt Enter a remote storage number from List
&lt;span class="m"&gt;4&lt;/span&gt; Select Auto Config, At Link: prompt, left click
  and highlight rclone url link &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt; not hit enter&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="m"&gt;5&lt;/span&gt; on computer web browser url bar right click paste and go.
&lt;span class="m"&gt;6&lt;/span&gt; On computer web browser security page, Confirm access.
&lt;span class="m"&gt;7&lt;/span&gt; Copy web browser access security token and paste
  into RPI SSH session rclone prompt. Enter to accept
&lt;span class="m"&gt;8&lt;/span&gt; To &lt;span class="nb"&gt;test&lt;/span&gt; remote service access. Execute the following where
  gdmedia is the name you gave your remote service

  rclone ls gdmedia:/

Example sync &lt;span class="nb"&gt;command&lt;/span&gt; make &lt;span class="nb"&gt;source&lt;/span&gt; identical to destination

rclone sync -v /home/pi/rpi-sync gdmedia:/rpi-sync

To upgrade

  &lt;span class="nb"&gt;cd&lt;/span&gt; rpi-sync
  ./rclone-install.sh upgrade

For more Details See https://github.com/pageauc/rclone4pi/wiki/Home
Bye
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="configuration-of-rclone"&gt;
&lt;h2&gt;Configuration of rclone&lt;/h2&gt;
&lt;p&gt;A Google drive item needs to be configured for rclone, below I first remove &lt;tt class="docutils literal"&gt;google_drive&lt;/tt&gt; (which where wrongly
configured at a previous session) and then recreate a new remote with the same name.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
A &lt;tt class="docutils literal"&gt;client id&lt;/tt&gt; and its associated &lt;tt class="docutils literal"&gt;client secret&lt;/tt&gt; needs to be generated at Google, follow these
&lt;a class="reference external" href="https://rclone.org/drive/#making-your-own-client-id"&gt;instructions&lt;/a&gt; to do this.&lt;/blockquote&gt;
&lt;p&gt;In my case, I needed to go to &lt;a class="reference external" href="https://console.developers.google.com/"&gt;Google APIs&lt;/a&gt;, make sure that my project
&lt;tt class="docutils literal"&gt;Viltstigen&lt;/tt&gt; where selected (it is by default). Then select &amp;quot;Credentials&amp;quot; to the left on the web page. A number of
previously generated &amp;quot;API keys&amp;quot; will be visible. I selected &amp;quot;API Key 7&amp;quot;, then selected the &amp;quot;Create Credentials&amp;quot; drop
down menu (blue), followed by &amp;quot;OAuth client ID&amp;quot;. New page, select option &amp;quot;Other&amp;quot;, type in a &amp;quot;Name&amp;quot; and click &amp;quot;Create&amp;quot;.
A pop-up screen appears with &amp;quot;client ID&amp;quot; and &amp;quot;client Secret&amp;quot; visible, keep them for the script below.&lt;/p&gt;
&lt;p&gt;Note also that I have choosen a &amp;quot;root_folder_id&amp;quot; below, following the instructions
&lt;a class="reference external" href="https://rclone.org/drive/#root-folder-id"&gt;here&lt;/a&gt;. Essentially, using the Google Drive web interface, create a new
folder (e.g. &amp;quot;rpi_bck&amp;quot;), then move into this folder and copy the last part of the URL.
The string &amp;quot;[...]&amp;quot;, below is inserted in fields where I donät want to expose any information.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pi@rpi1:~/bck $ rclone config
Current remotes:

Name                 &lt;span class="nv"&gt;Type&lt;/span&gt;
&lt;span class="o"&gt;====&lt;/span&gt;                 &lt;span class="o"&gt;====&lt;/span&gt;
google_drive         drive

e&lt;span class="o"&gt;)&lt;/span&gt; Edit existing remote
n&lt;span class="o"&gt;)&lt;/span&gt; New remote
d&lt;span class="o"&gt;)&lt;/span&gt; Delete remote
r&lt;span class="o"&gt;)&lt;/span&gt; Rename remote
c&lt;span class="o"&gt;)&lt;/span&gt; Copy remote
s&lt;span class="o"&gt;)&lt;/span&gt; Set configuration password
q&lt;span class="o"&gt;)&lt;/span&gt; Quit config
e/n/d/r/c/s/q&amp;gt; d
Choose a number from below, or &lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; an existing value
 &lt;span class="m"&gt;1&lt;/span&gt; &amp;gt; google_drive
remote&amp;gt; &lt;span class="m"&gt;1&lt;/span&gt;
No remotes found - make a new one
n&lt;span class="o"&gt;)&lt;/span&gt; New remote
s&lt;span class="o"&gt;)&lt;/span&gt; Set configuration password
q&lt;span class="o"&gt;)&lt;/span&gt; Quit config
n/s/q&amp;gt; n
name&amp;gt; google_drive
Type of storage to configure.
Enter a string value. Press Enter &lt;span class="k"&gt;for&lt;/span&gt; the default &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.
Choose a number from below, or &lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; your own value
 &lt;span class="m"&gt;1&lt;/span&gt; / 1Fichier
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fichier&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;2&lt;/span&gt; / Alias &lt;span class="k"&gt;for&lt;/span&gt; an existing remote
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;alias&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;3&lt;/span&gt; / Amazon Drive
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;amazon cloud drive&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;4&lt;/span&gt; / Amazon S3 Compliant Storage Provider &lt;span class="o"&gt;(&lt;/span&gt;AWS, Alibaba, Ceph, Digital Ocean, Dreamhost, IBM COS, Minio, etc&lt;span class="o"&gt;)&lt;/span&gt;
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;s3&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;5&lt;/span&gt; / Backblaze B2
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;b2&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;6&lt;/span&gt; / Box
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;box&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;7&lt;/span&gt; / Cache a remote
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cache&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;8&lt;/span&gt; / Citrix Sharefile
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sharefile&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;9&lt;/span&gt; / Dropbox
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;dropbox&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;10&lt;/span&gt; / Encrypt/Decrypt a remote
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;crypt&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;11&lt;/span&gt; / FTP Connection
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ftp&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;12&lt;/span&gt; / Google Cloud Storage &lt;span class="o"&gt;(&lt;/span&gt;this is not Google Drive&lt;span class="o"&gt;)&lt;/span&gt;
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;google cloud storage&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;13&lt;/span&gt; / Google Drive
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;drive&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;14&lt;/span&gt; / Google Photos
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;google photos&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;15&lt;/span&gt; / Hubic
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hubic&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;16&lt;/span&gt; / JottaCloud
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;jottacloud&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;17&lt;/span&gt; / Koofr
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;koofr&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;18&lt;/span&gt; / Local Disk
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;local&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;19&lt;/span&gt; / Mail.ru Cloud
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mailru&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;20&lt;/span&gt; / Mega
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mega&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;21&lt;/span&gt; / Microsoft Azure Blob Storage
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;azureblob&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;22&lt;/span&gt; / Microsoft OneDrive
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;onedrive&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;23&lt;/span&gt; / OpenDrive
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;opendrive&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;24&lt;/span&gt; / Openstack Swift &lt;span class="o"&gt;(&lt;/span&gt;Rackspace Cloud Files, Memset Memstore, OVH&lt;span class="o"&gt;)&lt;/span&gt;
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;swift&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;25&lt;/span&gt; / Pcloud
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pcloud&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;26&lt;/span&gt; / Put.io
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;putio&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;27&lt;/span&gt; / QingCloud Object Storage
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;qingstor&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;28&lt;/span&gt; / SSH/SFTP Connection
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sftp&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;29&lt;/span&gt; / Transparently chunk/split large files
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;chunker&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;30&lt;/span&gt; / Union merges the contents of several remotes
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;union&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;31&lt;/span&gt; / Webdav
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;webdav&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;32&lt;/span&gt; / Yandex Disk
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;yandex&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;33&lt;/span&gt; / http Connection
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http&amp;quot;&lt;/span&gt;
&lt;span class="m"&gt;34&lt;/span&gt; / premiumize.me
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;premiumizeme&amp;quot;&lt;/span&gt;
Storage&amp;gt; &lt;span class="m"&gt;13&lt;/span&gt;
** See &lt;span class="nb"&gt;help&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; drive backend at: https://rclone.org/drive/ **

Google Application Client Id
Setting your own is recommended.
See https://rclone.org/drive/#making-your-own-client-id &lt;span class="k"&gt;for&lt;/span&gt; how to create your own.
If you leave this blank, it will use an internal key which is low performance.
Enter a string value. Press Enter &lt;span class="k"&gt;for&lt;/span&gt; the default &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.
client_id&amp;gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
Google Application Client Secret
Setting your own is recommended.
Enter a string value. Press Enter &lt;span class="k"&gt;for&lt;/span&gt; the default &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.
client_secret&amp;gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
Scope that rclone should use when requesting access from drive.
Enter a string value. Press Enter &lt;span class="k"&gt;for&lt;/span&gt; the default &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.
Choose a number from below, or &lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; your own value
 &lt;span class="m"&gt;1&lt;/span&gt; / Full access all files, excluding Application Data Folder.
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;drive&amp;quot;&lt;/span&gt;
 &lt;span class="m"&gt;2&lt;/span&gt; / Read-only access to file metadata and file contents.
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;drive.readonly&amp;quot;&lt;/span&gt;
   / Access to files created by rclone only.
 &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; These are visible &lt;span class="k"&gt;in&lt;/span&gt; the drive website.
   &lt;span class="p"&gt;|&lt;/span&gt; File authorization is revoked when the user deauthorizes the app.
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;drive.file&amp;quot;&lt;/span&gt;
   / Allows &lt;span class="nb"&gt;read&lt;/span&gt; and write access to the Application Data folder.
 &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; This is not visible &lt;span class="k"&gt;in&lt;/span&gt; the drive website.
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;drive.appfolder&amp;quot;&lt;/span&gt;
   / Allows read-only access to file metadata but
 &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; does not allow any access to &lt;span class="nb"&gt;read&lt;/span&gt; or download file content.
   &lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;drive.metadata.readonly&amp;quot;&lt;/span&gt;
scope&amp;gt; &lt;span class="m"&gt;3&lt;/span&gt;
ID of the root folder
Leave blank normally.

Fill &lt;span class="k"&gt;in&lt;/span&gt; to access &lt;span class="s2"&gt;&amp;quot;Computers&amp;quot;&lt;/span&gt; folders &lt;span class="o"&gt;(&lt;/span&gt;see docs&lt;span class="o"&gt;)&lt;/span&gt;, or &lt;span class="k"&gt;for&lt;/span&gt; rclone to use
a non root folder as its starting point.

Note that &lt;span class="k"&gt;if&lt;/span&gt; this is blank, the first &lt;span class="nb"&gt;time&lt;/span&gt; rclone runs it will fill it
&lt;span class="k"&gt;in&lt;/span&gt; with the ID of the root folder.

Enter a string value. Press Enter &lt;span class="k"&gt;for&lt;/span&gt; the default &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.
root_folder_id&amp;gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
Service Account Credentials JSON file path
Leave blank normally.
Needed only &lt;span class="k"&gt;if&lt;/span&gt; you want use SA instead of interactive login.
Enter a string value. Press Enter &lt;span class="k"&gt;for&lt;/span&gt; the default &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.
service_account_file&amp;gt;
Edit advanced config? &lt;span class="o"&gt;(&lt;/span&gt;y/n&lt;span class="o"&gt;)&lt;/span&gt;
y&lt;span class="o"&gt;)&lt;/span&gt; Yes
n&lt;span class="o"&gt;)&lt;/span&gt; No
y/n&amp;gt; n
Remote config
Use auto config?
 * Say Y &lt;span class="k"&gt;if&lt;/span&gt; not sure
 * Say N &lt;span class="k"&gt;if&lt;/span&gt; you are working on a remote or headless machine
y&lt;span class="o"&gt;)&lt;/span&gt; Yes
n&lt;span class="o"&gt;)&lt;/span&gt; No
y/n&amp;gt; n
If your browser doesn&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;t open automatically go to the following link: &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
Log &lt;span class="k"&gt;in&lt;/span&gt; and authorize rclone &lt;span class="k"&gt;for&lt;/span&gt; access
Enter verification code&amp;gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
Configure this as a team drive?
y&lt;span class="o"&gt;)&lt;/span&gt; Yes
n&lt;span class="o"&gt;)&lt;/span&gt; No
y/n&amp;gt; n
--------------------
&lt;span class="o"&gt;[&lt;/span&gt;google_drive&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; drive
&lt;span class="nv"&gt;client_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;client_secret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;scope&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; drive.file
&lt;span class="nv"&gt;root_folder_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;...&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;token&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;access_token&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;[...]&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;token_type&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;Bearer&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;refresh_token&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;[...]&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;expiry&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;2020-01-18T17:09:31.820516378+01:00&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
--------------------
y&lt;span class="o"&gt;)&lt;/span&gt; Yes this is OK
e&lt;span class="o"&gt;)&lt;/span&gt; Edit this remote
d&lt;span class="o"&gt;)&lt;/span&gt; Delete this remote
y/e/d&amp;gt; y
Current remotes:

Name                 &lt;span class="nv"&gt;Type&lt;/span&gt;
&lt;span class="o"&gt;====&lt;/span&gt;                 &lt;span class="o"&gt;====&lt;/span&gt;
google_drive         drive

e&lt;span class="o"&gt;)&lt;/span&gt; Edit existing remote
n&lt;span class="o"&gt;)&lt;/span&gt; New remote
d&lt;span class="o"&gt;)&lt;/span&gt; Delete remote
r&lt;span class="o"&gt;)&lt;/span&gt; Rename remote
c&lt;span class="o"&gt;)&lt;/span&gt; Copy remote
s&lt;span class="o"&gt;)&lt;/span&gt; Set configuration password
q&lt;span class="o"&gt;)&lt;/span&gt; Quit config
e/n/d/r/c/s/q&amp;gt; q
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now try rclone by copying a file (e.g. &amp;quot;backup.log&amp;quot;) to &amp;quot;google_drive&amp;quot; and create a new folder &amp;quot;rpi1&amp;quot;. Then list
content in &amp;quot;google_drive&amp;quot;, folder &amp;quot;rpi&amp;quot; to verify that the file is there. Finally list folders visible in &amp;quot;google_drive&amp;quot;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pi@rpi1:~/bck $ rclone copy backup.log google_drive:rpi1
pi@rpi1:~/bck $ rclone ls google_drive:rpi1
  &lt;span class="m"&gt;1104214&lt;/span&gt; backup.log
pi@rpi1:~/bck $ rclone lsd google_drive:
          -1 &lt;span class="m"&gt;2020&lt;/span&gt;-01-18 &lt;span class="m"&gt;16&lt;/span&gt;:10:44        -1 rpi1
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="backup"&gt;
&lt;h2&gt;Backup&lt;/h2&gt;
&lt;p&gt;Now &lt;tt class="docutils literal"&gt;rclone&lt;/tt&gt; can be used to backup files to Google Drive.&lt;/p&gt;
&lt;div class="section" id="rpi1-backup"&gt;
&lt;h3&gt;rpi1 backup&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;rpi1&lt;/strong&gt; have an additional USB memory installed. Production data is stored in Mongo database.&lt;/p&gt;
&lt;p&gt;Plug the USB memory into a USB port and it should be automatically mounted by the raspberry on &lt;tt class="docutils literal"&gt;/dev/sda*&lt;/tt&gt;,
for example &lt;tt class="docutils literal"&gt;/dev/sda1&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To check availability do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo lsblk -f

NAME        FSTYPE LABEL    UUID                                 MOUNTPOINT
sda
└─sda1      vfat            8F3F-8E75                            /media/pi/8F3F-8E75
mmcblk0
├─mmcblk0p1 vfat   RECOVERY &lt;span class="m"&gt;6363&lt;/span&gt;-3634
├─mmcblk0p2
├─mmcblk0p5 ext4   SETTINGS 444485b7-f8cb-4f4c-8b9a-6fedf94efed1 /media/pi/SETTINGS
├─mmcblk0p6 vfat   boot     &lt;span class="m"&gt;0181&lt;/span&gt;-4B93                            /boot
└─mmcblk0p7 ext4   root     65b49769-3b56-43b9-b037-bf4a8da3a41a /
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note the mount point for the USB memory stick &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/media/pi/8F3F-8E75&lt;/span&gt;&lt;/tt&gt;, make a softlink for more convenient access,
for example &lt;tt class="docutils literal"&gt;$ ln &lt;span class="pre"&gt;-s&lt;/span&gt; &lt;span class="pre"&gt;/media/pi/8F3F-8E75/&lt;/span&gt; /home/pi/bck/&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;If needed format the USB memory stick through &lt;tt class="docutils literal"&gt;$ sudo mkfs.vfat /dev/sda1 &lt;span class="pre"&gt;-n&lt;/span&gt; untitled&lt;/tt&gt;.
If the mkfs.vfat command is not available install &amp;quot;dosfstools&amp;quot; first through &lt;tt class="docutils literal"&gt;$ sudo &lt;span class="pre"&gt;apt-get&lt;/span&gt; install dosfstools&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Now add the following content into a file named backup.sh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env bash&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Daily backup from /etc/crontab&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Adopted from &amp;lt;https://help.ubuntu.com/lts/serverguide/backup-shellscripts.html&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;# and &amp;lt;http://www.tldp.org/LDP/solrhe/Securing-  Optimizing-Linux-RH-Edition-v1.3/chap29sec306.html&amp;gt;&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# To list: tar -tzvf /home/pi/bck/host-Monday.tgz&lt;/span&gt;
&lt;span class="c1"&gt;# To restore: tar -xzvf /home/pi/bck/host-Monday.tgz -C /tmp etc/hosts (restore /etc/hosts file to /etc/tmp/hosts)&lt;/span&gt;
&lt;span class="c1"&gt;# Notice the leading &amp;quot;/&amp;quot; is left off the path of the file to restore.&lt;/span&gt;
&lt;span class="c1"&gt;# To restore all (overwrites everything):&lt;/span&gt;
&lt;span class="c1"&gt;#   cd&lt;/span&gt;
&lt;span class="c1"&gt;#   sudo tar -xzvf /home/pi/bck/host-Monday.tgz&lt;/span&gt;

&lt;span class="c1"&gt;# What to backup&lt;/span&gt;
&lt;span class="nv"&gt;backup_files&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/home/pi/.ssh /home/pi/app&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# Where to backup to.&lt;/span&gt;
&lt;span class="c1"&gt;# Note, this is a softlinked directory to /media/pi/8F3F-8E75/bck which resides on a separate USB  flash memory&lt;/span&gt;
&lt;span class="nv"&gt;dest&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/home/pi/bck&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# Create archive filename.&lt;/span&gt;
&lt;span class="nv"&gt;day&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;date +%A&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nv"&gt;hostname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;hostname -s&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nv"&gt;archive_file&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$hostname&lt;/span&gt;&lt;span class="s2"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;$day&lt;/span&gt;&lt;span class="s2"&gt;.tgz&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# Print start status message.&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-----&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Backing up &lt;/span&gt;&lt;span class="nv"&gt;$backup_files&lt;/span&gt;&lt;span class="s2"&gt; to &lt;/span&gt;&lt;span class="nv"&gt;$dest&lt;/span&gt;&lt;span class="s2"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;$archive_file&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
date
&lt;span class="nb"&gt;echo&lt;/span&gt;

&lt;span class="c1"&gt;# Backup the files using tar.&lt;/span&gt;
tar czf &lt;span class="nv"&gt;$dest&lt;/span&gt;/&lt;span class="nv"&gt;$archive_file&lt;/span&gt; &lt;span class="nv"&gt;$backup_files&lt;/span&gt;

&lt;span class="c1"&gt;# Print end status message.&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Backup finished&amp;quot;&lt;/span&gt;
date

&lt;span class="c1"&gt;# Long listing of files in $dest to check file sizes.&lt;/span&gt;
ls -lh &lt;span class="nv"&gt;$dest&lt;/span&gt;/
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-----&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then do &lt;tt class="docutils literal"&gt;$ chmod a+x backup.sh&lt;/tt&gt;, the script is executed through user crontab (not /etc/crontab) by inserting this line&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;    * * *   sh /home/pi/rpi1/app/RPiscripts/backup.sh &amp;gt;&amp;gt; /home/pi/bck/backup.log &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Thus, by 2:00am the script is executed. Note that the folder &lt;tt class="docutils literal"&gt;home/pi/app&lt;/tt&gt; is included although no production data
is there. I then upload to Google Drive by this line in the same crontab at 4:00am.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;    * * *   rclone sync /home/pi/bck/ google_drive:rpi1
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="rpi3-backup"&gt;
&lt;h3&gt;rpi3 backup&lt;/h3&gt;
&lt;p&gt;For &lt;strong&gt;rpi3&lt;/strong&gt; I have 2 files that is of &amp;quot;production type&amp;quot;, ie generated by a program. These are synched to Google Drive
once per hour from crontab entries&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt; * * * * rclone sync /home/pi/app/spots/radar/spots_stats.json google_drive:spots
&lt;span class="m"&gt;0&lt;/span&gt; * * * * rclone sync /home/pi/app/spots/radar/spots_stats.json.1 google_drive:spots
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
When google_drive is setup when installing rclone on &lt;strong&gt;rpi3&lt;/strong&gt;, the root is different compared to &lt;strong&gt;rpi1&lt;/strong&gt;.
For &lt;strong&gt;rpi3&lt;/strong&gt; it points to &lt;tt class="docutils literal"&gt;rpi_bck/rpi3&lt;/tt&gt; on Google Drive, while for &lt;strong&gt;rpi1&lt;/strong&gt; it points to &lt;tt class="docutils literal"&gt;`rpi_bck&lt;/tt&gt;.
Thus, for &lt;strong&gt;rpi1&lt;/strong&gt; an additional suffix is needed to store files at &lt;tt class="docutils literal"&gt;rpi_bck/rpi1&lt;/tt&gt; by using &lt;tt class="docutils literal"&gt;google_drive:rpi1&lt;/tt&gt;
in rclone commands on &lt;strong&gt;rpi1&lt;/strong&gt; compared to &lt;strong&gt;rpi3&lt;/strong&gt;.&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="Raspberry"></category><category term="Google Drive"></category><category term="rclone"></category></entry><entry><title>Raspberry information</title><link href="https://wlog.viltstigen.se/articles/2020/01/14/raspberry-information/" rel="alternate"></link><published>2020-01-14T00:00:00+01:00</published><updated>2020-06-22T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-14:/articles/2020/01/14/raspberry-information/</id><summary type="html">&lt;p class="first last"&gt;A note on getting information on Raspberry Pi's&lt;/p&gt;
</summary><content type="html">&lt;p&gt;As I have several active raspberries in my home location, I tend to forget the details of them.
For example, raspberry model, linux kernel version etc etc
So I decided to write a script to collect this and expose it in a simple, crude tabular form at my home page.
Here is how it is done.&lt;/p&gt;
&lt;div class="section" id="configuration"&gt;
&lt;h2&gt;Configuration&lt;/h2&gt;
&lt;p&gt;I have (currently) 5 raspberries in various models. They are named &amp;quot;rpi1&amp;quot;...&amp;quot;rpi5&amp;quot; and have been assigned static
IP-addresses (192.168.1.50 to 192.168.1.54).&lt;/p&gt;
&lt;p&gt;The rpi1-node is running my web-server (nginx), collects information from the other raspberries and expose the result
by generating a web-page using flask.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="raspberry-configuration"&gt;
&lt;h2&gt;Raspberry configuration&lt;/h2&gt;
&lt;p&gt;Each raspberry is running a small python info-script, listening and responding on port 8094.
All raspberries are protected with the &amp;quot;uncomplicated firewall&amp;quot; (UFW).
To allow traffic on port 8094 do &lt;tt class="docutils literal"&gt;$ sudo ufw allow from 192.168.1.0/24 to any port 8094&lt;/tt&gt;, this will enable any type of
traffic (TCP/UDP) from any node on the 192.168.1 network, others are blocked.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="information-to-collect"&gt;
&lt;h2&gt;Information to collect&lt;/h2&gt;
&lt;p&gt;I want to collect and present the following information for each raspberry&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The host name and ip address&lt;/li&gt;
&lt;li&gt;Uptime and average load&lt;/li&gt;
&lt;li&gt;Raspberry model name&lt;/li&gt;
&lt;li&gt;Linux and raspbian versions&lt;/li&gt;
&lt;li&gt;CPU information&lt;/li&gt;
&lt;li&gt;Applications running on the raspberry&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Above is possible to read from various files in raspbian. Let's go through this.
In rasbian (or more generally, in Linux) the kernel maintains a directory tree under the root &lt;tt class="docutils literal"&gt;/proc&lt;/tt&gt; where readable
(ie text) files are found. So, the following is true&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;hostname can be read from &lt;tt class="docutils literal"&gt;/proc/sys/kernel/hostname&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;uptime can be read from &lt;tt class="docutils literal"&gt;/proc/uptime&lt;/tt&gt;. Note that this file have 2 numbers, both expressed in seconds, the
first number is seconds since restart, the second number is seconds in idle (which is not interesting for me).
We will need to convert seconds into a timestring to make it more readable, this is shown later on.&lt;/li&gt;
&lt;li&gt;average load can be read from /proc/loadavg. Note that it is the first three numbers that is of interest, there are
in total 5 numbers. See &lt;a class="footnote-reference" href="#id4" id="id1"&gt;[1]&lt;/a&gt; for details&lt;/li&gt;
&lt;li&gt;raspberry model can be read from &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/proc/device-tree/model&lt;/span&gt;&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;linux version is read from &lt;tt class="docutils literal"&gt;/proc/version&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;raspbian version is read from &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/os-release&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;CPU information is read from &lt;tt class="docutils literal"&gt;/proc/cpuinfo&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Applications running on the raspberry is not read but hardcoded into the script&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note that the information provided above needs to be formated to fit what I want.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="implementation"&gt;
&lt;h2&gt;Implementation&lt;/h2&gt;
&lt;p&gt;Install flask, gunicorn and requests into the python virtual environment, below named &amp;quot;info&amp;quot;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkvirtualenv info
$ pip install flask
$ pip install gunicorn
$ pip install requests
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or, using Python venv, creating &lt;tt class="docutils literal"&gt;.venv&lt;/tt&gt;, do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ python -m venv .venv
$ &lt;span class="nb"&gt;source&lt;/span&gt; .venv/bin/activate
&lt;span class="o"&gt;(&lt;/span&gt;.venv&lt;span class="o"&gt;)&lt;/span&gt; $ pip install flask
&lt;span class="o"&gt;(&lt;/span&gt;.venv&lt;span class="o"&gt;)&lt;/span&gt; $ pip install gunicorn
&lt;span class="o"&gt;(&lt;/span&gt;.venv&lt;span class="o"&gt;)&lt;/span&gt; $ pip install requests
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I will be using &lt;a class="reference external" href="https://gunicorn.org/"&gt;gunicorn&lt;/a&gt; as the WSGI web-server,
&lt;a class="reference external" href="http://flask.palletsprojects.com/en/1.1.x/"&gt;flask&lt;/a&gt; as the web application (gunicorn receives HTTP requests and then
communicate with flask using WSGI calling convention). The flask application will act as a proxy and ask for information
from the other raspberries using requests, collect the information and return the information in JSON format to the
calling client.&lt;/p&gt;
&lt;p&gt;Here is the main loop, comments below&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;info&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;rpi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_info&lt;/span&gt;&lt;span class="p"&gt;())}&lt;/span&gt;
    &lt;span class="n"&gt;wait&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi2.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi2 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi3.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi3 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi4.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi4 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi5.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi5 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;info.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The flask app is started with host parameter value as 0.0.0.0 which means that other hosts can reach this app.
Debugging is enabled.
To bind this flask application to gunicorn, using port 8094 the following configuration file (which I name
ìnfo_gunicorn.conf) exists.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;program:info_gunicorn&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;command&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /home/pi/.virtualenvs/info/bin/python /home/pi/.virtualenvs/info/bin/gunicorn -b :8094 --reload emitter:app
&lt;span class="nv"&gt;directory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /home/pi/rpi1/info
&lt;span class="nv"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; root
&lt;span class="nv"&gt;autostart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;autorestart&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;startretries&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="nv"&gt;stdout_logfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /var/log/supervisor/info_gunicorn.log
&lt;span class="nv"&gt;stderr_logfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /var/log/supervisor/info_gunicorn.err
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;gunicorn and flask is running as a server on the rpi1 node and is supervised using &lt;a class="reference external" href="http://supervisord.org/"&gt;http://supervisord.org/&lt;/a&gt;.
Check out the documentation to install this tool. The gunicorn configuration file should normally reside at
&lt;tt class="docutils literal"&gt;/etc/supervisor/conf.d&lt;/tt&gt;, I have choosen to store this file elsewhere and provide a softlink from the conf.d
directory to the configuration file.&lt;/p&gt;
&lt;p&gt;Finally, I have configured nginx with this location information&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/info&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;try_files&lt;/span&gt; &lt;span class="nv"&gt;$uri&lt;/span&gt; &lt;span class="nv"&gt;$uri/&lt;/span&gt; &lt;span class="nv"&gt;$uri/index.html&lt;/span&gt; &lt;span class="nv"&gt;$uri.html&lt;/span&gt; &lt;span class="s"&gt;@info&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;@info&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# proxy_pass http://rpi1.local; Note, a static IP address makes nginx more robust in case rpi1 is not running&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://192.168.1.50:8094&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_redirect&lt;/span&gt;     &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;Host&lt;/span&gt; &lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Real-IP&lt;/span&gt; &lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Forwarded-For&lt;/span&gt; &lt;span class="nv"&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;   &lt;span class="s"&gt;X-Forwarded-Host&lt;/span&gt; &lt;span class="nv"&gt;$server_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_read_timeout&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In summary, a web client will ask for information using HTTP(S) connecting to nginx which will pass upstream to
gunicorn listening on port 8094, gunicorn will communicate with the flask application, which in turn will communicate
with the other raspberries, collect and format all information and return the result as HTML.&lt;/p&gt;
&lt;p&gt;To have nginx reading the location information do $ sudo service nginx restart. You want to check (and correct) syntax
errors before restarting nginx using &lt;tt class="docutils literal"&gt;$ sudo nginx &lt;span class="pre"&gt;-t&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;In case you want to debug the flask application do this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;FLASK_APP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;emitter.py
$ &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;FLASK_DEBUG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
$ flask run --host&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0.0.0 --port&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;8094&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Access the flask application in a web browser through &lt;a class="reference external" href="http://rpi1.local:8094/info"&gt;http://rpi1.local:8094/info&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The python script above calls the other raspberries using requests, like so&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi2.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi2 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It will wait for 5.0 seconds before timing-out, assuming that the other raspberry is down and managing the exception.
The results are formated (format_info) and stored into a dictionary named rpi.
When the information has been collected, the flask function render_template is called with the rpi-dictionary as a
parameter.&lt;/p&gt;
&lt;p&gt;The information is presented as a table with 5 rows and one column per raspberry. Therefore, in the script, I replace
&lt;tt class="docutils literal"&gt;/n&lt;/tt&gt; with HTML &lt;tt class="docutils literal"&gt;&amp;lt;br&amp;gt;&lt;/tt&gt; and I use &amp;quot;?&amp;quot; as a marker in the information strings to know when to split into the 5 rows
(see the function format_info below).
The result is visible &lt;a class="reference external" href="https://www.viltstigen.se/info"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="full-listing"&gt;
&lt;h2&gt;Full listing&lt;/h2&gt;
&lt;p&gt;Here is the complete script running on rpi1 &lt;a class="footnote-reference" href="#id5" id="id2"&gt;[2]&lt;/a&gt; followed by the flask template used (Note that I have hardcoded application information on row 4 in the get_info routine).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Markup&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;subprocess&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;check_output&lt;/span&gt;


&lt;span class="n"&gt;__author__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;mm&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;format_cpuinfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;
    &lt;span class="n"&gt;no_of_cores&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;No of cores: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;processor&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;t:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;model_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;model name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;BogoMIPS&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Features&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CPU implementer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;hardware&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Hardware&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):]&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;no_of_cores&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;model_name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;hardware&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;no_of_cores&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;model_name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;hardware&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_info&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/sys/kernel/hostname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
              &lt;span class="s2"&gt;&amp;quot;(&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;check_output&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hostname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--all-ip-addresses&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;)&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Weather, EMC, Info, Vilt, Swind, nginx&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;up_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;ti&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;up_str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timedelta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seconds&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ti&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/loadavg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;load_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;load&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;load_str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/device-tree/model&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;vers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/etc/os-release&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;vers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;ind1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;ind2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ind1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ind1&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ind1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ind2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/cpuinfo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;format_cpuinfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inf&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inf&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="n"&gt;inf_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;inf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;br&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Markup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inf_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Markup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inf_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Markup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inf_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Markup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inf_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Markup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inf_str&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;


&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;info&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;rpi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_info&lt;/span&gt;&lt;span class="p"&gt;())}&lt;/span&gt;
    &lt;span class="n"&gt;wait&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;5.0&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi2.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi2 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi3.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi3 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi4.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi4 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;format_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://rpi5.local:8094/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnectionError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exceptions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timeout&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rpi5&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rpi5 (Down)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;apps&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Down&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;info.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rpi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;HTML template&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt; &lt;span class="na"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;en&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Raspberry info&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;td&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="kt"&gt;px&lt;/span&gt; &lt;span class="kc"&gt;solid&lt;/span&gt; &lt;span class="kc"&gt;black&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;border-collapse&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;collapse&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt; &lt;span class="na"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;width:100%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi1.name }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi2.name }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi3.name }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi4.name }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi5.name }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Running&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi1.apps }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi2.apps }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi3.apps }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi4.apps }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi5.apps }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Uptime&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi1.uptime }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi2.uptime }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi3.uptime }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi4.uptime }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi5.uptime }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Version&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi1.version }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi2.version }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi3.version }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi4.version }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi5.version }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;CPU&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt; &lt;span class="na"&gt;valign&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;top&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi1.cpu }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt; &lt;span class="na"&gt;valign&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;top&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi2.cpu }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt; &lt;span class="na"&gt;valign&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;top&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi3.cpu }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt; &lt;span class="na"&gt;valign&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;top&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi4.cpu }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt; &lt;span class="na"&gt;valign&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;top&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rpi.rpi5.cpu }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://elinux.org/RPi_HardwareHistory&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;RPi HardwareHistory&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://unix.stackexchange.com/questions/43539/what-do-the-flags-in-proc-cpuinfo-mean&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;CPU Info&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
Copyright (C) Mats Melander
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The python scripts executing (and listening on port 8094 &lt;a class="footnote-reference" href="#id6" id="id3"&gt;[3]&lt;/a&gt;) on the other raspberries is a simple copy of the rpi1
functions format_cpuinfo and get_info, like so (the same virtual environment, supervisor etc is installed per raspberry).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;subprocess&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;check_output&lt;/span&gt;


&lt;span class="n"&gt;__author__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;mm&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Flask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;format_cpuinfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;
    &lt;span class="n"&gt;no_of_cores&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;No of cores: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;processor&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;t:&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;model_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;model name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;BogoMIPS&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Features&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;CPU implementer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;hardware&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Hardware&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):]&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;no_of_cores&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;model_name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;hardware&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;no_of_cores&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;model_name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;features&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;hardware&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_info&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/sys/kernel/hostname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# NB! on Python 3, check_output needs to be decoded before replace (it returns byte)&lt;/span&gt;
        &lt;span class="c1"&gt;#  check _output([&amp;#39;hostname&amp;#39;, &amp;#39;--all-ip-addresses&amp;#39;]).decode().replace(&amp;quot; \\n&amp;quot;, &amp;quot;&amp;quot;)&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
              &lt;span class="s2"&gt;&amp;quot;(&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;check_output&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hostname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--all-ip-addresses&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;) ?&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Blog&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/uptime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;up_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;ti&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;up_str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timedelta&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seconds&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ti&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/loadavg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;load_str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;load&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;load_str&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/device-tree/model&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;vers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s2"&gt;n&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/etc/os-release&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;vers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;ind1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;ind2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ind1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ind1&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ind1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ind2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/proc/cpuinfo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;inf&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;format_cpuinfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;inf&lt;/span&gt;


&lt;span class="nd"&gt;@app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;info&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;get_info&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;table class="docutils footnote" frame="void" id="id4" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id1"&gt;[1]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;The first three fields in this file are load average figures giving the number of jobs in the run queue (state R) or
waiting for disk I/O (state D) averaged over 1, 5, and 15 minutes. They are the same as the load average numbers given
by uptime(1) and other programs.
The fourth field consists of two numbers separated by a slash (/). The first of these is the number of currently
executing kernel scheduling entities (processes, threads); this will be less than or equal to the number of CPUs.
The value after the slash is the number of kernel scheduling entities that currently exist on the system.
The fifth field is the PID of the process that was most recently created on the system.&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="id5" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id2"&gt;[2]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;The extraction of information and formatting is pretty crude, not my proudest moment... ↩︎&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table class="docutils footnote" frame="void" id="id6" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id3"&gt;[3]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;I use Uncomplicated Firewall (UFW), so this needs to be configured to allow traffic on this port, for example
&lt;tt class="docutils literal"&gt;sudo ufw allow from 192.168.1.0/24 to any port 8094&lt;/tt&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="Raspberry"></category></entry><entry><title>Let's Encrypt</title><link href="https://wlog.viltstigen.se/articles/2020/01/13/lets-encrypt/" rel="alternate"></link><published>2020-01-13T00:00:00+01:00</published><updated>2020-05-01T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-13:/articles/2020/01/13/lets-encrypt/</id><summary type="html">&lt;p class="first last"&gt;A note on certificates and HTTPS&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The recommended way for web traffic is to use HTTPS which requires a certificate.
There is a free certificate authority for this purpose, &lt;a class="reference external" href="https://letsencrypt.org/"&gt;Let's Encrypt&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In this post I describe my configuration and how to automatically renew the certificate when expired.
The basic recipe (for Ubuntu 16-04) I followed is available
&lt;a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04"&gt;here&lt;/a&gt;,
another good description is this &lt;a class="reference external" href="https://gist.github.com/cecilemuller/a26737699a7e70a7093d4dc115915de8"&gt;gist&lt;/a&gt;.&lt;/p&gt;
&lt;div class="section" id="environment"&gt;
&lt;h2&gt;Environment&lt;/h2&gt;
&lt;p&gt;I'm using nginx on &lt;strong&gt;rpi1&lt;/strong&gt;, Raspberry Pi Model B Rev 2, running Linux version 4.1.13+ Raspbian GNU/Linux 8 (jessie).&lt;/p&gt;
&lt;p&gt;The nginx server works as a proxy-server, redirecting web-application traffic to other raspberries behind this server.
My domain name is www.viltstigen.se.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="installation"&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;p&gt;Start by cloning the github letsencrypt repository.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo git clone https://github.com/letsencrypt/letsencrypt /opt/letsencrypt
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using the domain name and nginx root directory (see Environment above) we issue the following commands&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;cd&lt;/span&gt; /opt/letsencrypt
$ sudo ./letsencrypt-auto certonly -a webroot --webroot-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/share/nginx/html -d www.viltstigen.se
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The script will ask for some questions, be prepared to state email address and accept Terms of Service&lt;/p&gt;
&lt;p&gt;I obtained the following response (I was running this 2017-06-26)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Saving debug log to /var/log/letsencrypt/letsencrypt.log
Obtaining a new certificate
Performing the following challenges:
http-01 challenge &lt;span class="k"&gt;for&lt;/span&gt; www.viltstigen.se
Using the webroot path /usr/share/nginx/html &lt;span class="k"&gt;for&lt;/span&gt; all unmatched domains.
Waiting &lt;span class="k"&gt;for&lt;/span&gt; verification...
Cleaning up challenges
Generating key &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2048&lt;/span&gt; bits&lt;span class="o"&gt;)&lt;/span&gt;: /etc/letsencrypt/keys/0000_key-certbot.pem
Creating CSR: /etc/letsencrypt/csr/0000_csr-certbot.pem

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at
   /etc/letsencrypt/live/www.viltstigen.se/fullchain.pem. Your cert
   will expire on &lt;span class="m"&gt;2017&lt;/span&gt;-06-26. To obtain a new or tweaked version of
   this certificate &lt;span class="k"&gt;in&lt;/span&gt; the future, simply run letsencrypt-auto again.
   To non-interactively renew *all* of your certificates, run
   &lt;span class="s2"&gt;&amp;quot;letsencrypt-auto renew&amp;quot;&lt;/span&gt;
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;s Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's check the output&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo ls -l -R  /etc/letsencrypt/live/
/etc/letsencrypt/live/:
total &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
drwxr-xr-x &lt;span class="m"&gt;2&lt;/span&gt; root root &lt;span class="m"&gt;4096&lt;/span&gt; Mar &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;:53 www.viltstigen.se

/etc/letsencrypt/live/www.viltstigen.se:
total &lt;span class="m"&gt;4&lt;/span&gt;
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root  &lt;span class="m"&gt;41&lt;/span&gt; Mar &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;:53 cert.pem -&amp;gt; ../../archive/www.viltstigen.se/cert1.pem
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root  &lt;span class="m"&gt;42&lt;/span&gt; Mar &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;:53 chain.pem -&amp;gt; ../../archive/www.viltstigen.se/chain1.pem
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root  &lt;span class="m"&gt;46&lt;/span&gt; Mar &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;:53 fullchain.pem -&amp;gt; ../../archive/www.viltstigen.se/fullchain1.pem
lrwxrwxrwx &lt;span class="m"&gt;1&lt;/span&gt; root root  &lt;span class="m"&gt;44&lt;/span&gt; Mar &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;:53 privkey.pem -&amp;gt; ../../archive/www.viltstigen.se/privkey1.pem
-rw-r--r-- &lt;span class="m"&gt;1&lt;/span&gt; root root &lt;span class="m"&gt;543&lt;/span&gt; Mar &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;:53 README
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next step is to generate a Diffie-Hellman group, this will take some time&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo openssl dhparam -out /etc/ssl/certs/dhparam.pem &lt;span class="m"&gt;2048&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The output is in the /etc/ssl/certs directory and the file is a container for the public certificate.
Now it's time to configure nginx&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="nginx"&gt;
&lt;h2&gt;NGINX&lt;/h2&gt;
&lt;p&gt;Let's first define how I have structured the configuration files for nginx.
The directory tree for nginx looks like this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/etc/nginx
├── conf.d
├── sites-available
├── sites-enabled
└── snippets
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The basic configuration file is /etc/nginx/nginx.conf, which includes this row (among other)
&lt;tt class="docutils literal"&gt;include &lt;span class="pre"&gt;/etc/nginx/sites-enabled/*;&lt;/span&gt;&lt;/tt&gt;. So all files in the sites-enabled directory is included by nginx.
Traditionally, you store configuration files in the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;sites-available&lt;/span&gt;&lt;/tt&gt; directory, then softlink these files to
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;sites-enabled&lt;/span&gt;&lt;/tt&gt; for easy on/off switching.&lt;/p&gt;
&lt;p&gt;So, I have created a configuration file &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/nginx/sites-enabled/wolfrax.conf&lt;/span&gt;&lt;/tt&gt;.
This file defines 2 servers as follows&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;www.viltstigen.se&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;# This will redirect http traffic to server below using https&lt;/span&gt;
    &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$server_name$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;www.viltstigen.se&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/usr/share/nginx/html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.html&lt;/span&gt; &lt;span class="s"&gt;index.htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# SSL configuration&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;snippets/ssl-www.viltstigen.se.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;snippets/ssl-params.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;snippets/locations.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's digest these definitions somewhat.&lt;/p&gt;
&lt;p&gt;The 2 listen rows are for TCP/IP v4 and v6 respectively, listening on respective port numbers.&lt;/p&gt;
&lt;p&gt;The last row on the first server (return 301 &lt;a class="reference external" href="https://$server_name$request_uri"&gt;https://$server_name$request_uri&lt;/a&gt;;) is important in this context.
If the server is approached by a client using HTTP (port 80) it generates a 301-redirect response, this response tells
the client where to go (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;https://$server_name$request_uri&lt;/span&gt;&lt;/tt&gt;) which is simply put the same URI as it first used but using
HTTPS instead of HTTP. Thus we enforce usage of HTTPS.&lt;/p&gt;
&lt;div class="admonition note"&gt;
&lt;p class="first admonition-title"&gt;Note&lt;/p&gt;
&lt;p class="last"&gt;If the target server is upstream and nginx is simply a proxy-pass function the location
&lt;strong&gt;.well-known&lt;/strong&gt; needs to be excluded to be upstreamed.
See &lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/12/pelican-blog/"&gt;Pelican blog&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The second server definition is receiving the HTTPS traffic and includes 3 snippet-files as indicated.&lt;/p&gt;
&lt;p&gt;The first file, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;snippets/ssl-www.viltstigen.se.conf&lt;/span&gt;&lt;/tt&gt;, simply includes 2 rows&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;ssl_certificate&lt;/span&gt; &lt;span class="s"&gt;/etc/letsencrypt/live/www.viltstigen.se/fullchain.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="s"&gt;/etc/letsencrypt/live/www.viltstigen.se/privkey.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;These files were generated previously&lt;/p&gt;
&lt;p&gt;The second file (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;snippets/ssl-params.conf&lt;/span&gt;&lt;/tt&gt;) have more information&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;ssl_protocols&lt;/span&gt; &lt;span class="s"&gt;TLSv1&lt;/span&gt; &lt;span class="s"&gt;TLSv1.1&lt;/span&gt; &lt;span class="s"&gt;TLSv1.2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_prefer_server_ciphers&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_ciphers&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_ecdh_curve&lt;/span&gt; &lt;span class="s"&gt;secp384r1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_session_cache&lt;/span&gt; &lt;span class="s"&gt;shared:SSL:10m&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_session_tickets&lt;/span&gt; &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_stapling&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_stapling_verify&lt;/span&gt; &lt;span class="no"&gt;on&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;# Try to use Google (8.8.8.8) as resolver&lt;/span&gt;
&lt;span class="k"&gt;resolver&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="s"&gt;.8.8.8&lt;/span&gt; &lt;span class="s"&gt;valid=300s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;resolver_timeout&lt;/span&gt; &lt;span class="s"&gt;10s&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="c1"&gt;# Disable preloading HSTS for now.  You can use the commented out header line that includes&lt;/span&gt;
&lt;span class="c1"&gt;# the &amp;quot;preload&amp;quot; directive if you understand the implications.&lt;/span&gt;
&lt;span class="c1"&gt;#add_header Strict-Transport-Security &amp;quot;max-age=63072000; includeSubdomains; preload&amp;quot;;&lt;/span&gt;
&lt;span class="k"&gt;add_header&lt;/span&gt; &lt;span class="s"&gt;Strict-Transport-Security&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;max-age=63072000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;includeSubdomains&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;add_header&lt;/span&gt; &lt;span class="s"&gt;X-Frame-Options&lt;/span&gt; &lt;span class="s"&gt;DENY&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;add_header&lt;/span&gt; &lt;span class="s"&gt;X-Content-Type-Options&lt;/span&gt; &lt;span class="s"&gt;nosniff&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_dhparam&lt;/span&gt; &lt;span class="s"&gt;/etc/ssl/certs/dhparam.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For details on this configuration refer to Cipherli.st and Strong SSL Security on nginx&lt;/p&gt;
&lt;p&gt;The third file &lt;tt class="docutils literal"&gt;snippets/locations.conf&lt;/tt&gt; have several upstream locations, what is relevant in this context is this
part of the file&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/wolfblog&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;try_files&lt;/span&gt; &lt;span class="nv"&gt;$uri&lt;/span&gt; &lt;span class="nv"&gt;$uri/&lt;/span&gt; &lt;span class="nv"&gt;$uri/index.html&lt;/span&gt; &lt;span class="nv"&gt;$uri.html&lt;/span&gt; &lt;span class="s"&gt;@wolfblog&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="s"&gt;@wolfblog&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# proxy_pass http://rpi2.local:2368; Note, a static IP address makes nginx more robust in case rpi3 is not running&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_pass&lt;/span&gt;        &lt;span class="s"&gt;http://192.168.1.51:2368&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_redirect&lt;/span&gt;    &lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;  &lt;span class="s"&gt;Host&lt;/span&gt; &lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;  &lt;span class="s"&gt;X-Real-IP&lt;/span&gt; &lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;  &lt;span class="s"&gt;X-Forwarded-For&lt;/span&gt; &lt;span class="nv"&gt;$proxy_add_x_forwarded_for&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;  &lt;span class="s"&gt;X-Forwarded-Host&lt;/span&gt; &lt;span class="nv"&gt;$server_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that if my domain (www.viltstigen.se) is accessed with this URI: &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;https://www.viltstigen.se/wolfblog&lt;/span&gt;&lt;/tt&gt;,
the first section above kicks in. It tries, in order, to access any files stated in the URI, treat the URI as a
directory, access the file index.html in the URI location, and finally and file with extension &amp;quot;html&amp;quot; through the URI.
If nothing is found (the normal case) it upstreams to to the &amp;#64;wolfblog location that passes on to the rpi2 node on
port 2368 which has a static IP address of 192.168.1.52.&lt;/p&gt;
&lt;p&gt;When nginx files have been update, verify the configuration and restart&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo nginx -t
$ sudo systemctl restart nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="automatic-renewal-of-certificate"&gt;
&lt;h2&gt;Automatic renewal of certificate&lt;/h2&gt;
&lt;p&gt;Certificates is valid during a finite time and hence needs to be renewed recurrently. We can do this manually through&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo /opt/letsencrypt/letsencrypt-auto renew

Saving debug log to /var/log/letsencrypt/letsencrypt.log

-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/www.viltstigen.se.conf
-------------------------------------------------------------------------------
Cert not yet due &lt;span class="k"&gt;for&lt;/span&gt; renewal

The following certs are not due &lt;span class="k"&gt;for&lt;/span&gt; renewal yet:
  /etc/letsencrypt/live/www.viltstigen.se/fullchain.pem &lt;span class="o"&gt;(&lt;/span&gt;skipped&lt;span class="o"&gt;)&lt;/span&gt;
No renewals were attempted.
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To do this automatically and recurrently, add the following lines into /etc/crontab&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;    * * &lt;span class="m"&gt;1&lt;/span&gt;   root    /opt/letsencrypt/letsencrypt-auto renew &amp;gt;&amp;gt; /var/log/le-renew.log
&lt;span class="m"&gt;35&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;    * * &lt;span class="m"&gt;1&lt;/span&gt;   root    /bin/systemctl reload nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will create a new cron job that will execute the letsencrypt-auto renew command every Monday at 2:30 am,
and reload nginx at 2:35am (so the renewed certificate will be used).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="testing-ssl-configuration"&gt;
&lt;h2&gt;Testing SSL configuration&lt;/h2&gt;
&lt;p&gt;Now try the SSL configuration by pasting this URI into your web browser (exchange for your domain name):
&lt;a class="reference external" href="https://www.ssllabs.com/ssltest/analyze.html?d=www.viltstigen.se"&gt;https://www.ssllabs.com/ssltest/analyze.html?d=www.viltstigen.se&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="Raspberry"></category><category term="SSH"></category><category term="HTTPS"></category></entry><entry><title>Pelican blog</title><link href="https://wlog.viltstigen.se/articles/2020/01/12/pelican-blog/" rel="alternate"></link><published>2020-01-12T00:00:00+01:00</published><updated>2020-05-01T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-12:/articles/2020/01/12/pelican-blog/</id><summary type="html">&lt;p class="first last"&gt;A note on setting Pelican for blogging&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Using &lt;a class="reference external" href="https://blog.getpelican.com/"&gt;Pelican&lt;/a&gt;  as blog software.
Follow installation instructions &lt;a class="reference external" href="https://docs.getpelican.com/en/stable/install.html"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I use &lt;strong&gt;rpi1&lt;/strong&gt;-node as front-end to external requests, but my production part of this blog resides on node &lt;strong&gt;rpi2&lt;/strong&gt;.&lt;/p&gt;
&lt;div class="section" id="subdomain-management"&gt;
&lt;h2&gt;Subdomain management&lt;/h2&gt;
&lt;p&gt;I created a new subdomain to &lt;tt class="docutils literal"&gt;viltstigen.se&lt;/tt&gt; called &lt;tt class="docutils literal"&gt;wlog.viltstigen.se&lt;/tt&gt; at Binero. This was partly a necessity due
to my configuration and how Pelican works (by default).
Pelican uses relative paths of getting resources, e.g. &lt;tt class="docutils literal"&gt;/theme/css/admonition.css&lt;/tt&gt;, not absolute URL paths.
I use nginx as proxy on rpi1, where my DynDNS is pointing to. An HTTP request to &lt;tt class="docutils literal"&gt;wlog.viltstigen.se&lt;/tt&gt; is directed
to this node. &lt;strong&gt;rpi1&lt;/strong&gt; is configured (see nginx configuration below) to forward the request to &lt;strong&gt;rpi2&lt;/strong&gt; where a nginx
web-server is running and will return requested resources through &lt;strong&gt;rpi1&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;If I would have had the blog on, for example, &lt;tt class="docutils literal"&gt;www.viltstigen.se/blog/index.html&lt;/tt&gt; (on my existing subdomain),
I could have configured nginx on rpi1 to forward all requests on the resource &lt;tt class="docutils literal"&gt;/blog/index.html&lt;/tt&gt; to &lt;strong&gt;rpi2&lt;/strong&gt;.
However all subsequent requests from the client would use paths relative to &lt;tt class="docutils literal"&gt;www.viltstigen.se&lt;/tt&gt; and thus fail.&lt;/p&gt;
&lt;p&gt;Example,  using &lt;strong&gt;www&lt;/strong&gt; subdomain instead of &lt;strong&gt;wlog&lt;/strong&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;https://www.viltstigen.se/blog/index.html&lt;/strong&gt; would include the link
&lt;strong&gt;https://www.viltstigen.se/theme/css/elegant.prod.css&lt;/strong&gt;.
As nginx would be configured to forward requests on &lt;strong&gt;/blog/&lt;/strong&gt; to &lt;strong&gt;rpi2&lt;/strong&gt; the subsequent resource request on
&lt;strong&gt;/theme/css/&lt;/strong&gt; would look locally at &lt;strong&gt;rpi1&lt;/strong&gt; rather than forwarding to &lt;strong&gt;rpi2&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Therefore, as I use the &lt;strong&gt;wlog&lt;/strong&gt; subdomain, and forward all requests on this subdomain from &lt;strong&gt;rpi1&lt;/strong&gt;
to &lt;strong&gt;rpi2&lt;/strong&gt;, the subsequent link in index.html is &lt;strong&gt;https://wlog.viltstigen.se/theme/css/elegant.prod.css&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;As there is a new subdomain created, dynDNS at Binero needs to be updated accordingly, see
&lt;a class="reference external" href="https://wlog.viltstigen.se/articles/2020/01/11/dyndns/"&gt;DynDNS&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-ssl"&gt;
&lt;h2&gt;Using SSL&lt;/h2&gt;
&lt;p&gt;I want to enable &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Transport_Layer_Security"&gt;SSL&lt;/a&gt; so that
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/HTTPS"&gt;https&lt;/a&gt; can be used for my blog. A certificate is needed, for this purpose I use
&lt;a class="reference external" href="https://letsencrypt.org/"&gt;Let's Encrypt&lt;/a&gt;. In the nginx configuration on &lt;strong&gt;rpi1&lt;/strong&gt; HTTP-access is redirected to HTTPS.
The certificate is installed on rpi1. Below assumes that &lt;strong&gt;Let's Encrypt&lt;/strong&gt; software is already installed.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo ./letsencrypt-auto certonly -a webroot --webroot-path&lt;span class="o"&gt;=&lt;/span&gt;/usr/share/nginx/html -d wlog.viltstigen.se
/opt/eff.org/certbot/venv/local/lib/python2.7/site-packages/cryptography/hazmat/bindings/openssl/binding.py:163: CryptographyDeprecationWarning: OpenSSL version &lt;span class="m"&gt;1&lt;/span&gt;.0.1 is no longer supported by the OpenSSL project, please upgrade. The next version of cryptography will drop support &lt;span class="k"&gt;for&lt;/span&gt; it.
  utils.CryptographyDeprecationWarning
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator webroot, Installer None
Obtaining a new certificate
Performing the following challenges:
http-01 challenge &lt;span class="k"&gt;for&lt;/span&gt; wlog.viltstigen.se
Using the webroot path /usr/share/nginx/html &lt;span class="k"&gt;for&lt;/span&gt; all unmatched domains.
Waiting &lt;span class="k"&gt;for&lt;/span&gt; verification...
Cleaning up challenges

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/wlog.viltstigen.se/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/wlog.viltstigen.se/privkey.pem
   Your cert will expire on &lt;span class="m"&gt;2020&lt;/span&gt;-03-29. To obtain a new or tweaked
   version of this certificate &lt;span class="k"&gt;in&lt;/span&gt; the future, simply run
   letsencrypt-auto again. To non-interactively renew *all* of your
   certificates, run &lt;span class="s2"&gt;&amp;quot;letsencrypt-auto renew&amp;quot;&lt;/span&gt;
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;s Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Check auto-renewal of certificates by&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo /opt/letsencrypt/letsencrypt-auto renew
/opt/eff.org/certbot/venv/local/lib/python2.7/site-packages/cryptography/hazmat/bindings/openssl/binding.py:163: CryptographyDeprecationWarning: OpenSSL version &lt;span class="m"&gt;1&lt;/span&gt;.0.1 is no longer supported by the OpenSSL project, please upgrade. The next version of cryptography will drop support &lt;span class="k"&gt;for&lt;/span&gt; it.
  utils.CryptographyDeprecationWarning
Saving debug log to /var/log/letsencrypt/letsencrypt.log

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Processing /etc/letsencrypt/renewal/wlog.viltstigen.se.conf
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Cert not yet due &lt;span class="k"&gt;for&lt;/span&gt; renewal

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Processing /etc/letsencrypt/renewal/www.viltstigen.se.conf
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Cert not yet due &lt;span class="k"&gt;for&lt;/span&gt; renewal

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

The following certs are not due &lt;span class="k"&gt;for&lt;/span&gt; renewal yet:
  /etc/letsencrypt/live/wlog.viltstigen.se/fullchain.pem expires on &lt;span class="m"&gt;2020&lt;/span&gt;-03-29 &lt;span class="o"&gt;(&lt;/span&gt;skipped&lt;span class="o"&gt;)&lt;/span&gt;
  /etc/letsencrypt/live/www.viltstigen.se/fullchain.pem expires on &lt;span class="m"&gt;2020&lt;/span&gt;-03-29 &lt;span class="o"&gt;(&lt;/span&gt;skipped&lt;span class="o"&gt;)&lt;/span&gt;
No renewals were attempted.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In crontab on &lt;strong&gt;rpi1&lt;/strong&gt;, auto renenwal is executing by these lines&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;    * * &lt;span class="m"&gt;1&lt;/span&gt;   root    /opt/letsencrypt/letsencrypt-auto renew &amp;gt;&amp;gt; /var/log/le-renew.log
&lt;span class="m"&gt;35&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;    * * &lt;span class="m"&gt;1&lt;/span&gt;   root    /bin/systemctl reload nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="nginx-configuration"&gt;
&lt;h2&gt;nginx configuration&lt;/h2&gt;
&lt;p&gt;In &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/nginx/sites-enabled/wolfrax.conf&lt;/span&gt;&lt;/tt&gt; on &lt;strong&gt;rpi1&lt;/strong&gt; add these sections&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;wlog.viltstigen.se&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# This will redirect http traffic to server below using https&lt;/span&gt;
    &lt;span class="kn"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;301&lt;/span&gt; &lt;span class="s"&gt;https://&lt;/span&gt;&lt;span class="nv"&gt;$server_name$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# Reverse proxy to rpi2.local (192.168.1.51)&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:443&lt;/span&gt; &lt;span class="s"&gt;ssl&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;wlog.viltstigen.se&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;# SSL configuration&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;snippets/ssl-wlog.viltstigen.se.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;include&lt;/span&gt; &lt;span class="s"&gt;snippets/ssl-params.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kn"&gt;proxy_pass&lt;/span&gt; &lt;span class="s"&gt;http://192.168.1.51&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;# rpi2.local&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/.well-known/&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;  &lt;span class="c1"&gt;# do not redirect for this directory, used by letsencrypt&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note the last row for &lt;strong&gt;location /.well-known/&lt;/strong&gt;, this exclude the directory &amp;quot;.well-known&amp;quot; which is used by
&lt;strong&gt;letsencrypt&lt;/strong&gt; when renewing the cerificate. (letsencrypt stores information in this directory when renewing the
certificate, hence we should not move requests upstreams or the renewal will fail).&lt;/p&gt;
&lt;p&gt;In snippets-directory on &lt;strong&gt;rpi1&lt;/strong&gt; add file &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;ssl-wlog-viltstigen.se.conf&lt;/span&gt;&lt;/tt&gt; with this content&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;ssl_certificate&lt;/span&gt; &lt;span class="s"&gt;/etc/letsencrypt/live/wlog.viltstigen.se/fullchain.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="s"&gt;/etc/letsencrypt/live/wlog.viltstigen.se/privkey.pem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;No need to update &amp;quot;ssl-params.conf&amp;quot; file on &lt;strong&gt;rpi1&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Softlink the file (as I use a separate directory structure for my nginx files)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo ln -s /home/pi/rpi1/etc/nginx/snippets/ssl-wlog.viltstigen.se.conf /etc/nginx/snippets/ssl-wlog.viltstigen.se.conf
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Check nginx and restart&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf &lt;span class="nb"&gt;test&lt;/span&gt; is successful
$ sudo systemctl restart nginx
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;On &lt;strong&gt;rpi2&lt;/strong&gt;, create a new file &lt;tt class="docutils literal"&gt;wolfrax.conf&lt;/tt&gt; with this content (&lt;tt class="docutils literal"&gt;/clover/&lt;/tt&gt; is used for another web application, not
connected to Pelican blog, on &lt;strong&gt;rpi2&lt;/strong&gt;).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kn"&gt;listen&lt;/span&gt; &lt;span class="s"&gt;[::]:80&lt;/span&gt; &lt;span class="s"&gt;default_server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/var/www/html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;index&lt;/span&gt; &lt;span class="s"&gt;index.html&lt;/span&gt; &lt;span class="s"&gt;index.htm&lt;/span&gt; &lt;span class="s"&gt;index.nginx-debian.html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;server_name&lt;/span&gt; &lt;span class="s"&gt;_&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;# First attempt to serve request as file, then&lt;/span&gt;
        &lt;span class="c1"&gt;# as directory, then fall back to displaying a 404.&lt;/span&gt;
        &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/home/pi/app/wlog/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;try_files&lt;/span&gt; &lt;span class="nv"&gt;$uri&lt;/span&gt; &lt;span class="nv"&gt;$uri/&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kn"&gt;location&lt;/span&gt; &lt;span class="s"&gt;/clover/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;# First attempt to serve request as file, then&lt;/span&gt;
        &lt;span class="c1"&gt;# as directory, then fall back to displaying a 404.&lt;/span&gt;
        &lt;span class="kn"&gt;root&lt;/span&gt; &lt;span class="s"&gt;/var/www/html/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kn"&gt;try_files&lt;/span&gt; &lt;span class="nv"&gt;$uri&lt;/span&gt; &lt;span class="nv"&gt;$uri/&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using the files in the RPi-project, soft link files&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo mv /etc/nginx/nginx.conf /etc/nginx/nginx.conf_OLD
$ sudo rm /etc/nginx/sites-enabled/default  &lt;span class="c1"&gt;# Remove default config, softlinked from sites-available, if exists&lt;/span&gt;
$ sudo ln -s /home/pi/rpi2/etc/nginx/nginx.conf /etc/nginx/nginx.conf
$ sudo ln -s /home/pi/rpi2/etc/nginx/sites-enabled/wolfrax.conf /etc/nginx/sites-enabled/wolfrax.conf
$ sudo nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf &lt;span class="nb"&gt;test&lt;/span&gt; is successful
$ sudo service nginx restart
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="pelican-themes"&gt;
&lt;h2&gt;Pelican themes&lt;/h2&gt;
&lt;p&gt;To install pelican theme &amp;quot;elegant&amp;quot; clone the repo into the &amp;quot;themes&amp;quot; directory of pelican installation.
Below pelican theme &amp;quot;elegant&amp;quot; is installed into a virtual environment.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone https://github.com/Pelican-Elegant/elegant /home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/themes/elegant
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Update Pelican settings, see below.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pelican-plugins"&gt;
&lt;h2&gt;Pelican plugins&lt;/h2&gt;
&lt;p&gt;Install all available plugins, specifically &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pelican-ipynb&lt;/span&gt;&lt;/tt&gt; enabling using Jupyter notebooks.
Below pelican plugins are installed into a virtual environment.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone --recursive https://github.com/getpelican/pelican-plugins /home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/pelican-plugins
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then update &lt;tt class="docutils literal"&gt;pelicanconf.py&lt;/tt&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;PLUGIN_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PLUGIN_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/home/mm/dev/wlog/venv/lib/python3.8/site-packages/pelican/pelican-plugins&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;PLUGINS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;liquid_tags.notebook&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;i18n_subsites&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;MARKUP&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;md&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ipynb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;IGNORE_FILES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.ipynb_checkpoints&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pelican-ipynb&lt;/span&gt;&lt;/tt&gt; this library needs to be installed:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ pip install pelican-jupyter
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="pelican-settings"&gt;
&lt;h2&gt;Pelican settings&lt;/h2&gt;
&lt;p&gt;Using a PyCharm project &lt;strong&gt;wlog&lt;/strong&gt; for blog updates, create new directories under &lt;tt class="docutils literal"&gt;wlog/content/&lt;/tt&gt;:
'pdf', 'img', 'articles', 'pages'. Then update &lt;tt class="docutils literal"&gt;pelicanconf.py&lt;/tt&gt; with&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;SOCIAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Email&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;mats.melander@gmail.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
          &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Github&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://github.com/wolfrax&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),)&lt;/span&gt;

&lt;span class="n"&gt;THEME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;elegant&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;ARTICLE_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;articles&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;STATIC_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;img&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;extra&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;PAGE_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;ARTICLE_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;articles/{date:%Y}/{date:%m}/{date:&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;}/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;/&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;ARTICLE_SAVE_AS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;articles/{date:%Y}/{date:%m}/{date:&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;}/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;PAGE_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;/&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;PAGE_SAVE_AS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;CATEGORY_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;category/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;CATEGORY_SAVE_AS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;category/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;TAG_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tag/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;TAG_SAVE_AS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tag/&lt;/span&gt;&lt;span class="si"&gt;{slug}&lt;/span&gt;&lt;span class="s1"&gt;/index.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;EXTRA_PATH_METADATA&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;extra/robots.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;robots.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;extra/favicon.ico&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;favicon.ico&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="pelican-commands"&gt;
&lt;h2&gt;Pelican commands&lt;/h2&gt;
&lt;p&gt;Using make, these commands&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;make html&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;make serve&lt;/tt&gt;, will generate pages in &lt;tt class="docutils literal"&gt;output&lt;/tt&gt; directory and then start a local server
&lt;a class="reference external" href="http://localhost:8000/"&gt;http://localhost:8000/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;make publish&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;make ssh_upload&lt;/tt&gt;, will generate for production and upload to the server (configured in Makefile)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="Blog"></category><category term="Pelican"></category></entry><entry><title>DynDNS</title><link href="https://wlog.viltstigen.se/articles/2020/01/11/dyndns/" rel="alternate"></link><published>2020-01-11T00:00:00+01:00</published><updated>2020-01-11T00:00:00+01:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-11:/articles/2020/01/11/dyndns/</id><summary type="html">&lt;p class="first last"&gt;A note dynamic DNS&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I use the domain &lt;a class="reference external" href="viltstigen.se"&gt;viltstigen.se&lt;/a&gt; with the obvious subdomain &lt;a class="reference external" href="www.viltstigen.se"&gt;www.viltstigen.se&lt;/a&gt;.
For this blog I have also included the subdomain &lt;a class="reference external" href="wlog.viltstigen.se"&gt;wlog&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Both domains are registered at &lt;a class="reference external" href="https://www.binero.se/"&gt;Binero&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I am also using Binero dynamic DNS service as I don't have a static by my ISP.
My router does not have a dynamic DNS client included.&lt;/p&gt;
&lt;p&gt;To keep the dynamic WAN IP address of my router updated to Binero DNS I have added this to rpi1 crontab&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt; *    * * *   curl -n -d &lt;span class="s1"&gt;&amp;#39;hostname=www.viltstigen.se&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://dyndns.binero.se/nic/update&amp;#39;&lt;/span&gt; &amp;gt;/dev/null &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="m"&gt;00&lt;/span&gt; *    * * *   curl -n -d &lt;span class="s1"&gt;&amp;#39;hostname=wlog.viltstigen.se&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://dyndns.binero.se/nic/update&amp;#39;&lt;/span&gt;&amp;gt;/dev/null &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-n&lt;/span&gt;&lt;/tt&gt; option assume that a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.netrc&lt;/span&gt;&lt;/tt&gt; exists in the home directory of the current user (pi).
Change permission by &lt;tt class="docutils literal"&gt;$ chmod go= &lt;span class="pre"&gt;~/.netrc`&lt;/span&gt;&lt;/tt&gt;
Content for &lt;tt class="docutils literal"&gt;.netrc&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;machine dyndns.binero.se login mats.melander@gmail.com password XXX
machine dyndns.binero.se login mats.melander@gmail.com password XXX
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using &lt;tt class="docutils literal"&gt;curl&lt;/tt&gt; is inline with Binero documentation, running every hour. It will make a POST using the information after
the -d option. curl should return &amp;quot;good&amp;quot; or &amp;quot;nchg&amp;quot;, but the crontab rows directs to /dev/null, so not visible in syslog.&lt;/p&gt;
&lt;p&gt;Note Do not add a DSN record for &lt;tt class="docutils literal"&gt;www.viltstigen.se&lt;/tt&gt; manually at Binero, if this is made the DynDNS will not work.
The curl command above will add the subdomain &lt;tt class="docutils literal"&gt;www&lt;/tt&gt; to the domain &lt;tt class="docutils literal"&gt;viltstigen.se&lt;/tt&gt; and then it will be visible in the
DNS table at Binero. Same thing for the subdomain &lt;tt class="docutils literal"&gt;wlog.viltstigen.se&lt;/tt&gt; of course.&lt;/p&gt;
</content><category term="Technologies"></category><category term="DNS"></category></entry><entry><title>SSH</title><link href="https://wlog.viltstigen.se/articles/2020/01/11/ssh/" rel="alternate"></link><published>2020-01-11T00:00:00+01:00</published><updated>2020-06-22T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-11:/articles/2020/01/11/ssh/</id><summary type="html">&lt;p class="first last"&gt;A note on using SSH&lt;/p&gt;
</summary><content type="html">&lt;p&gt;This describes how to connect with &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Secure_Shell"&gt;SSH&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;To not provide password manually a public/private keys can be generated and stored at appropriate directories in host
(private key) and target (public key).&lt;/p&gt;
&lt;p&gt;To generate keys on my host (Linux or MacBook) and then store the public key on the raspberry host &lt;tt class="docutils literal"&gt;rpi1&lt;/tt&gt; do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh-keygen -t rsa -C pi@rpi1
$ cat ~/.ssh/id_rsa.pub &lt;span class="p"&gt;|&lt;/span&gt; ssh pi@rpi1.local &lt;span class="s1"&gt;&amp;#39;cat &amp;gt;&amp;gt; .ssh/authorized_keys&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that the last command transfer the public key to rpi1 using ssh and store it in file &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.ssh/authorized_keys&lt;/span&gt;&lt;/tt&gt;.
This will invoke to provide password for SSH.&lt;/p&gt;
&lt;p&gt;Make sure that directory &lt;tt class="docutils literal"&gt;.ssh&lt;/tt&gt; exists on home directory for user pi at the raspberry host rpi1.
If not do &lt;tt class="docutils literal"&gt;$ install &lt;span class="pre"&gt;-d&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; 700 &lt;span class="pre"&gt;~/.ssh&lt;/span&gt;&lt;/tt&gt; at the rpi1 first&lt;/p&gt;
&lt;p&gt;Note, if file &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.ssh/id_rsa.pub&lt;/span&gt;&lt;/tt&gt; already exists at host there is no need to do ssh-keygen, simply do the last
command above ($ cat ~/.ssh...).&lt;/p&gt;
&lt;p&gt;To remove an entry in &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.ssh/known_hosts&lt;/span&gt;&lt;/tt&gt; do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh-keygen -R rpi1.local
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;See &lt;a class="reference external" href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md"&gt;SSH passwordless&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If ssh tries to connect to a known IP address but receives a different ssh key compared to the one it got before,
it makes sense to treat this as a possible security problem and refuse to connect. This can happen if there is a new
installation of Raspbian and most commonly manifests by the ssh client reporting something like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now &lt;span class="o"&gt;(&lt;/span&gt;man-in-the-middle attack&lt;span class="o"&gt;)&lt;/span&gt;!
It is also possible that a host key has just been changed.
The fingerprint &lt;span class="k"&gt;for&lt;/span&gt; the ECDSA key sent by the remote host is
...
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To mitigate this the local ssh client file &lt;tt class="docutils literal"&gt;known_hosts&lt;/tt&gt; needs to be updated. Do this locally assuming the
issues occur while using ssh vs host 192.168.1.50 (rpi1.local).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh-keyscan &lt;span class="m"&gt;192&lt;/span&gt;.168.1.50 &amp;gt;&amp;gt; ~/.ssh/known_hosts
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If the IP address or the node name (e.g. &amp;quot;192.168.1.50&amp;quot; or &amp;quot;rpi1.local&amp;quot;) has been used before, an error message might
occur. To find out which entry is for a known hostname in known_hosts:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh-keygen -H  -F &amp;lt;hostname or IP address&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To delete a single entry from known_hosts (remove both IP address and node name as needed):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh-keygen -R &amp;lt;hostname or IP address&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then re-do the command &lt;cite&gt;$ ssh-keyscan 192.168.1.50 &amp;gt;&amp;gt; ~/.ssh/known_hosts&lt;/cite&gt;.&lt;/p&gt;
&lt;div class="section" id="github-ssh-access"&gt;
&lt;h2&gt;Github ssh access&lt;/h2&gt;
&lt;p&gt;On Raspberry Pi do (see &lt;a class="reference external" href="https://help.github.com/articles/generating-ssh-keys/"&gt;https://help.github.com/articles/generating-ssh-keys/&lt;/a&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh-keygen -t rsa -b &lt;span class="m"&gt;4096&lt;/span&gt; -C &lt;span class="s2"&gt;&amp;quot;mats.melander@gmail.com&amp;quot;&lt;/span&gt; &lt;span class="c1"&gt;# Generate public/private rsa keys in ~/.ssh directory&lt;/span&gt;
$ &lt;span class="nb"&gt;eval&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;ssh-agent -s&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;                                 &lt;span class="c1"&gt;# Make sure ssh is running, should respond &amp;quot;Agent pid 12693&amp;quot;&lt;/span&gt;
$ ssh-add ~/.ssh/id_rsa
$ cat .ssh/id_rsa.pub                                    &lt;span class="c1"&gt;# List content, copy the content&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Go to github and login, under settings/SSH keys, do &amp;quot;add new key&amp;quot;. Copy content from the public key.&lt;/p&gt;
&lt;p&gt;Verify on RPi with&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ ssh -T git@github.com
Warning: Permanently added the RSA host key &lt;span class="k"&gt;for&lt;/span&gt; IP address &lt;span class="s1"&gt;&amp;#39;192.30.252.128&amp;#39;&lt;/span&gt; to the list of known hosts.
Hi Wolfrax! You&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;ve successfully authenticated, but GitHub does not provide shell access.
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To have github working with ssh rather than https do (see &lt;a class="reference external" href="https://help.github.com/articles/changing-a-remote-s-url/"&gt;https://help.github.com/articles/changing-a-remote-s-url/&lt;/a&gt;,
below is valid for user Wolfrax and repository &amp;quot;Swind&amp;quot;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git remote -v
origin&lt;span class="se"&gt;\ &lt;/span&gt;    https://github.com/Wolfrax/Swind.git &lt;span class="o"&gt;(&lt;/span&gt;fetch&lt;span class="o"&gt;)&lt;/span&gt;
origin&lt;span class="se"&gt;\ &lt;/span&gt;    https://github.com/Wolfrax/Swind.git &lt;span class="o"&gt;(&lt;/span&gt;push&lt;span class="o"&gt;)&lt;/span&gt;
$ git remote set-url origin git@github.com:Wolfrax/Swind.git
$ git remote -v
origin&lt;span class="se"&gt;\ &lt;/span&gt;    git@github.com:Wolfrax/Swind.git &lt;span class="o"&gt;(&lt;/span&gt;fetch&lt;span class="o"&gt;)&lt;/span&gt;
origin&lt;span class="se"&gt;\ &lt;/span&gt;    git@github.com:Wolfrax/Swind.git &lt;span class="o"&gt;(&lt;/span&gt;push&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="osx"&gt;
&lt;h2&gt;OSX&lt;/h2&gt;
&lt;p&gt;On Mac OSX, I made the following update to &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;~/.ssh/config&lt;/span&gt;&lt;/tt&gt; (user config file, the system wide file is on
/etc/ssh/ssh_config, or equivalently /private/etc/ssh/ssh_config).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;AddressFamily inet
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This forces ssh to use IPv4 only, default value is &amp;quot;any&amp;quot; which enables both IPv4 and IPv6. I had some trouble with
one Raspberry (rpi2, 192.168.1.51) when using &lt;tt class="docutils literal"&gt;$ ssh pi&amp;#64;rpi2.local&lt;/tt&gt;. When debugging (using &lt;tt class="docutils literal"&gt;$ ssh &lt;span class="pre"&gt;-vvv&lt;/span&gt; pi&amp;#64;rpi2.local
``) it turned out that ``rpi2.local&lt;/tt&gt; were translated into an IPv6 address instead of an IPv4
for unknown reasons. Using an IPv6, ssh command had to timeout then it retried with a correct IPv4 address instead and
connected successfully. This caused and a long connection time.&lt;/p&gt;
&lt;p&gt;For my other raspberries, this has not been a problem. I have not digged further into why this became a problem for
&lt;strong&gt;rpi2&lt;/strong&gt; only.&lt;/p&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="Raspberry"></category><category term="SSH"></category></entry><entry><title>Raspberry setup</title><link href="https://wlog.viltstigen.se/articles/2020/01/05/raspberry-setup/" rel="alternate"></link><published>2020-01-05T00:00:00+01:00</published><updated>2020-06-22T00:00:00+02:00</updated><author><name>Mats Melander</name></author><id>tag:wlog.viltstigen.se,2020-01-05:/articles/2020/01/05/raspberry-setup/</id><summary type="html">&lt;p class="first last"&gt;A note on setting up Raspberry Pi&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Using &lt;a class="reference external" href="https://www.raspberrypi.org/downloads/noobs/"&gt;NOOBS&lt;/a&gt; to install
&lt;a class="reference external" href="https://www.raspbian.org/RaspbianAbout"&gt;Raspian&lt;/a&gt;. A SD card (&amp;gt;= 16GB) is needed.&lt;/p&gt;
&lt;p&gt;Download NOOBS and unzip it, then format the SD card. I use a MacBook, with the
application &lt;a class="reference external" href="https://www.sdcard.org/downloads/index.html"&gt;&amp;quot;SDFormatter&amp;quot;&lt;/a&gt;, use the option &amp;quot;Overwrite Format&amp;quot;
(not &amp;quot;Quick Format&amp;quot;). When done, copy all files in the NOOBS root directory to the SD card, plug it into the Raspberry
and start it up. A self-explaining menu with OS'es to choose from appear.&lt;/p&gt;
&lt;p&gt;Install Raspbian.&lt;/p&gt;
&lt;p&gt;Once done, some configuration is needed to setup the environment to my liking.&lt;/p&gt;
&lt;div class="section" id="configure"&gt;
&lt;h2&gt;Configure&lt;/h2&gt;
&lt;p&gt;Note that below, at least some of it, can also be made through the Raspberry UI (Gnome).&lt;/p&gt;
&lt;div class="section" id="bashrc"&gt;
&lt;h3&gt;bashrc&lt;/h3&gt;
&lt;p&gt;The bash-shell reads &lt;tt class="docutils literal"&gt;/etc/profile&lt;/tt&gt; which in turn reads &lt;tt class="docutils literal"&gt;/etc/bash.bashrc&lt;/tt&gt;. These are the system-wide files.
Add this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;alias&lt;/span&gt; &lt;span class="nv"&gt;ll&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ls -l --color=auto&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;alias&lt;/span&gt; &lt;span class="nv"&gt;la&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ls -A --color=auto&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;alias&lt;/span&gt; &lt;span class="nv"&gt;l&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ls -CF --color=auto&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;alias&lt;/span&gt; &lt;span class="nv"&gt;ls&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ls -l --color=auto&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Reload by:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class="nb"&gt;source&lt;/span&gt; ~/.bashrc
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="hostname"&gt;
&lt;h3&gt;hostname&lt;/h3&gt;
&lt;p&gt;Change the hostname to rpi1.&lt;/p&gt;
&lt;p&gt;Edit &lt;tt class="docutils literal"&gt;/etc/hosts&lt;/tt&gt;, change last row which states &lt;tt class="docutils literal"&gt;127.0.1.1 raspberrypi&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;127.0.1.1 rpi1&lt;/tt&gt;.
Then edit &lt;tt class="docutils literal"&gt;/etc/hostname&lt;/tt&gt; and add the wanted host name (rpi1).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo /etc/init.d/hostname.sh
$ sudo reboot
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note! On raspbian Buster, &lt;tt class="docutils literal"&gt;/etc/init.d/hostname.sh&lt;/tt&gt; has been removed. Easiest way is to change hostname using the GUI
(Preferences/Raspberry Pi Configuration) instead.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="timezone-and-locale"&gt;
&lt;h3&gt;Timezone and Locale&lt;/h3&gt;
&lt;p&gt;To update to correct timezone (use &lt;tt class="docutils literal"&gt;$ date&lt;/tt&gt; to check), do &lt;tt class="docutils literal"&gt;$ sudo &lt;span class="pre"&gt;dpkg-reconfigure&lt;/span&gt; tzdata&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;If you get &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-bash:&lt;/span&gt; warning: setlocale: LC_ALL: cannot change locale &lt;span class="pre"&gt;(en_US.UTF-8)&lt;/span&gt;&lt;/tt&gt; message at login then
do &lt;tt class="docutils literal"&gt;$ sudo &lt;span class="pre"&gt;dpkg-reconfigure&lt;/span&gt; locales&lt;/tt&gt;, make sure that &amp;quot;en_US.UTF-8&amp;quot; is selected.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="firewall-ufw"&gt;
&lt;h3&gt;Firewall (UFW)&lt;/h3&gt;
&lt;p&gt;Use UFW (Uncomplicated Firewall) as firewall protection, a good summary is &lt;a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-setup-a-firewall-with-ufw-on-an-ubuntu-and-debian-cloud-server"&gt;here&lt;/a&gt;.
Some commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get install ufw
$ sudo ufw disable
$ sudo ufw &lt;span class="nb"&gt;enable&lt;/span&gt;
$ sudo ufw allow ssh                  &lt;span class="c1"&gt;# allow for ssh traffic on port 22, equivalent $ sudo ufw allow 22/tcp&lt;/span&gt;
$ sudo ufw delete allow ssh           &lt;span class="c1"&gt;# Remove ssh traffic&lt;/span&gt;
$ sudo sudo ufw allow www             &lt;span class="c1"&gt;# allow www traffic on port 80&lt;/span&gt;
$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24  &lt;span class="c1"&gt;# allow all nodes on subnet 192.168.1.X&lt;/span&gt;
$ sudo ufw reset                      &lt;span class="c1"&gt;# Reset everything&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;My setup on one Raspberry (there is a difference between each Raspberry Pi node, as I have different ports open for web
applications).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;80&lt;/span&gt;   &lt;span class="c1"&gt;# Web server, HTTP&lt;/span&gt;
$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;443&lt;/span&gt;  &lt;span class="c1"&gt;# Web server, HTTPS&lt;/span&gt;
$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;22&lt;/span&gt;   &lt;span class="c1"&gt;# SSH&lt;/span&gt;
$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;8094&lt;/span&gt; &lt;span class="c1"&gt;# Web app&lt;/span&gt;
$ sudo ufw allow from &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24 to any port &lt;span class="m"&gt;8096&lt;/span&gt; &lt;span class="c1"&gt;# Web app&lt;/span&gt;
$ sudo ufw status
Status: active

To                         Action      From
--                         ------      ----
&lt;span class="m"&gt;8094&lt;/span&gt;                       ALLOW       &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24
&lt;span class="m"&gt;80&lt;/span&gt;                         ALLOW       &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24
&lt;span class="m"&gt;443&lt;/span&gt;                        ALLOW       &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24
&lt;span class="m"&gt;22&lt;/span&gt;                         ALLOW       &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24
&lt;span class="m"&gt;8096&lt;/span&gt;                       ALLOW       &lt;span class="m"&gt;192&lt;/span&gt;.168.1.0/24
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="networking"&gt;
&lt;h3&gt;Networking&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Netstat"&gt;netstat&lt;/a&gt; used for displaying information on network connections. Example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo netstat --tcp --listening --programs --numeric
Active Internet connections &lt;span class="o"&gt;(&lt;/span&gt;only servers&lt;span class="o"&gt;)&lt;/span&gt;
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:8094            &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:*               LISTEN      &lt;span class="m"&gt;3525&lt;/span&gt;/python
tcp        &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:8096            &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:*               LISTEN      &lt;span class="m"&gt;4338&lt;/span&gt;/python3
tcp        &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:5900            &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:*               LISTEN      &lt;span class="m"&gt;373&lt;/span&gt;/vncserver-x11-c
tcp        &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:80              &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:*               LISTEN      &lt;span class="m"&gt;11194&lt;/span&gt;/nginx: master
tcp        &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:22              &lt;span class="m"&gt;0&lt;/span&gt;.0.0.0:*               LISTEN      &lt;span class="m"&gt;383&lt;/span&gt;/sshd
tcp6       &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; :::548                  :::*                    LISTEN      &lt;span class="m"&gt;1458&lt;/span&gt;/afpd
tcp6       &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; :::5900                 :::*                    LISTEN      &lt;span class="m"&gt;373&lt;/span&gt;/vncserver-x11-c
tcp6       &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; :::80                   :::*                    LISTEN      &lt;span class="m"&gt;11194&lt;/span&gt;/nginx: master
tcp6       &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; :::22                   :::*                    LISTEN      &lt;span class="m"&gt;383&lt;/span&gt;/sshd
tcp6       &lt;span class="m"&gt;0&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt; ::1:4700                :::*                    LISTEN      &lt;span class="m"&gt;1459&lt;/span&gt;/cnid_metad
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To check DNS use &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Dig_(command)"&gt;dig&lt;/a&gt; or
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Nslookup"&gt;nslookup&lt;/a&gt;. Need to install &lt;tt class="docutils literal"&gt;dnsutils&lt;/tt&gt; to use them. Example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get install dnsutils
$ dig www.viltstigen.se

&lt;span class="p"&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG &lt;span class="m"&gt;9&lt;/span&gt;.9.5-9+deb8u15-Raspbian &amp;lt;&amp;lt;&amp;gt;&amp;gt; www.viltstigen.se
&lt;span class="p"&gt;;;&lt;/span&gt; global options: +cmd
&lt;span class="p"&gt;;;&lt;/span&gt; Got answer:
&lt;span class="p"&gt;;;&lt;/span&gt; -&amp;gt;&amp;gt;HEADER&lt;span class="s"&gt;&amp;lt;&amp;lt;- opco&lt;/span&gt;de: QUERY, status: NOERROR, id: &lt;span class="m"&gt;62736&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; flags: qr rd ra&lt;span class="p"&gt;;&lt;/span&gt; QUERY: &lt;span class="m"&gt;1&lt;/span&gt;, ANSWER: &lt;span class="m"&gt;1&lt;/span&gt;, AUTHORITY: &lt;span class="m"&gt;0&lt;/span&gt;, ADDITIONAL: &lt;span class="m"&gt;0&lt;/span&gt;

&lt;span class="p"&gt;;;&lt;/span&gt; QUESTION SECTION:
&lt;span class="p"&gt;;&lt;/span&gt;www.viltstigen.se.         IN      A

&lt;span class="p"&gt;;;&lt;/span&gt; ANSWER SECTION:
www.viltstigen.se.  &lt;span class="m"&gt;120&lt;/span&gt;     IN      A       &lt;span class="m"&gt;85&lt;/span&gt;.225.114.58

&lt;span class="p"&gt;;;&lt;/span&gt; Query time: &lt;span class="m"&gt;31&lt;/span&gt; msec
&lt;span class="p"&gt;;;&lt;/span&gt; SERVER: &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1#53&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.1&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; WHEN: Mon Jan &lt;span class="m"&gt;06&lt;/span&gt; &lt;span class="m"&gt;14&lt;/span&gt;:24:52 CET &lt;span class="m"&gt;2020&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; MSG SIZE  rcvd: &lt;span class="m"&gt;51&lt;/span&gt;

$ nslookup www.viltstigen.se
Server:     &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1
Address:    &lt;span class="m"&gt;192&lt;/span&gt;.168.1.1#53

Non-authoritative answer:
Name:    www.viltstigen.se
Address: &lt;span class="m"&gt;85&lt;/span&gt;.225.114.58
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Make a raspberry visible in OSX finder, install &lt;tt class="docutils literal"&gt;netatalk&lt;/tt&gt; ($ sudo apt-get install netatalk).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="automatic-reboot-after-kernel-crash"&gt;
&lt;h3&gt;Automatic reboot after kernel crash&lt;/h3&gt;
&lt;p&gt;Edit &lt;tt class="docutils literal"&gt;/etc/sysctl.conf` and add ``kernel.panic = 10&lt;/tt&gt;.
This will make a reboot after 10 seconds delay after kernel panic crash. Make the changes take effect and check result
by&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo sysctl --system&lt;span class="se"&gt;\&lt;/span&gt;
$ sudo sysctl -a &lt;span class="p"&gt;|&lt;/span&gt; grep kernel.panic &lt;span class="c1"&gt;# check&lt;/span&gt;
kernel.panic &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;
kernel.panic_on_oops &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
kernel.panic_on_rcu_stall &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
kernel.panic_on_warn &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
sysctl: reading key &lt;span class="s2"&gt;&amp;quot;net.ipv6.conf.all.stable_secret&amp;quot;&lt;/span&gt;
sysctl: reading key &lt;span class="s2"&gt;&amp;quot;net.ipv6.conf.default.stable_secret&amp;quot;&lt;/span&gt;
sysctl: reading key &lt;span class="s2"&gt;&amp;quot;net.ipv6.conf.eth0.stable_secret&amp;quot;&lt;/span&gt;
sysctl: reading key &lt;span class="s2"&gt;&amp;quot;net.ipv6.conf.lo.stable_secret&amp;quot;&lt;/span&gt;
sysctl: reading key &lt;span class="s2"&gt;&amp;quot;net.ipv6.conf.wlan0.stable_secret&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="uptimerobot"&gt;
&lt;h3&gt;uptimerobot&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://uptimerobot.com/"&gt;Uptimerobot&lt;/a&gt; is a free service that checks the response time for web-sites,
it alerts through email.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="supervisor"&gt;
&lt;h3&gt;Supervisor&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="http://supervisord.org/"&gt;Supervisor&lt;/a&gt; is a tool for monitoring daemons. Install and configure supervisor&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get install supervisor
$ sudo supervisorctl status
$ sudo supervisorctl reread &lt;span class="c1"&gt;# Restart supervisor to have it grab the changes&lt;/span&gt;
$ sudo supervisorctl update
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="nginx"&gt;
&lt;h3&gt;NGINX&lt;/h3&gt;
&lt;p&gt;Install and start &lt;strong&gt;nginx&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt update
$ sudo apt install nginx
$ sudo /etc/init.d/nginx start
$ sudo apt-get purge apache2  &lt;span class="c1"&gt;# Remove apache in case it is installed&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When changing &lt;strong&gt;nginx&lt;/strong&gt; configuration, test and restart.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo nginx -t  &lt;span class="c1"&gt;# Test to check if configuration is Ok&lt;/span&gt;
$ sudo systemctl restart nginx  &lt;span class="c1"&gt;# Update and restart&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="Technologies"></category><category term="Raspberry"></category></entry></feed>